SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

-- =============================================
-- Author:		Paul Johnson
-- Create date: 01/03/2017
 -- Description:	Data Vault GuildNet Claims Load Satelites
-- =============================================
CREATE PROCEDURE [dbo].[spDV_GuildNetClaims_LoadSats]
AS
    BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
        SET NOCOUNT ON;

--**S_esi1900Details LOAD

        DECLARE @LoadDate DATETIME;
        SET @LoadDate = GETDATE();


        INSERT  INTO [dbo].[S_esi1900Details]
                ( [S_esi1900Details_RK] ,
                  [LoadDate] ,
                  [H_esi1900_RK] ,
                  [ProductIdentifier] ,
                  [RecordIdentifier] ,
                  [ProcessorNumber] ,
                  [BatchNumber] ,
                  [DateBilled] ,
                  [PharmacyNABPNumber] ,
                  [PrescriptionNumber] ,
                  [DateFilled] ,
                  [UandCFlag] ,
                  [NationalDrugCode] ,
                  [DrugName] ,
                  [NeworRefillCode] ,
                  [MetricQuantity] ,
                  [DaysSupply] ,
                  [CalculatedIngredientCost] ,
                  [DispensingFee] ,
                  [TaxAmount] ,
                  [CopayAmount] ,
                  [DeductibleAmount] ,
                  [AmountBilled] ,
                  [AmountClaimed] ,
                  [AmountDisallowed] ,
                  [MemberLastName] ,
                  [MemberFirstName] ,
                  [MemberMiddleInitial] ,
                  [MemberDateofBirth] ,
                  [MemberGender] ,
                  [CardHolderID] ,
                  [MemberNumber] ,
                  [PlanType] ,
                  [GroupNumber] ,
                  [PrescriberDEANumber] ,
                  [RelationshipCode] ,
                  [ClaimSubmissionType] ,
                  [ProviderContract] ,
                  [TierNumber] ,
                  [TherapeuticClass] ,
                  [GenericCode] ,
                  [BPLNumber] ,
                  [UandCAmount] ,
                  [ESIDAWCode] ,
                  [PriorAuthorizationNumber] ,
                  [FormularyStatus] ,
                  [DateReceived] ,
                  [CheckNumber] ,
                  [PlanType2] ,
                  [PassedCopayAmount] ,
                  [AncillaryAmount] ,
                  [ClaimAdminFee] ,
                  [AverageWholesalePrice] ,
                  [BrandGenericCode] ,
                  [ClientPrescribingPhysician] ,
                  [ClientIdentifier] ,
                  [MemberPCPAssignment] ,
                  [ClaimType] ,
                  [DOBDefault] ,
                  [ESIAdjudicationAuditNumber] ,
                  [ESIExpandedGroupNumber] ,
                  [MACAmount] ,
                  [ChainCode] ,
                  [MasterGroupNumber] ,
                  [ExpandedGroupNumber] ,
                  [PayeeCheckName] ,
                  [PayeeCheckAddress] ,
                  [PayeeCity] ,
                  [PayeeState] ,
                  [PayeeZipCode] ,
                  [PayeeZipCodeExpanded] ,
                  [PhysicianName] ,
                  [MemberProgram] ,
                  [DrugConflictCode1] ,
                  [DrugConflictCode2] ,
                  [DrugConflictCode3] ,
                  [DUROverflow] ,
                  [DURIntervention] ,
                  [DUROutcomeCode] ,
                  [DosageCode] ,
                  [RefillNumber] ,
                  [Age] ,
                  [AdjustmentReasonCode] ,
                  [GeneralPurposeField] ,
                  [PharmacyDAWCode] ,
                  [MaintenanceDrugIndicator] ,
                  [DrugLegalStatus] ,
                  [ESIGroupNumber] ,
                  [SubmittedDOB] ,
                  [SubmittedGender] ,
                  [ReimbursementFlag] ,
                  [EmployeeLastName] ,
                  [EmployeeFirstName] ,
                  [EmployeeMiddleInitial] ,
                  [EmployeeDOB] ,
                  [EmployeeGender] ,
                  [EmployeeZipCode] ,
                  [GroupName] ,
                  [EmplZipCodeExpanded] ,
                  [EmployeeAddress] ,
                  [EmployeeCity] ,
                  [EmployeeState] ,
                  [CalcBillCopayAmount] ,
                  [ProductType] ,
                  [FDBMaintIndicator] ,
                  [PartialFillStatusCode] ,
                  [AdjudicationDate] ,
                  [CompoundCode] ,
                  [MaxoutofpocketAmount] ,
                  [ProgramStopLossAmt] ,
                  [FSAVendorCode] ,
                  [OtherPayorAmount] ,
                  [OtherCoverageCode] ,
                  [PICADrugCode] ,
                  [FederalDrugClassCode] ,
                  [CoinsuranceAmount] ,
                  [DependentCode] ,
                  [PlanDesignator] ,
                  [PharmacyServiceType] ,
                  [PatientLocation] ,
                  [PrescriberQualifier] ,
                  [PrescriberIdentifier] ,
                  [PharmacyQualifier] ,
                  [PharmacyIdentifier] ,
                  [HRAAppliedAmount] ,
                  [HRAESIFund] ,
                  [MedicareDCoveredDrug] ,
                  [RetroLICSCode] ,
                  [RetroLICSAmount] ,
                  [LICSSubsidyAmount] ,
                  [MedBDrug] ,
                  [MedBClaim] ,
                  [CopayTierLevelNumber] ,
                  [OfficeofInspectorGeneralFlag] ,
                  [ANDAFlag] ,
                  [CDHResponseID] ,
                  [CDHESIResponseCode] ,
                  [HRAFlag] ,
                  [HRASingleBookFlag] ,
                  [HRARequestAmount] ,
                  [VendorID] ,
                  [DeductibleSingleBookFlag] ,
                  [MaxOutofPocketSingleBookFlag] ,
                  [PlanStopLossSingleBookFlag] ,
                  [TDSSingleBookFlag] ,
                  [VaccinePharmacyType] ,
                  [VaccineAdminAmount] ,
                  [VaccineAdminType] ,
                  [CDHVendorValue] ,
                  [ACRAdminFlag] ,
                  [MemberACRAmount] ,
                  [SuppPayerPaidAmount] ,
                  [SuppPayerCopayAmount] ,
                  [SuppPayerCoverageCode] ,
                  [SuppPayerCovDeductAmt] ,
                  [SuppPayerCoveredCopayAmt] ,
                  [SuppPayerCoveredAncillary] ,
                  [SuppPayerCoveredCopayAddonAmt] ,
                  [FullRxNumber] ,
                  [PatientResidence] ,
                  [NXExistsIndicator] ,
                  [PrescriptionOriginCode] ,
                  [GenericProductIndicator] ,
                  [COBRecoveryAmount] ,
                  [PreCOBBilledClaimAmount] ,
                  [DrugCalcDiscAmount] ,
                  [DrugDiscExclusionReasonCode] ,
                  [DrugDiscountApplicableCode] ,
                  [DrugDiscEligibleCostAmount] ,
                  [PDEDeleteCode] ,
                  [MICompoundIndicator] ,
                  [MICompoundCoverageOption] ,
                  [MILevelOfEffort] ,
                  [MIProfServiceFeeAmount] ,
                  [MICompoundIngredientCount] ,
                  [MICompoundMEDDElig] ,
                  [MICompoundMEDDInElig] ,
                  [MICompMedDFlatCopayAmount] ,
                  [MICompMedDPercentCopayAmount] ,
                  [MICompMedDEligMbrPaidAmount] ,
                  [MICompMedDEligPlanPaidAmount] ,
                  [MICompMedDEligCostAmount] ,
                  [SrcSysID] ,
                  [ETLBatchID] ,
                  [ETLDateCreated] ,
                  [ETLDateUpdated] ,
                  [DrugStrength] ,
                  [TransactionID] ,
                  [XrefTransactionID] ,
                  [TransactionTypeCode] ,
                  [AdjustReasonTypeCode] ,
                  [BatchID] ,
                  [PaymentRefrenceNumber] ,
                  [HashDiff] ,
                  [RecordSource]
                )
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(b.Centauriesi1900ID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProductIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RecordIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProcessorNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BatchNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.DateBilled, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PharmacyNABPNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriptionNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateFilled, ''))), ':', RTRIM(LTRIM(COALESCE(a.UandCFlag, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.NationalDrugCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.NeworRefillCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MetricQuantity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DaysSupply, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalculatedIngredientCost, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DispensingFee, ''))), ':', RTRIM(LTRIM(COALESCE(a.TaxAmount, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.CopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DeductibleAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountBilled, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountClaimed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountDisallowed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberDateofBirth, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CardHolderID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.GroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriberDEANumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RelationshipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimSubmissionType, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProviderContract, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TierNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TherapeuticClass, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GenericCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.BPLNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.UandCAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PriorAuthorizationNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.FormularyStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateReceived, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CheckNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType2, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PassedCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AncillaryAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimAdminFee, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AverageWholesalePrice, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BrandGenericCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientPrescribingPhysician, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberPCPAssignment, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimType, ''))), ':', RTRIM(LTRIM(COALESCE(a.DOBDefault, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.ESIAdjudicationAuditNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MACAmount, ''))), ':', RTRIM(LTRIM(COALESCE(a.ChainCode, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.MasterGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCity, ''))), ':', RTRIM(LTRIM(COALESCE(a.PayeeState, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PayeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PhysicianName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberProgram, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode1, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode2, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode3, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROverflow, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DURIntervention, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROutcomeCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DosageCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.RefillNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.Age, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AdjustmentReasonCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GeneralPurposeField, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PharmacyDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MaintenanceDrugIndicator, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugLegalStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ReimbursementFlag, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GroupName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmplZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeCity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeState, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalcBillCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProductType, ''))), ':'))
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.FDBMaintIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PartialFillStatusCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjudicationDate, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CompoundCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxoutofpocketAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ProgramStopLossAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FSAVendorCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherPayorAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PICADrugCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FederalDrugClassCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CoinsuranceAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DependentCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanDesignator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyServiceType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientLocation, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAAppliedAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAESIFund, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedicareDCoveredDrug, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.LICSSubsidyAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedBDrug, ''))), ':', RTRIM(LTRIM(COALESCE(a.MedBClaim, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.CopayTierLevelNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OfficeofInspectorGeneralFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ANDAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHResponseID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHESIResponseCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRASingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRARequestAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VendorID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DeductibleSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxOutofPocketSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanStopLossSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TDSSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccinePharmacyType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHVendorValue, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ACRAdminFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MemberACRAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCovDeductAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredAncillary, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAddonAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FullRxNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientResidence, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.NXExistsIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriptionOriginCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.GenericProductIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.COBRecoveryAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PreCOBBilledClaimAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugCalcDiscAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscExclusionReasonCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscountApplicableCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscEligibleCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PDEDeleteCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundCoverageOption, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MILevelOfEffort, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MIProfServiceFeeAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIngredientCount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDInElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDFlatCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDPercentCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligMbrPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligPlanPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SrcSysID, ''))), ':', RTRIM(LTRIM(COALESCE(a.ETLBatchID, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.ETLDateCreated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ETLDateUpdated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugStrength, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.XrefTransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjustReasonTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.BatchID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PaymentRefrenceNumber, '')))))), 2)) ,
                        @LoadDate ,
                        b.esi1900HashKey ,
                        a.[ProductIdentifier] ,
                        a.[RecordIdentifier] ,
                        a.[ProcessorNumber] ,
                        a.[BatchNumber] ,
                        a.[DateBilled] ,
                        a.[PharmacyNABPNumber] ,
                        a.[PrescriptionNumber] ,
                        a.[DateFilled] ,
                        a.[UandCFlag] ,
                        a.[NationalDrugCode] ,
                        a.[DrugName] ,
                        a.[NeworRefillCode] ,
                        a.[MetricQuantity] ,
                        a.[DaysSupply] ,
                        a.[CalculatedIngredientCost] ,
                        a.[DispensingFee] ,
                        a.[TaxAmount] ,
                        a.[CopayAmount] ,
                        a.[DeductibleAmount] ,
                        a.[AmountBilled] ,
                        a.[AmountClaimed] ,
                        a.[AmountDisallowed] ,
                        a.[MemberLastName] ,
                        a.[MemberFirstName] ,
                        a.[MemberMiddleInitial] ,
                        a.[MemberDateofBirth] ,
                        a.[MemberGender] ,
                        a.[CardHolderID] ,
                        a.[MemberNumber] ,
                        a.[PlanType] ,
                        a.[GroupNumber] ,
                        a.[PrescriberDEANumber] ,
                        a.[RelationshipCode] ,
                        a.[ClaimSubmissionType] ,
                        a.[ProviderContract] ,
                        a.[TierNumber] ,
                        a.[TherapeuticClass] ,
                        a.[GenericCode] ,
                        a.[BPLNumber] ,
                        a.[UandCAmount] ,
                        a.[ESIDAWCode] ,
                        a.[PriorAuthorizationNumber] ,
                        a.[FormularyStatus] ,
                        a.[DateReceived] ,
                        a.[CheckNumber] ,
                        a.[PlanType2] ,
                        a.[PassedCopayAmount] ,
                        a.[AncillaryAmount] ,
                        a.[ClaimAdminFee] ,
                        a.[AverageWholesalePrice] ,
                        a.[BrandGenericCode] ,
                        a.[ClientPrescribingPhysician] ,
                        a.[ClientIdentifier] ,
                        a.[MemberPCPAssignment] ,
                        a.[ClaimType] ,
                        a.[DOBDefault] ,
                        a.[ESIAdjudicationAuditNumber] ,
                        a.[ESIExpandedGroupNumber] ,
                        a.[MACAmount] ,
                        a.[ChainCode] ,
                        a.[MasterGroupNumber] ,
                        a.[ExpandedGroupNumber] ,
                        a.[PayeeCheckName] ,
                        a.[PayeeCheckAddress] ,
                        a.[PayeeCity] ,
                        a.[PayeeState] ,
                        a.[PayeeZipCode] ,
                        a.[PayeeZipCodeExpanded] ,
                        a.[PhysicianName] ,
                        a.[MemberProgram] ,
                        a.[DrugConflictCode1] ,
                        a.[DrugConflictCode2] ,
                        a.[DrugConflictCode3] ,
                        a.[DUROverflow] ,
                        a.[DURIntervention] ,
                        a.[DUROutcomeCode] ,
                        a.[DosageCode] ,
                        a.[RefillNumber] ,
                        a.[Age] ,
                        a.[AdjustmentReasonCode] ,
                        a.[GeneralPurposeField] ,
                        a.[PharmacyDAWCode] ,
                        a.[MaintenanceDrugIndicator] ,
                        a.[DrugLegalStatus] ,
                        a.[ESIGroupNumber] ,
                        a.[SubmittedDOB] ,
                        a.[SubmittedGender] ,
                        a.[ReimbursementFlag] ,
                        a.[EmployeeLastName] ,
                        a.[EmployeeFirstName] ,
                        a.[EmployeeMiddleInitial] ,
                        a.[EmployeeDOB] ,
                        a.[EmployeeGender] ,
                        a.[EmployeeZipCode] ,
                        a.[GroupName] ,
                        a.[EmplZipCodeExpanded] ,
                        a.[EmployeeAddress] ,
                        a.[EmployeeCity] ,
                        a.[EmployeeState] ,
                        a.[CalcBillCopayAmount] ,
                        a.[ProductType] ,
                        a.[FDBMaintIndicator] ,
                        a.[PartialFillStatusCode] ,
                        a.[AdjudicationDate] ,
                        a.[CompoundCode] ,
                        a.[MaxoutofpocketAmount] ,
                        a.[ProgramStopLossAmt] ,
                        a.[FSAVendorCode] ,
                        a.[OtherPayorAmount] ,
                        a.[OtherCoverageCode] ,
                        a.[PICADrugCode] ,
                        a.[FederalDrugClassCode] ,
                        a.[CoinsuranceAmount] ,
                        a.[DependentCode] ,
                        a.[PlanDesignator] ,
                        a.[PharmacyServiceType] ,
                        a.[PatientLocation] ,
                        a.[PrescriberQualifier] ,
                        a.[PrescriberIdentifier] ,
                        a.[PharmacyQualifier] ,
                        a.[PharmacyIdentifier] ,
                        a.[HRAAppliedAmount] ,
                        a.[HRAESIFund] ,
                        a.[MedicareDCoveredDrug] ,
                        a.[RetroLICSCode] ,
                        a.[RetroLICSAmount] ,
                        a.[LICSSubsidyAmount] ,
                        a.[MedBDrug] ,
                        a.[MedBClaim] ,
                        a.[CopayTierLevelNumber] ,
                        a.[OfficeofInspectorGeneralFlag] ,
                        a.[ANDAFlag] ,
                        a.[CDHResponseID] ,
                        a.[CDHESIResponseCode] ,
                        a.[HRAFlag] ,
                        a.[HRASingleBookFlag] ,
                        a.[HRARequestAmount] ,
                        a.[VendorID] ,
                        a.[DeductibleSingleBookFlag] ,
                        a.[MaxOutofPocketSingleBookFlag] ,
                        a.[PlanStopLossSingleBookFlag] ,
                        a.[TDSSingleBookFlag] ,
                        a.[VaccinePharmacyType] ,
                        a.[VaccineAdminAmount] ,
                        a.[VaccineAdminType] ,
                        a.[CDHVendorValue] ,
                        a.[ACRAdminFlag] ,
                        a.[MemberACRAmount] ,
                        a.[SuppPayerPaidAmount] ,
                        a.[SuppPayerCopayAmount] ,
                        a.[SuppPayerCoverageCode] ,
                        a.[SuppPayerCovDeductAmt] ,
                        a.[SuppPayerCoveredCopayAmt] ,
                        a.[SuppPayerCoveredAncillary] ,
                        a.[SuppPayerCoveredCopayAddonAmt] ,
                        a.[FullRxNumber] ,
                        a.[PatientResidence] ,
                        a.[NXExistsIndicator] ,
                        a.[PrescriptionOriginCode] ,
                        a.[GenericProductIndicator] ,
                        a.[COBRecoveryAmount] ,
                        a.[PreCOBBilledClaimAmount] ,
                        a.[DrugCalcDiscAmount] ,
                        a.[DrugDiscExclusionReasonCode] ,
                        a.[DrugDiscountApplicableCode] ,
                        a.[DrugDiscEligibleCostAmount] ,
                        a.[PDEDeleteCode] ,
                        a.[MICompoundIndicator] ,
                        a.[MICompoundCoverageOption] ,
                        a.[MILevelOfEffort] ,
                        a.[MIProfServiceFeeAmount] ,
                        a.[MICompoundIngredientCount] ,
                        a.[MICompoundMEDDElig] ,
                        a.[MICompoundMEDDInElig] ,
                        a.[MICompMedDFlatCopayAmount] ,
                        a.[MICompMedDPercentCopayAmount] ,
                        a.[MICompMedDEligMbrPaidAmount] ,
                        a.[MICompMedDEligPlanPaidAmount] ,
                        a.[MICompMedDEligCostAmount] ,
                        a.[SrcSysID] ,
                        a.[ETLBatchID] ,
                        a.[ETLDateCreated] ,
                        a.[ETLDateUpdated] ,
                        a.[DrugStrength] ,
                        a.[TransactionID] ,
                        a.[XrefTransactionID] ,
                        a.[TransactionTypeCode] ,
                        a.[AdjustReasonTypeCode] ,
                        a.[BatchID] ,
                        a.[PaymentRefrenceNumber] ,
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.ProductIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RecordIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProcessorNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BatchNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.DateBilled, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PharmacyNABPNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriptionNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateFilled, ''))), ':', RTRIM(LTRIM(COALESCE(a.UandCFlag, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.NationalDrugCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.NeworRefillCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MetricQuantity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DaysSupply, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalculatedIngredientCost, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DispensingFee, ''))), ':', RTRIM(LTRIM(COALESCE(a.TaxAmount, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.CopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DeductibleAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountBilled, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountClaimed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountDisallowed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberDateofBirth, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CardHolderID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.GroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriberDEANumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RelationshipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimSubmissionType, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProviderContract, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TierNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TherapeuticClass, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GenericCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.BPLNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.UandCAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PriorAuthorizationNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.FormularyStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateReceived, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CheckNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType2, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PassedCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AncillaryAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimAdminFee, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AverageWholesalePrice, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BrandGenericCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientPrescribingPhysician, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberPCPAssignment, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimType, ''))), ':', RTRIM(LTRIM(COALESCE(a.DOBDefault, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.ESIAdjudicationAuditNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MACAmount, ''))), ':', RTRIM(LTRIM(COALESCE(a.ChainCode, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.MasterGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCity, ''))), ':', RTRIM(LTRIM(COALESCE(a.PayeeState, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PayeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PhysicianName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberProgram, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode1, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode2, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode3, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROverflow, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DURIntervention, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROutcomeCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DosageCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.RefillNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.Age, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AdjustmentReasonCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GeneralPurposeField, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PharmacyDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MaintenanceDrugIndicator, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugLegalStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ReimbursementFlag, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GroupName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmplZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeCity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeState, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalcBillCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProductType, ''))), ':'))
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.FDBMaintIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PartialFillStatusCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjudicationDate, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CompoundCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxoutofpocketAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ProgramStopLossAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FSAVendorCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherPayorAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PICADrugCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FederalDrugClassCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CoinsuranceAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DependentCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanDesignator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyServiceType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientLocation, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAAppliedAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAESIFund, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedicareDCoveredDrug, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.LICSSubsidyAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedBDrug, ''))), ':', RTRIM(LTRIM(COALESCE(a.MedBClaim, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.CopayTierLevelNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OfficeofInspectorGeneralFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ANDAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHResponseID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHESIResponseCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRASingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRARequestAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VendorID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DeductibleSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxOutofPocketSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanStopLossSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TDSSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccinePharmacyType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHVendorValue, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ACRAdminFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MemberACRAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCovDeductAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredAncillary, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAddonAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FullRxNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientResidence, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.NXExistsIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriptionOriginCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.GenericProductIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.COBRecoveryAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PreCOBBilledClaimAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugCalcDiscAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscExclusionReasonCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscountApplicableCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscEligibleCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PDEDeleteCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundCoverageOption, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MILevelOfEffort, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MIProfServiceFeeAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIngredientCount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDInElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDFlatCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDPercentCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligMbrPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligPlanPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SrcSysID, ''))), ':', RTRIM(LTRIM(COALESCE(a.ETLBatchID, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.ETLDateCreated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ETLDateUpdated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugStrength, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.XrefTransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjustReasonTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.BatchID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PaymentRefrenceNumber, '')))))), 2)) ,
                        'GuildNet_esi_guildnet_1900_extract'
                FROM    CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a
                        INNER JOIN CHSDV.dbo.R_esi1900 b ON a.TransactionID = b.Clientesi1900ID
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.ProductIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RecordIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProcessorNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BatchNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.DateBilled, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PharmacyNABPNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriptionNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateFilled, ''))), ':', RTRIM(LTRIM(COALESCE(a.UandCFlag, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.NationalDrugCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.NeworRefillCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MetricQuantity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DaysSupply, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalculatedIngredientCost, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DispensingFee, ''))), ':', RTRIM(LTRIM(COALESCE(a.TaxAmount, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.CopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DeductibleAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountBilled, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountClaimed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountDisallowed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberDateofBirth, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CardHolderID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.GroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriberDEANumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RelationshipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimSubmissionType, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProviderContract, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TierNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TherapeuticClass, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GenericCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.BPLNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.UandCAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PriorAuthorizationNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.FormularyStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateReceived, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CheckNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType2, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PassedCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AncillaryAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimAdminFee, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AverageWholesalePrice, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BrandGenericCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientPrescribingPhysician, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberPCPAssignment, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimType, ''))), ':', RTRIM(LTRIM(COALESCE(a.DOBDefault, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.ESIAdjudicationAuditNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MACAmount, ''))), ':', RTRIM(LTRIM(COALESCE(a.ChainCode, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.MasterGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCity, ''))), ':', RTRIM(LTRIM(COALESCE(a.PayeeState, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PayeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PhysicianName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberProgram, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode1, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode2, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode3, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROverflow, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DURIntervention, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROutcomeCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DosageCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.RefillNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.Age, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AdjustmentReasonCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GeneralPurposeField, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PharmacyDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MaintenanceDrugIndicator, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugLegalStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ReimbursementFlag, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GroupName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmplZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeCity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeState, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalcBillCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProductType, ''))), ':'))
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.FDBMaintIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PartialFillStatusCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjudicationDate, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CompoundCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxoutofpocketAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ProgramStopLossAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FSAVendorCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherPayorAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PICADrugCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FederalDrugClassCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CoinsuranceAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DependentCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanDesignator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyServiceType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientLocation, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAAppliedAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAESIFund, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedicareDCoveredDrug, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.LICSSubsidyAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedBDrug, ''))), ':', RTRIM(LTRIM(COALESCE(a.MedBClaim, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.CopayTierLevelNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OfficeofInspectorGeneralFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ANDAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHResponseID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHESIResponseCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRASingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRARequestAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VendorID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DeductibleSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxOutofPocketSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanStopLossSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TDSSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccinePharmacyType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHVendorValue, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ACRAdminFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MemberACRAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCovDeductAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredAncillary, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAddonAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FullRxNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientResidence, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.NXExistsIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriptionOriginCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.GenericProductIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.COBRecoveryAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PreCOBBilledClaimAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugCalcDiscAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscExclusionReasonCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscountApplicableCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscEligibleCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PDEDeleteCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundCoverageOption, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MILevelOfEffort, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MIProfServiceFeeAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIngredientCount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDInElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDFlatCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDPercentCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligMbrPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligPlanPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SrcSysID, ''))), ':', RTRIM(LTRIM(COALESCE(a.ETLBatchID, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.ETLDateCreated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ETLDateUpdated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugStrength, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.XrefTransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjustReasonTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.BatchID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PaymentRefrenceNumber, '')))))), 2)) NOT IN (
                        SELECT  HashDiff
                        FROM    S_esi1900Details
                        WHERE   H_esi1900_RK = b.esi1900HashKey COLLATE Compatibility_52_409_30003
                                AND RecordEndDate IS NULL )
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(b.Centauriesi1900ID, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ProductIdentifier, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.RecordIdentifier, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ProcessorNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.BatchNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.DateBilled, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.PharmacyNABPNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PrescriptionNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DateFilled, ''))), ':', RTRIM(LTRIM(COALESCE(a.UandCFlag, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.NationalDrugCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DrugName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.NeworRefillCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MetricQuantity, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DaysSupply, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.CalculatedIngredientCost, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DispensingFee, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.TaxAmount, ''))), ':', RTRIM(LTRIM(COALESCE(a.CopayAmount, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.DeductibleAmount, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.AmountBilled, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.AmountClaimed, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.AmountDisallowed, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberLastName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberFirstName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberMiddleInitial, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberDateofBirth, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberGender, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.CardHolderID, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.GroupNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PrescriberDEANumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.RelationshipCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ClaimSubmissionType, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ProviderContract, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.TierNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.TherapeuticClass, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.GenericCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.BPLNumber, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.UandCAmount, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ESIDAWCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PriorAuthorizationNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.FormularyStatus, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DateReceived, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.CheckNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType2, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.PassedCopayAmount, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.AncillaryAmount, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ClaimAdminFee, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.AverageWholesalePrice, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.BrandGenericCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ClientPrescribingPhysician, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ClientIdentifier, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberPCPAssignment, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ClaimType, ''))), ':', RTRIM(LTRIM(COALESCE(a.DOBDefault, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.ESIAdjudicationAuditNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ESIExpandedGroupNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MACAmount, ''))), ':', RTRIM(LTRIM(COALESCE(a.ChainCode, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.MasterGroupNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ExpandedGroupNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PayeeCheckName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PayeeCheckAddress, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PayeeCity, ''))), ':', RTRIM(LTRIM(COALESCE(a.PayeeState, ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE(a.PayeeZipCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PayeeZipCodeExpanded, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PhysicianName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MemberProgram, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DrugConflictCode1, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DrugConflictCode2, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DrugConflictCode3, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DUROverflow, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DURIntervention, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DUROutcomeCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DosageCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.RefillNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.Age, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.AdjustmentReasonCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.GeneralPurposeField, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.PharmacyDAWCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.MaintenanceDrugIndicator, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.DrugLegalStatus, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ESIGroupNumber, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.SubmittedDOB, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.SubmittedGender, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ReimbursementFlag, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeLastName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeFirstName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeMiddleInitial, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeDOB, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeGender, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeZipCode, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.GroupName, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmplZipCodeExpanded, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeAddress, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeCity, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.EmployeeState, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.CalcBillCopayAmount, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(a.ProductType, ''))), ':'))
                                                           + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.FDBMaintIndicator, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PartialFillStatusCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.AdjudicationDate, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.CompoundCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MaxoutofpocketAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.ProgramStopLossAmt, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.FSAVendorCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.OtherPayorAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.OtherCoverageCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PICADrugCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.FederalDrugClassCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.CoinsuranceAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DependentCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PlanDesignator, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PharmacyServiceType, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PatientLocation, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PrescriberQualifier, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PrescriberIdentifier, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PharmacyQualifier, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PharmacyIdentifier, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.HRAAppliedAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.HRAESIFund, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MedicareDCoveredDrug, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.RetroLICSCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.RetroLICSAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.LICSSubsidyAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MedBDrug, ''))), ':', RTRIM(LTRIM(COALESCE(a.MedBClaim, ''))),
                                                                          ':', RTRIM(LTRIM(COALESCE(a.CopayTierLevelNumber, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.OfficeofInspectorGeneralFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.ANDAFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.CDHResponseID, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.CDHESIResponseCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.HRAFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.HRASingleBookFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.HRARequestAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.VendorID, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DeductibleSingleBookFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MaxOutofPocketSingleBookFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PlanStopLossSingleBookFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.TDSSingleBookFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.VaccinePharmacyType, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.VaccineAdminAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.VaccineAdminType, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.CDHVendorValue, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.ACRAdminFlag, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MemberACRAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerPaidAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerCopayAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerCoverageCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerCovDeductAmt, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAmt, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredAncillary, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAddonAmt, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.FullRxNumber, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PatientResidence, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.NXExistsIndicator, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PrescriptionOriginCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.GenericProductIndicator, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.COBRecoveryAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PreCOBBilledClaimAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DrugCalcDiscAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DrugDiscExclusionReasonCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DrugDiscountApplicableCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DrugDiscEligibleCostAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PDEDeleteCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompoundIndicator, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompoundCoverageOption, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MILevelOfEffort, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MIProfServiceFeeAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompoundIngredientCount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompoundMEDDElig, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompoundMEDDInElig, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompMedDFlatCopayAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompMedDPercentCopayAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompMedDEligMbrPaidAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompMedDEligPlanPaidAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.MICompMedDEligCostAmount, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.SrcSysID, ''))), ':', RTRIM(LTRIM(COALESCE(a.ETLBatchID, ''))),
                                                                          ':', RTRIM(LTRIM(COALESCE(a.ETLDateCreated, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.ETLDateUpdated, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.DrugStrength, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.TransactionID, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.XrefTransactionID, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.TransactionTypeCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.AdjustReasonTypeCode, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.BatchID, ''))), ':',
                                                                          RTRIM(LTRIM(COALESCE(a.PaymentRefrenceNumber, '')))))), 2)) ,
                        b.esi1900HashKey ,
                        a.[ProductIdentifier] ,
                        a.[RecordIdentifier] ,
                        a.[ProcessorNumber] ,
                        a.[BatchNumber] ,
                        a.[DateBilled] ,
                        a.[PharmacyNABPNumber] ,
                        a.[PrescriptionNumber] ,
                        a.[DateFilled] ,
                        a.[UandCFlag] ,
                        a.[NationalDrugCode] ,
                        a.[DrugName] ,
                        a.[NeworRefillCode] ,
                        a.[MetricQuantity] ,
                        a.[DaysSupply] ,
                        a.[CalculatedIngredientCost] ,
                        a.[DispensingFee] ,
                        a.[TaxAmount] ,
                        a.[CopayAmount] ,
                        a.[DeductibleAmount] ,
                        a.[AmountBilled] ,
                        a.[AmountClaimed] ,
                        a.[AmountDisallowed] ,
                        a.[MemberLastName] ,
                        a.[MemberFirstName] ,
                        a.[MemberMiddleInitial] ,
                        a.[MemberDateofBirth] ,
                        a.[MemberGender] ,
                        a.[CardHolderID] ,
                        a.[MemberNumber] ,
                        a.[PlanType] ,
                        a.[GroupNumber] ,
                        a.[PrescriberDEANumber] ,
                        a.[RelationshipCode] ,
                        a.[ClaimSubmissionType] ,
                        a.[ProviderContract] ,
                        a.[TierNumber] ,
                        a.[TherapeuticClass] ,
                        a.[GenericCode] ,
                        a.[BPLNumber] ,
                        a.[UandCAmount] ,
                        a.[ESIDAWCode] ,
                        a.[PriorAuthorizationNumber] ,
                        a.[FormularyStatus] ,
                        a.[DateReceived] ,
                        a.[CheckNumber] ,
                        a.[PlanType2] ,
                        a.[PassedCopayAmount] ,
                        a.[AncillaryAmount] ,
                        a.[ClaimAdminFee] ,
                        a.[AverageWholesalePrice] ,
                        a.[BrandGenericCode] ,
                        a.[ClientPrescribingPhysician] ,
                        a.[ClientIdentifier] ,
                        a.[MemberPCPAssignment] ,
                        a.[ClaimType] ,
                        a.[DOBDefault] ,
                        a.[ESIAdjudicationAuditNumber] ,
                        a.[ESIExpandedGroupNumber] ,
                        a.[MACAmount] ,
                        a.[ChainCode] ,
                        a.[MasterGroupNumber] ,
                        a.[ExpandedGroupNumber] ,
                        a.[PayeeCheckName] ,
                        a.[PayeeCheckAddress] ,
                        a.[PayeeCity] ,
                        a.[PayeeState] ,
                        a.[PayeeZipCode] ,
                        a.[PayeeZipCodeExpanded] ,
                        a.[PhysicianName] ,
                        a.[MemberProgram] ,
                        a.[DrugConflictCode1] ,
                        a.[DrugConflictCode2] ,
                        a.[DrugConflictCode3] ,
                        a.[DUROverflow] ,
                        a.[DURIntervention] ,
                        a.[DUROutcomeCode] ,
                        a.[DosageCode] ,
                        a.[RefillNumber] ,
                        a.[Age] ,
                        a.[AdjustmentReasonCode] ,
                        a.[GeneralPurposeField] ,
                        a.[PharmacyDAWCode] ,
                        a.[MaintenanceDrugIndicator] ,
                        a.[DrugLegalStatus] ,
                        a.[ESIGroupNumber] ,
                        a.[SubmittedDOB] ,
                        a.[SubmittedGender] ,
                        a.[ReimbursementFlag] ,
                        a.[EmployeeLastName] ,
                        a.[EmployeeFirstName] ,
                        a.[EmployeeMiddleInitial] ,
                        a.[EmployeeDOB] ,
                        a.[EmployeeGender] ,
                        a.[EmployeeZipCode] ,
                        a.[GroupName] ,
                        a.[EmplZipCodeExpanded] ,
                        a.[EmployeeAddress] ,
                        a.[EmployeeCity] ,
                        a.[EmployeeState] ,
                        a.[CalcBillCopayAmount] ,
                        a.[ProductType] ,
                        a.[FDBMaintIndicator] ,
                        a.[PartialFillStatusCode] ,
                        a.[AdjudicationDate] ,
                        a.[CompoundCode] ,
                        a.[MaxoutofpocketAmount] ,
                        a.[ProgramStopLossAmt] ,
                        a.[FSAVendorCode] ,
                        a.[OtherPayorAmount] ,
                        a.[OtherCoverageCode] ,
                        a.[PICADrugCode] ,
                        a.[FederalDrugClassCode] ,
                        a.[CoinsuranceAmount] ,
                        a.[DependentCode] ,
                        a.[PlanDesignator] ,
                        a.[PharmacyServiceType] ,
                        a.[PatientLocation] ,
                        a.[PrescriberQualifier] ,
                        a.[PrescriberIdentifier] ,
                        a.[PharmacyQualifier] ,
                        a.[PharmacyIdentifier] ,
                        a.[HRAAppliedAmount] ,
                        a.[HRAESIFund] ,
                        a.[MedicareDCoveredDrug] ,
                        a.[RetroLICSCode] ,
                        a.[RetroLICSAmount] ,
                        a.[LICSSubsidyAmount] ,
                        a.[MedBDrug] ,
                        a.[MedBClaim] ,
                        a.[CopayTierLevelNumber] ,
                        a.[OfficeofInspectorGeneralFlag] ,
                        a.[ANDAFlag] ,
                        a.[CDHResponseID] ,
                        a.[CDHESIResponseCode] ,
                        a.[HRAFlag] ,
                        a.[HRASingleBookFlag] ,
                        a.[HRARequestAmount] ,
                        a.[VendorID] ,
                        a.[DeductibleSingleBookFlag] ,
                        a.[MaxOutofPocketSingleBookFlag] ,
                        a.[PlanStopLossSingleBookFlag] ,
                        a.[TDSSingleBookFlag] ,
                        a.[VaccinePharmacyType] ,
                        a.[VaccineAdminAmount] ,
                        a.[VaccineAdminType] ,
                        a.[CDHVendorValue] ,
                        a.[ACRAdminFlag] ,
                        a.[MemberACRAmount] ,
                        a.[SuppPayerPaidAmount] ,
                        a.[SuppPayerCopayAmount] ,
                        a.[SuppPayerCoverageCode] ,
                        a.[SuppPayerCovDeductAmt] ,
                        a.[SuppPayerCoveredCopayAmt] ,
                        a.[SuppPayerCoveredAncillary] ,
                        a.[SuppPayerCoveredCopayAddonAmt] ,
                        a.[FullRxNumber] ,
                        a.[PatientResidence] ,
                        a.[NXExistsIndicator] ,
                        a.[PrescriptionOriginCode] ,
                        a.[GenericProductIndicator] ,
                        a.[COBRecoveryAmount] ,
                        a.[PreCOBBilledClaimAmount] ,
                        a.[DrugCalcDiscAmount] ,
                        a.[DrugDiscExclusionReasonCode] ,
                        a.[DrugDiscountApplicableCode] ,
                        a.[DrugDiscEligibleCostAmount] ,
                        a.[PDEDeleteCode] ,
                        a.[MICompoundIndicator] ,
                        a.[MICompoundCoverageOption] ,
                        a.[MILevelOfEffort] ,
                        a.[MIProfServiceFeeAmount] ,
                        a.[MICompoundIngredientCount] ,
                        a.[MICompoundMEDDElig] ,
                        a.[MICompoundMEDDInElig] ,
                        a.[MICompMedDFlatCopayAmount] ,
                        a.[MICompMedDPercentCopayAmount] ,
                        a.[MICompMedDEligMbrPaidAmount] ,
                        a.[MICompMedDEligPlanPaidAmount] ,
                        a.[MICompMedDEligCostAmount] ,
                        a.[SrcSysID] ,
                        a.[ETLBatchID] ,
                        a.[ETLDateCreated] ,
                        a.[ETLDateUpdated] ,
                        a.[DrugStrength] ,
                        a.[TransactionID] ,
                        a.[XrefTransactionID] ,
                        a.[TransactionTypeCode] ,
                        a.[AdjustReasonTypeCode] ,
                        a.[BatchID] ,
                        a.[PaymentRefrenceNumber] ,
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.ProductIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RecordIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProcessorNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BatchNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.DateBilled, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PharmacyNABPNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriptionNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateFilled, ''))), ':', RTRIM(LTRIM(COALESCE(a.UandCFlag, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.NationalDrugCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.NeworRefillCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MetricQuantity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DaysSupply, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalculatedIngredientCost, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DispensingFee, ''))), ':', RTRIM(LTRIM(COALESCE(a.TaxAmount, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.CopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DeductibleAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountBilled, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountClaimed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AmountDisallowed, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberDateofBirth, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CardHolderID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.GroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PrescriberDEANumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.RelationshipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimSubmissionType, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProviderContract, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TierNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.TherapeuticClass, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GenericCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.BPLNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.UandCAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PriorAuthorizationNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.FormularyStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DateReceived, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CheckNumber, ''))), ':', RTRIM(LTRIM(COALESCE(a.PlanType2, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PassedCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AncillaryAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimAdminFee, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AverageWholesalePrice, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.BrandGenericCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientPrescribingPhysician, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClientIdentifier, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberPCPAssignment, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ClaimType, ''))), ':', RTRIM(LTRIM(COALESCE(a.DOBDefault, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.ESIAdjudicationAuditNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MACAmount, ''))), ':', RTRIM(LTRIM(COALESCE(a.ChainCode, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.MasterGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ExpandedGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCheckAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeCity, ''))), ':', RTRIM(LTRIM(COALESCE(a.PayeeState, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.PayeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PayeeZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PhysicianName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MemberProgram, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode1, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode2, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugConflictCode3, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROverflow, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DURIntervention, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DUROutcomeCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DosageCode, ''))), ':', RTRIM(LTRIM(COALESCE(a.RefillNumber, ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE(a.Age, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.AdjustmentReasonCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GeneralPurposeField, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.PharmacyDAWCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.MaintenanceDrugIndicator, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.DrugLegalStatus, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ESIGroupNumber, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.SubmittedGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ReimbursementFlag, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeLastName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeFirstName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeMiddleInitial, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeDOB, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeGender, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeZipCode, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.GroupName, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmplZipCodeExpanded, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeAddress, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeCity, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.EmployeeState, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.CalcBillCopayAmount, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE(a.ProductType, ''))), ':'))
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.FDBMaintIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PartialFillStatusCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjudicationDate, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CompoundCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxoutofpocketAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ProgramStopLossAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FSAVendorCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherPayorAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OtherCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PICADrugCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FederalDrugClassCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CoinsuranceAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DependentCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanDesignator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyServiceType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientLocation, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriberIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyQualifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PharmacyIdentifier, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAAppliedAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAESIFund, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedicareDCoveredDrug, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.RetroLICSAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.LICSSubsidyAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MedBDrug, ''))), ':', RTRIM(LTRIM(COALESCE(a.MedBClaim, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.CopayTierLevelNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.OfficeofInspectorGeneralFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ANDAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHResponseID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHESIResponseCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRAFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRASingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.HRARequestAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VendorID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DeductibleSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MaxOutofPocketSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PlanStopLossSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TDSSingleBookFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccinePharmacyType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.VaccineAdminType, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.CDHVendorValue, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ACRAdminFlag, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MemberACRAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoverageCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCovDeductAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredAncillary, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SuppPayerCoveredCopayAddonAmt, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.FullRxNumber, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PatientResidence, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.NXExistsIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PrescriptionOriginCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.GenericProductIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.COBRecoveryAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PreCOBBilledClaimAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugCalcDiscAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscExclusionReasonCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscountApplicableCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugDiscEligibleCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PDEDeleteCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIndicator, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundCoverageOption, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MILevelOfEffort, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MIProfServiceFeeAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundIngredientCount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompoundMEDDInElig, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDFlatCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDPercentCopayAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligMbrPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligPlanPaidAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.MICompMedDEligCostAmount, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.SrcSysID, ''))), ':', RTRIM(LTRIM(COALESCE(a.ETLBatchID, ''))),
                                                                         ':', RTRIM(LTRIM(COALESCE(a.ETLDateCreated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.ETLDateUpdated, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.DrugStrength, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.XrefTransactionID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.TransactionTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.AdjustReasonTypeCode, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.BatchID, ''))), ':',
                                                                         RTRIM(LTRIM(COALESCE(a.PaymentRefrenceNumber, '')))))), 2));

	--RECORD END DATE CLEANUP
        UPDATE  dbo.S_esi1900Details
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate))
                                  FROM      dbo.S_esi1900Details z
                                  WHERE     z.H_esi1900_RK = a.H_esi1900_RK
                                            AND z.LoadDate > a.LoadDate
                                )
        FROM    dbo.S_esi1900Details a
        WHERE   a.RecordEndDate IS NULL; 


			
			--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract

			--History Table
        IF ( SELECT COUNT(*)
             FROM   dbo.TableNames
             WHERE  TableName = 'S_esi1900Details'
           ) = 0
            INSERT  INTO dbo.TableNames
                    ( TableName, CreateDate )
            VALUES  ( 'S_esi1900Details', GETDATE() );


--Load History Table for S_esi1900Details

        INSERT  INTO LoadHistory2
                ( TableName_PK ,
                  HashKey ,
                  RecordSource_PK
                )
                SELECT	DISTINCT
                        ( SELECT    TableName_PK
                          FROM      TableNames
                          WHERE     TableName = 'S_esi1900Details'
                        ) ,
                        b.esi1900HashKey ,
                        ( SELECT    RecordSource_PK
                          FROM      RecordSources
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003
                        )
                FROM    CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a
                        INNER JOIN CHSDV.dbo.R_esi1900 b ON a.TransactionID = b.Clientesi1900ID   COLLATE Compatibility_52_409_30003; 


--MKM301
		
--		DECLARE @LoadDate  DATETIME
--SET @LoadDate = GETDATE()



        INSERT  INTO [dbo].[S_MKM301Details]
                ( [S_MKM301Details_RK] ,
                  [LoadDate] ,
                  [H_MKM301_RK] ,
                  [CLAIM NO  ] ,
                  [CLM LN NO  ] ,
                  [NO-UNITS  ] ,
                  [PAIDDTE  ] ,
                  [F D S   ] ,
                  [L D S   ] ,
                  [ALLOW AMT    ] ,
                  [SUBMIT AMT   ] ,
                  [COINS AMT    ] ,
                  [COPAY AMT    ] ,
                  [DEDUCT AMT   ] ,
                  [PAID AMT     ] ,
                  [COB AMT      ] ,
                  [GROUP     ] ,
                  [CAT   ] ,
                  [EVAL ] ,
                  [PROVIDER ] ,
                  [TOP ] ,
                  [PAR ] ,
                  [CERTIFICA ] ,
                  [MEMNO ] ,
                  [DIAGNO ] ,
                  [SERVCD ] ,
                  [PROC-C ] ,
                  [PLCSRV ] ,
                  [NETWID ] ,
                  [HDREVA ] ,
                  [FUNDC ] ,
                  [FUNDTP ] ,
                  [CLMTYP ] ,
                  [DFLTICD ] ,
                  [DFLTCPT4 ] ,
                  [DFLTCPT4M ] ,
                  [ICD ] ,
                  [ICDTYP ] ,
                  [CPT4  ] ,
                  [CPT4-M1] ,
                  [CPT4-M2] ,
                  [NOPYFLD] ,
                  [PROVIDER-NPI] ,
                  [HashDiff] ,
                  [RecordSource]
                )
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(b.CentauriMKM301ID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CLAIM NO  ], ''))), ':', RTRIM(LTRIM(COALESCE([CLM LN NO  ], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([NO-UNITS  ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PAIDDTE  ], ''))), ':', RTRIM(LTRIM(COALESCE([F D S   ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([L D S   ], ''))), ':', RTRIM(LTRIM(COALESCE([ALLOW AMT    ], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([SUBMIT AMT   ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([COINS AMT    ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([COPAY AMT    ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DEDUCT AMT   ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PAID AMT     ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([COB AMT      ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([GROUP     ], ''))), ':', RTRIM(LTRIM(COALESCE([CAT   ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', RTRIM(LTRIM(COALESCE([PROVIDER ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([TOP ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CERTIFICA ], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DIAGNO ], ''))), ':', RTRIM(LTRIM(COALESCE([SERVCD ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROC-C ], ''))), ':', RTRIM(LTRIM(COALESCE([PLCSRV ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([NETWID ], ''))), ':', RTRIM(LTRIM(COALESCE([HDREVA ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([FUNDC ], ''))), ':', RTRIM(LTRIM(COALESCE([FUNDTP ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CLMTYP ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTICD ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DFLTCPT4 ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTCPT4M ], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([ICD ], ''))), ':', RTRIM(LTRIM(COALESCE([ICDTYP ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CPT4  ], ''))), ':', RTRIM(LTRIM(COALESCE([CPT4-M1], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CPT4-M2], ''))), ':', RTRIM(LTRIM(COALESCE([NOPYFLD], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROVIDER-NPI], ''))), RTRIM(LTRIM(COALESCE(b.LoadDate, '')))))), 2)) ,
                        @LoadDate ,
                        b.MKM301HashKey ,
                        a.[CLAIM NO  ] ,
                        a.[CLM LN NO  ] ,
                        a.[NO-UNITS  ] ,
                        a.[PAIDDTE  ] ,
                        a.[F D S   ] ,
                        a.[L D S   ] ,
                        a.[ALLOW AMT    ] ,
                        a.[SUBMIT AMT   ] ,
                        a.[COINS AMT    ] ,
                        a.[COPAY AMT    ] ,
                        a.[DEDUCT AMT   ] ,
                        a.[PAID AMT     ] ,
                        a.[COB AMT      ] ,
                        a.[GROUP     ] ,
                        a.[CAT   ] ,
                        a.[EVAL ] ,
                        a.[PROVIDER ] ,
                        a.[TOP ] ,
                        a.[PAR ] ,
                        a.[CERTIFICA ] ,
                        a.[MEMNO ] ,
                        a.[DIAGNO ] ,
                        a.[SERVCD ] ,
                        a.[PROC-C ] ,
                        a.[PLCSRV ] ,
                        a.[NETWID ] ,
                        a.[HDREVA ] ,
                        a.[FUNDC ] ,
                        a.[FUNDTP ] ,
                        a.[CLMTYP ] ,
                        a.[DFLTICD ] ,
                        a.[DFLTCPT4 ] ,
                        a.[DFLTCPT4M ] ,
                        a.[ICD ] ,
                        a.[ICDTYP ] ,
                        a.[CPT4  ] ,
                        a.[CPT4-M1] ,
                        a.[CPT4-M2] ,
                        a.[NOPYFLD] ,
                        a.[PROVIDER-NPI] ,
                        a.GHASH ,
                        'GuildNet_GHI_MKM301_MEDCLAIMS_DELM'
                FROM    CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] a
                        INNER JOIN CHSDV.dbo.R_MKM301 b ON a.GHASH = b.ClientMKM301ID
                WHERE   a.GHASH  COLLATE Compatibility_52_409_30003 NOT IN ( SELECT HashDiff
                                                                             FROM   dbo.S_MKM301Details
                                                                             WHERE  H_MKM301_RK = b.MKM301HashKey  COLLATE Compatibility_52_409_30003
                                                                                    AND RecordEndDate IS NULL )
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(b.CentauriMKM301ID, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CLAIM NO  ], ''))), ':', RTRIM(LTRIM(COALESCE([CLM LN NO  ], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([NO-UNITS  ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PAIDDTE  ], ''))), ':', RTRIM(LTRIM(COALESCE([F D S   ], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([L D S   ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([ALLOW AMT    ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([SUBMIT AMT   ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([COINS AMT    ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([COPAY AMT    ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DEDUCT AMT   ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PAID AMT     ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([COB AMT      ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([GROUP     ], ''))), ':', RTRIM(LTRIM(COALESCE([CAT   ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', RTRIM(LTRIM(COALESCE([PROVIDER ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([TOP ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CERTIFICA ], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DIAGNO ], ''))), ':', RTRIM(LTRIM(COALESCE([SERVCD ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROC-C ], ''))), ':', RTRIM(LTRIM(COALESCE([PLCSRV ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([NETWID ], ''))), ':', RTRIM(LTRIM(COALESCE([HDREVA ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([FUNDC ], ''))), ':', RTRIM(LTRIM(COALESCE([FUNDTP ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CLMTYP ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTICD ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DFLTCPT4 ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTCPT4M ], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([ICD ], ''))), ':', RTRIM(LTRIM(COALESCE([ICDTYP ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CPT4  ], ''))), ':', RTRIM(LTRIM(COALESCE([CPT4-M1], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CPT4-M2], ''))), ':', RTRIM(LTRIM(COALESCE([NOPYFLD], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROVIDER-NPI], ''))), RTRIM(LTRIM(COALESCE(b.LoadDate, '')))))), 2)) ,
                        b.MKM301HashKey ,
                        a.[CLAIM NO  ] ,
                        a.[CLM LN NO  ] ,
                        a.[NO-UNITS  ] ,
                        a.[PAIDDTE  ] ,
                        a.[F D S   ] ,
                        a.[L D S   ] ,
                        a.[ALLOW AMT    ] ,
                        a.[SUBMIT AMT   ] ,
                        a.[COINS AMT    ] ,
                        a.[COPAY AMT    ] ,
                        a.[DEDUCT AMT   ] ,
                        a.[PAID AMT     ] ,
                        a.[COB AMT      ] ,
                        a.[GROUP     ] ,
                        a.[CAT   ] ,
                        a.[EVAL ] ,
                        a.[PROVIDER ] ,
                        a.[TOP ] ,
                        a.[PAR ] ,
                        a.[CERTIFICA ] ,
                        a.[MEMNO ] ,
                        a.[DIAGNO ] ,
                        a.[SERVCD ] ,
                        a.[PROC-C ] ,
                        a.[PLCSRV ] ,
                        a.[NETWID ] ,
                        a.[HDREVA ] ,
                        a.[FUNDC ] ,
                        a.[FUNDTP ] ,
                        a.[CLMTYP ] ,
                        a.[DFLTICD ] ,
                        a.[DFLTCPT4 ] ,
                        a.[DFLTCPT4M ] ,
                        a.[ICD ] ,
                        a.[ICDTYP ] ,
                        a.[CPT4  ] ,
                        a.[CPT4-M1] ,
                        a.[CPT4-M2] ,
                        a.[NOPYFLD] ,
                        a.[PROVIDER-NPI] ,
                        a.GHASH;



	--RECORD END DATE CLEANUP
        UPDATE  dbo.S_MKM301Details
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate))
                                  FROM      dbo.S_MKM301Details z
                                  WHERE     z.H_MKM301_RK = a.H_MKM301_RK
                                            AND z.LoadDate > a.LoadDate
                                )
        FROM    dbo.S_MKM301Details a
        WHERE   a.RecordEndDate IS NULL; 

			--History Table
        IF ( SELECT COUNT(*)
             FROM   dbo.TableNames
             WHERE  TableName = 'S_MKM301Details'
           ) = 0
            INSERT  INTO dbo.TableNames
                    ( TableName, CreateDate )
            VALUES  ( 'S_MKM301Details', GETDATE() );


			
--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM]
--Load History Table for S_esi1900Details

        INSERT  INTO LoadHistory2
                ( TableName_PK ,
                  HashKey ,
                  RecordSource_PK
                )
                SELECT	DISTINCT
                        ( SELECT    TableName_PK
                          FROM      TableNames
                          WHERE     TableName = 'S_MKM301Details'
                        ) ,
                        b.MKM301HashKey ,
                        ( SELECT    RecordSource_PK
                          FROM      RecordSources
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003
                        )
                FROM    CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] a
                        INNER JOIN CHSDV.dbo.R_MKM301 b ON a.GHASH  COLLATE Compatibility_52_409_30003 = b.ClientMKM301ID;




--MKM302
	
--		DECLARE @LoadDate  DATETIME
--SET @LoadDate = GETDATE()

        INSERT  INTO [dbo].[S_MKM302Details]
                ( [S_MKM302Details_RK] ,
                  [LoadDate] ,
                  [H_MKM302_RK] ,
                  [CLAIM_NO   ] ,
                  [EVAL ] ,
                  [PAID_DATE] ,
                  [ADMIT_DATE] ,
                  [DISCHG_DTE] ,
                  [ALLOW_AMT] ,
                  [SUBMI_AMT] ,
                  [COINS_AMT] ,
                  [COPAY_AMT] ,
                  [DEDUCT_AMT] ,
                  [PAID_AMT] ,
                  [NONCOV_AMT] ,
                  [APC_COPAY_AMT] ,
                  [GROUP ] ,
                  [CAT_3 ] ,
                  [PAR IND] ,
                  [PROV_NUMBER] ,
                  [PROVFIX] ,
                  [COVDAYS] ,
                  [NONCOVDAYS] ,
                  [ADMITTYPE] ,
                  [DRG] ,
                  [MEMNO] ,
                  [IN_OUT] ,
                  [CPAYDEDCT] ,
                  [DIAGNOS] ,
                  [DIAG1] ,
                  [DIAG2] ,
                  [DIAG3] ,
                  [DIAG4] ,
                  [DIAG5] ,
                  [DIAG6] ,
                  [DIAG7] ,
                  [DIAG8] ,
                  [DIAG9] ,
                  [P PROC] ,
                  [P PRDTE] ,
                  [PROCED1] ,
                  [PRODTE1] ,
                  [PROCED2] ,
                  [PRODTE2] ,
                  [PROCED3] ,
                  [PRODTE3] ,
                  [PROCED4] ,
                  [PRODTE4] ,
                  [PROCED5] ,
                  [PRODTE5] ,
                  [PROCED6] ,
                  [PRODTE6] ,
                  [PROCED7] ,
                  [PRODTE7] ,
                  [ADMITDIAG] ,
                  [TREAT_PLAN] ,
                  [CERTIFICATE] ,
                  [CLMTYPE] ,
                  [PRICRSON_1] ,
                  [PRICRSON_2] ,
                  [PRICELEV] ,
                  [FSCALCIN ] ,
                  [TARGET_SRV] ,
                  [N_OCCURS] ,
                  [FACILITY] ,
                  [TOTPAYAMT] ,
                  [CLAIM-NPI] ,
                  [ICD-TYPE-IND] ,
                  [HashDiff] ,
                  [RecordSource]
                )
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(b.CentauriMKM302ID, ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CLAIM_NO   ], ''))), ':', RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PAID_DATE], ''))), ':', RTRIM(LTRIM(COALESCE([ADMIT_DATE], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([DISCHG_DTE], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([ALLOW_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([SUBMI_AMT], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([COINS_AMT], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([DEDUCT_AMT], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([PAID_AMT], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([NONCOV_AMT], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([APC_COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([GROUP ], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([CAT_3 ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR IND], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([PROV_NUMBER], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROVFIX], ''))), ':', RTRIM(LTRIM(COALESCE([COVDAYS], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([NONCOVDAYS], ''))), ':', RTRIM(LTRIM(COALESCE([ADMITTYPE], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([DRG], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([IN_OUT], ''))), ':', RTRIM(LTRIM(COALESCE([CPAYDEDCT], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DIAGNOS], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG1], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DIAG2], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG3], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DIAG4], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG5], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DIAG6], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG7], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([DIAG8], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG9], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([P PROC], ''))), ':', RTRIM(LTRIM(COALESCE([P PRDTE], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED1], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE1], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED2], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE2], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED3], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE3], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED4], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE4], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED5], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE5], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED6], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE6], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PROCED7], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE7], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([ADMITDIAG], ''))), ':', RTRIM(LTRIM(COALESCE([TREAT_PLAN], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([CERTIFICATE], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([CLMTYPE], ''))), ':', RTRIM(LTRIM(COALESCE([PRICRSON_1], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([PRICRSON_2], ''))), ':', RTRIM(LTRIM(COALESCE([PRICELEV], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([FSCALCIN ], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([TARGET_SRV], ''))), ':', RTRIM(LTRIM(COALESCE([N_OCCURS], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([FACILITY], ''))), ':', RTRIM(LTRIM(COALESCE([TOTPAYAMT], ''))),
                                                                       ':', RTRIM(LTRIM(COALESCE([CLAIM-NPI], ''))), ':',
                                                                       RTRIM(LTRIM(COALESCE([ICD-TYPE-IND], ''))), ':', RTRIM(LTRIM(COALESCE(b.LoadDate, '')))))), 2)) ,
                        @LoadDate ,
                        b.MKM302HashKey ,
                        [CLAIM_NO   ] ,
                        [EVAL ] ,
                        [PAID_DATE] ,
                        [ADMIT_DATE] ,
                        [DISCHG_DTE] ,
                        [ALLOW_AMT] ,
                        [SUBMI_AMT] ,
                        [COINS_AMT] ,
                        [COPAY_AMT] ,
                        [DEDUCT_AMT] ,
                        [PAID_AMT] ,
                        [NONCOV_AMT] ,
                        [APC_COPAY_AMT] ,
                        [GROUP ] ,
                        [CAT_3 ] ,
                        [PAR IND] ,
                        [PROV_NUMBER] ,
                        [PROVFIX] ,
                        [COVDAYS] ,
                        [NONCOVDAYS] ,
                        [ADMITTYPE] ,
                        [DRG] ,
                        [MEMNO] ,
                        [IN_OUT] ,
                        [CPAYDEDCT] ,
                        [DIAGNOS] ,
                        [DIAG1] ,
                        [DIAG2] ,
                        [DIAG3] ,
                        [DIAG4] ,
                        [DIAG5] ,
                        [DIAG6] ,
                        [DIAG7] ,
                        [DIAG8] ,
                        [DIAG9] ,
                        [P PROC] ,
                        [P PRDTE] ,
                        [PROCED1] ,
                        [PRODTE1] ,
                        [PROCED2] ,
                        [PRODTE2] ,
                        [PROCED3] ,
                        [PRODTE3] ,
                        [PROCED4] ,
                        [PRODTE4] ,
                        [PROCED5] ,
                        [PRODTE5] ,
                        [PROCED6] ,
                        [PRODTE6] ,
                        [PROCED7] ,
                        [PRODTE7] ,
                        [ADMITDIAG] ,
                        [TREAT_PLAN] ,
                        [CERTIFICATE] ,
                        [CLMTYPE] ,
                        [PRICRSON_1] ,
                        [PRICRSON_2] ,
                        [PRICELEV] ,
                        [FSCALCIN ] ,
                        [TARGET_SRV] ,
                        [N_OCCURS] ,
                        [FACILITY] ,
                        [TOTPAYAMT] ,
                        [CLAIM-NPI] ,
                        [ICD-TYPE-IND] ,
                        a.GHASH ,
                        'GuildNet_ghi_mkm302_hospclaims_delm'
                FROM    CHSStaging.[dbo].GuildNet_ghi_mkm302_hospclaims_delm a
                        INNER JOIN CHSDV.dbo.R_MKM302 b ON a.GHASH = b.ClientMKM302ID
                WHERE   a.GHASH  COLLATE Compatibility_52_409_30003 NOT IN ( SELECT HashDiff
                                                                             FROM   dbo.S_MKM302Details
                                                                             WHERE  H_MKM302_RK = b.MKM302HashKey  COLLATE Compatibility_52_409_30003
                                                                                    AND RecordEndDate IS NULL )
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(b.CentauriMKM302ID, ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CLAIM_NO   ], ''))), ':', RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PAID_DATE], ''))), ':', RTRIM(LTRIM(COALESCE([ADMIT_DATE], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([DISCHG_DTE], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([ALLOW_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([SUBMI_AMT], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([COINS_AMT], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([DEDUCT_AMT], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([PAID_AMT], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([NONCOV_AMT], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([APC_COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([GROUP ], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([CAT_3 ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR IND], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([PROV_NUMBER], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROVFIX], ''))), ':', RTRIM(LTRIM(COALESCE([COVDAYS], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([NONCOVDAYS], ''))), ':', RTRIM(LTRIM(COALESCE([ADMITTYPE], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([DRG], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([IN_OUT], ''))), ':', RTRIM(LTRIM(COALESCE([CPAYDEDCT], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DIAGNOS], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG1], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DIAG2], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG3], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DIAG4], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG5], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DIAG6], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG7], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([DIAG8], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG9], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([P PROC], ''))), ':', RTRIM(LTRIM(COALESCE([P PRDTE], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED1], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE1], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED2], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE2], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED3], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE3], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED4], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE4], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED5], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE5], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED6], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE6], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PROCED7], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE7], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([ADMITDIAG], ''))), ':', RTRIM(LTRIM(COALESCE([TREAT_PLAN], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([CERTIFICATE], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([CLMTYPE], ''))), ':', RTRIM(LTRIM(COALESCE([PRICRSON_1], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([PRICRSON_2], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([PRICELEV], ''))), ':', RTRIM(LTRIM(COALESCE([FSCALCIN ], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([TARGET_SRV], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([N_OCCURS], ''))), ':', RTRIM(LTRIM(COALESCE([FACILITY], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE([TOTPAYAMT], ''))), ':', RTRIM(LTRIM(COALESCE([CLAIM-NPI], ''))),
                                                                        ':', RTRIM(LTRIM(COALESCE([ICD-TYPE-IND], ''))), ':',
                                                                        RTRIM(LTRIM(COALESCE(b.LoadDate, '')))))), 2)) ,
                        b.MKM302HashKey ,
                        [CLAIM_NO   ] ,
                        [EVAL ] ,
                        [PAID_DATE] ,
                        [ADMIT_DATE] ,
                        [DISCHG_DTE] ,
                        [ALLOW_AMT] ,
                        [SUBMI_AMT] ,
                        [COINS_AMT] ,
                        [COPAY_AMT] ,
                        [DEDUCT_AMT] ,
                        [PAID_AMT] ,
                        [NONCOV_AMT] ,
                        [APC_COPAY_AMT] ,
                        [GROUP ] ,
                        [CAT_3 ] ,
                        [PAR IND] ,
                        [PROV_NUMBER] ,
                        [PROVFIX] ,
                        [COVDAYS] ,
                        [NONCOVDAYS] ,
                        [ADMITTYPE] ,
                        [DRG] ,
                        [MEMNO] ,
                        [IN_OUT] ,
                        [CPAYDEDCT] ,
                        [DIAGNOS] ,
                        [DIAG1] ,
                        [DIAG2] ,
                        [DIAG3] ,
                        [DIAG4] ,
                        [DIAG5] ,
                        [DIAG6] ,
                        [DIAG7] ,
                        [DIAG8] ,
                        [DIAG9] ,
                        [P PROC] ,
                        [P PRDTE] ,
                        [PROCED1] ,
                        [PRODTE1] ,
                        [PROCED2] ,
                        [PRODTE2] ,
                        [PROCED3] ,
                        [PRODTE3] ,
                        [PROCED4] ,
                        [PRODTE4] ,
                        [PROCED5] ,
                        [PRODTE5] ,
                        [PROCED6] ,
                        [PRODTE6] ,
                        [PROCED7] ,
                        [PRODTE7] ,
                        [ADMITDIAG] ,
                        [TREAT_PLAN] ,
                        [CERTIFICATE] ,
                        [CLMTYPE] ,
                        [PRICRSON_1] ,
                        [PRICRSON_2] ,
                        [PRICELEV] ,
                        [FSCALCIN ] ,
                        [TARGET_SRV] ,
                        [N_OCCURS] ,
                        [FACILITY] ,
                        [TOTPAYAMT] ,
                        [CLAIM-NPI] ,
                        [ICD-TYPE-IND] ,
                        a.GHASH;


	--RECORD END DATE CLEANUP
        UPDATE  dbo.S_MKM302Details
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate))
                                  FROM      dbo.S_MKM302Details z
                                  WHERE     z.H_MKM302_RK = a.H_MKM302_RK
                                            AND z.LoadDate > a.LoadDate
                                )
        FROM    dbo.S_MKM302Details a
        WHERE   a.RecordEndDate IS NULL; 

			--History Table
        IF ( SELECT COUNT(*)
             FROM   dbo.TableNames
             WHERE  TableName = 'S_MKM302Details'
           ) = 0
            INSERT  INTO dbo.TableNames
                    ( TableName, CreateDate )
            VALUES  ( 'S_MKM302Details', GETDATE() );


			
--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.[dbo].[GuildNet_ghi_mkm302_hospclaims_delm]
--Load History Table for S_esi1900Details

        INSERT  INTO LoadHistory2
                ( TableName_PK ,
                  HashKey ,
                  RecordSource_PK
                )
                SELECT	DISTINCT
                        ( SELECT    TableName_PK
                          FROM      TableNames
                          WHERE     TableName = 'S_MKM302Details'
                        ) ,
                        b.MKM302HashKey ,
                        ( SELECT    RecordSource_PK
                          FROM      RecordSources
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003
                        )
                FROM    CHSStaging.[dbo].[GuildNet_ghi_mkm302_hospclaims_delm] a
                        INNER JOIN CHSDV.dbo.R_MKM302 b ON a.GHASH  COLLATE Compatibility_52_409_30003 = b.ClientMKM302ID;




    END;





GO
