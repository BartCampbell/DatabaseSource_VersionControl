SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
 
 
-- ============================================= 
-- Author:		Paul Johnson 
-- Create date: 01/03/2017 
 -- Description:	Data Vault GuildNet Claims Load Satelites 
-- ============================================= 
CREATE PROCEDURE [dbo].[spDV_GuildNetClaims_LoadSats] 
AS 
    BEGIN 
	-- SET NOCOUNT ON added to prevent extra result sets from 
	-- interfering with SELECT statements. 
        SET NOCOUNT ON; 
 
--**S_esi1900Details LOAD 
 
        DECLARE @LoadDate DATETIME; 
        SET @LoadDate = GETDATE(); 
 
 
		INSERT INTO dbo.S_PharmacyClaimesi1900 
		        ( S_PharmacyClaimesi1900_RK ,LoadDate ,H_PharmacyClaim_RK ,ProductIdentifier ,RecordIdentifier ,ProcessorNumber ,BatchNumber ,DateBilled ,PrescriptionNumber ,DateFilled ,UandCFlag ,NationalDrugCode ,DrugName , 
NeworRefillCode ,MetricQuantity ,DaysSupply ,CalculatedIngredientCost ,DispensingFee ,TaxAmount ,CopayAmount ,DeductibleAmount ,AmountBilled ,AmountClaimed ,AmountDisallowed ,PlanType ,GroupNumber ,PrescriberDEANumber , 
RelationshipCode ,ClaimSubmissionType ,ProviderContract ,TierNumber ,TherapeuticClass ,GenericCode ,BPLNumber ,UandCAmount ,ESIDAWCode ,PriorAuthorizationNumber ,FormularyStatus ,DateReceived ,CheckNumber , 
PlanType2 ,PassedCopayAmount ,AncillaryAmount ,ClaimAdminFee ,AverageWholesalePrice ,BrandGenericCode ,ClientPrescribingPhysician ,ClientIdentifier ,MemberPCPAssignment ,ClaimType ,DOBDefault ,ESIAdjudicationAuditNumber , 
ESIExpandedGroupNumber ,MACAmount ,ChainCode ,MasterGroupNumber ,ExpandedGroupNumber ,PayeeCheckName ,PayeeCheckAddress ,PayeeCity ,PayeeState ,PayeeZipCode ,PayeeZipCodeExpanded ,PhysicianName ,MemberProgram ,DrugConflictCode1 , 
DrugConflictCode2 ,DrugConflictCode3 ,DUROverflow ,DURIntervention ,DUROutcomeCode ,DosageCode ,RefillNumber ,Age ,AdjustmentReasonCode ,GeneralPurposeField ,PharmacyDAWCode ,MaintenanceDrugIndicator ,DrugLegalStatus ,ESIGroupNumber , 
SubmittedDOB ,SubmittedGender ,ReimbursementFlag ,EmployeeLastName ,EmployeeFirstName ,EmployeeMiddleInitial ,EmployeeDOB ,EmployeeGender ,EmployeeZipCode ,GroupName ,EmplZipCodeExpanded ,EmployeeAddress ,EmployeeCity ,EmployeeState , 
CalcBillCopayAmount ,ProductType ,FDBMaintIndicator ,PartialFillStatusCode ,AdjudicationDate ,CompoundCode ,MaxoutofpocketAmount ,ProgramStopLossAmt ,FSAVendorCode ,OtherPayorAmount ,OtherCoverageCode ,PICADrugCode ,FederalDrugClassCode , 
CoinsuranceAmount ,DependentCode ,PlanDesignator ,PharmacyServiceType ,PatientLocation ,PrescriberQualifier ,PrescriberIdentifier ,HRAAppliedAmount ,HRAESIFund ,MedicareDCoveredDrug ,RetroLICSCode ,RetroLICSAmount ,LICSSubsidyAmount , 
MedBDrug ,MedBClaim ,CopayTierLevelNumber ,OfficeofInspectorGeneralFlag ,ANDAFlag ,CDHResponseID ,CDHESIResponseCode ,HRAFlag ,HRASingleBookFlag ,HRARequestAmount ,VendorID ,DeductibleSingleBookFlag ,MaxOutofPocketSingleBookFlag , 
PlanStopLossSingleBookFlag ,TDSSingleBookFlag ,VaccinePharmacyType ,VaccineAdminAmount ,VaccineAdminType ,CDHVendorValue ,ACRAdminFlag ,MemberACRAmount ,SuppPayerPaidAmount ,SuppPayerCopayAmount ,SuppPayerCoverageCode ,SuppPayerCovDeductAmt , 
SuppPayerCoveredCopayAmt ,SuppPayerCoveredAncillary ,SuppPayerCoveredCopayAddonAmt ,FullRxNumber ,PatientResidence ,NXExistsIndicator ,PrescriptionOriginCode ,GenericProductIndicator ,COBRecoveryAmount ,PreCOBBilledClaimAmount , 
DrugCalcDiscAmount ,DrugDiscExclusionReasonCode ,DrugDiscountApplicableCode ,DrugDiscEligibleCostAmount ,PDEDeleteCode ,MICompoundIndicator ,MICompoundCoverageOption ,MILevelOfEffort ,MIProfServiceFeeAmount ,MICompoundIngredientCount , 
MICompoundMEDDElig ,MICompoundMEDDInElig ,MICompMedDFlatCopayAmount ,MICompMedDPercentCopayAmount ,MICompMedDEligMbrPaidAmount ,MICompMedDEligPlanPaidAmount ,MICompMedDEligCostAmount ,SrcSysID ,ETLBatchID ,ETLDateCreated , 
ETLDateUpdated ,DrugStrength ,TransactionID ,XrefTransactionID ,TransactionTypeCode ,AdjustReasonTypeCode ,BatchID ,PaymentRefrenceNumber , 
HashDiff ,RecordSource ,RecordEndDate 
		        ) 
		SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyClaimID, ''))), ':', 
														  RTRIM(LTRIM(COALESCE(a.[ProductIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[RecordIdentifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProcessorNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[BatchNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[DateBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DateFilled],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[NationalDrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[NeworRefillCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MetricQuantity],''))),':',RTRIM(LTRIM(COALESCE(a.[DaysSupply],''))),':',RTRIM(LTRIM(COALESCE(a.[CalculatedIngredientCost],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DispensingFee],''))),':',RTRIM(LTRIM(COALESCE(a.[TaxAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[AmountBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountClaimed],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountDisallowed],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberDEANumber],''))),':',RTRIM(LTRIM(COALESCE(a.[RelationshipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimSubmissionType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProviderContract],''))),':',RTRIM(LTRIM(COALESCE(a.[TierNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[TherapeuticClass],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BPLNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIDAWCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PriorAuthorizationNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[FormularyStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[DateReceived],''))),':',RTRIM(LTRIM(COALESCE(a.[CheckNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType2],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PassedCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[AncillaryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimAdminFee],''))),':',RTRIM(LTRIM(COALESCE(a.[AverageWholesalePrice],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BrandGenericCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientPrescribingPhysician],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberPCPAssignment],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ClaimType],''))),':',RTRIM(LTRIM(COALESCE(a.[DOBDefault],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIAdjudicationAuditNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MACAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ChainCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MasterGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeCheckName],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCheckAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCity],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeState],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeZipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[PhysicianName],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberProgram],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugConflictCode1],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode2],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode3],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROverflow],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DURIntervention],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROutcomeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DosageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RefillNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[Age],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustmentReasonCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GeneralPurposeField],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyDAWCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MaintenanceDrugIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugLegalStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[SubmittedDOB],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SubmittedGender],''))),':',RTRIM(LTRIM(COALESCE(a.[ReimbursementFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeLastName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeFirstName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeMiddleInitial],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeDOB],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeGender],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeZipCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmplZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeCity],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeState],''))),':',RTRIM(LTRIM(COALESCE(a.[CalcBillCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ProductType],''))),':',RTRIM(LTRIM(COALESCE(a.[FDBMaintIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PartialFillStatusCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjudicationDate],''))),':') + CONCAT(RTRIM(LTRIM(COALESCE(a.[CompoundCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxoutofpocketAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProgramStopLossAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FSAVendorCode],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherPayorAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherCoverageCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PICADrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[FederalDrugClassCode],''))),':',RTRIM(LTRIM(COALESCE(a.[CoinsuranceAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DependentCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanDesignator],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyServiceType],''))),':',RTRIM(LTRIM(COALESCE(a.[PatientLocation],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberQualifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PrescriberIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAAppliedAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAESIFund],''))),':',RTRIM(LTRIM(COALESCE(a.[MedicareDCoveredDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[RetroLICSCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RetroLICSAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[LICSSubsidyAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MedBDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MedBClaim],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayTierLevelNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[OfficeofInspectorGeneralFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[ANDAFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[CDHResponseID],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHESIResponseCode],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[HRASingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[HRARequestAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[VendorID],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxOutofPocketSingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanStopLossSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[TDSSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccinePharmacyType],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccineAdminAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[VaccineAdminType],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHVendorValue],''))),':',RTRIM(LTRIM(COALESCE(a.[ACRAdminFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberACRAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoverageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCovDeductAmt],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredAncillary],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAddonAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FullRxNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PatientResidence],''))),':',RTRIM(LTRIM(COALESCE(a.[NXExistsIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionOriginCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[COBRecoveryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PreCOBBilledClaimAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugCalcDiscAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscExclusionReasonCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugDiscountApplicableCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscEligibleCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PDEDeleteCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundCoverageOption],''))),':',RTRIM(LTRIM(COALESCE(a.[MILevelOfEffort],''))),':',RTRIM(LTRIM(COALESCE(a.[MIProfServiceFeeAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIngredientCount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDInElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDFlatCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDPercentCopayAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompMedDEligMbrPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligPlanPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SrcSysID],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ETLBatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateCreated],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateUpdated],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugStrength],''))),':', 
RTRIM(LTRIM(COALESCE(a.[TransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[XrefTransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[TransactionTypeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustReasonTypeCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[PaymentRefrenceNumber],'')))))),2)), 
@LOADDATE, 
b.H_PharmacyClaim_RK, 
a.[ProductIdentifier],	a.[RecordIdentifier],	a.[ProcessorNumber],	a.[BatchNumber],	a.[DateBilled],	a.[PrescriptionNumber],	a.[DateFilled],	a.[UandCFlag],	a.[NationalDrugCode],	a.[DrugName],	 
a.[NeworRefillCode],	a.[MetricQuantity],	a.[DaysSupply],	a.[CalculatedIngredientCost],	a.[DispensingFee],	a.[TaxAmount],	a.[CopayAmount],	a.[DeductibleAmount],	a.[AmountBilled],	a.[AmountClaimed],	a.[AmountDisallowed],	 
a.[PlanType],	a.[GroupNumber],	a.[PrescriberDEANumber],	a.[RelationshipCode],	a.[ClaimSubmissionType],	a.[ProviderContract],	a.[TierNumber],	a.[TherapeuticClass],	a.[GenericCode],	a.[BPLNumber],	a.[UandCAmount],	 
a.[ESIDAWCode],	a.[PriorAuthorizationNumber],	a.[FormularyStatus],	a.[DateReceived],	a.[CheckNumber],	a.[PlanType2],	a.[PassedCopayAmount],	a.[AncillaryAmount],	a.[ClaimAdminFee],	a.[AverageWholesalePrice],	 
a.[BrandGenericCode],	a.[ClientPrescribingPhysician],	a.[ClientIdentifier],	a.[MemberPCPAssignment],	a.[ClaimType],	a.[DOBDefault],	a.[ESIAdjudicationAuditNumber],	a.[ESIExpandedGroupNumber],	a.[MACAmount],	a.[ChainCode],	 
a.[MasterGroupNumber],	a.[ExpandedGroupNumber],	a.[PayeeCheckName],	a.[PayeeCheckAddress],	a.[PayeeCity],	a.[PayeeState],	a.[PayeeZipCode],	a.[PayeeZipCodeExpanded],	a.[PhysicianName],	a.[MemberProgram],	a.[DrugConflictCode1],	 
a.[DrugConflictCode2],	a.[DrugConflictCode3],	a.[DUROverflow],	a.[DURIntervention],	a.[DUROutcomeCode],	a.[DosageCode],	a.[RefillNumber],	a.[Age],	a.[AdjustmentReasonCode],	a.[GeneralPurposeField],	a.[PharmacyDAWCode],	 
a.[MaintenanceDrugIndicator],	a.[DrugLegalStatus],	a.[ESIGroupNumber],	a.[SubmittedDOB],	a.[SubmittedGender],	a.[ReimbursementFlag],	a.[EmployeeLastName],	a.[EmployeeFirstName],	a.[EmployeeMiddleInitial],	a.[EmployeeDOB],	 
a.[EmployeeGender],	a.[EmployeeZipCode],	a.[GroupName],	a.[EmplZipCodeExpanded],	a.[EmployeeAddress],	a.[EmployeeCity],	a.[EmployeeState],	a.[CalcBillCopayAmount],	a.[ProductType],	a.[FDBMaintIndicator], 
a.[PartialFillStatusCode],	a.[AdjudicationDate],	a.[CompoundCode],	a.[MaxoutofpocketAmount],	a.[ProgramStopLossAmt],	a.[FSAVendorCode],	a.[OtherPayorAmount],	a.[OtherCoverageCode],	a.[PICADrugCode],	a.[FederalDrugClassCode], 
a.[CoinsuranceAmount],	a.[DependentCode],	a.[PlanDesignator],	a.[PharmacyServiceType],	a.[PatientLocation],	a.[PrescriberQualifier],	a.[PrescriberIdentifier],	a.[HRAAppliedAmount],	a.[HRAESIFund],	 
a.[MedicareDCoveredDrug],	a.[RetroLICSCode],	a.[RetroLICSAmount],	a.[LICSSubsidyAmount],	a.[MedBDrug],	a.[MedBClaim],	a.[CopayTierLevelNumber],	a.[OfficeofInspectorGeneralFlag],	a.[ANDAFlag],	a.[CDHResponseID],	 
a.[CDHESIResponseCode],	a.[HRAFlag],	a.[HRASingleBookFlag],	a.[HRARequestAmount],	a.[VendorID],	a.[DeductibleSingleBookFlag],	a.[MaxOutofPocketSingleBookFlag],	a.[PlanStopLossSingleBookFlag],	a.[TDSSingleBookFlag],	 
a.[VaccinePharmacyType],	a.[VaccineAdminAmount],	a.[VaccineAdminType],	a.[CDHVendorValue],	a.[ACRAdminFlag],	a.[MemberACRAmount],	a.[SuppPayerPaidAmount],	a.[SuppPayerCopayAmount],	a.[SuppPayerCoverageCode], 
a.[SuppPayerCovDeductAmt],	a.[SuppPayerCoveredCopayAmt],	a.[SuppPayerCoveredAncillary],	a.[SuppPayerCoveredCopayAddonAmt],	a.[FullRxNumber],	a.[PatientResidence],	a.[NXExistsIndicator],	a.[PrescriptionOriginCode], 
a.[GenericProductIndicator],	a.[COBRecoveryAmount],	a.[PreCOBBilledClaimAmount],	a.[DrugCalcDiscAmount],	a.[DrugDiscExclusionReasonCode],	a.[DrugDiscountApplicableCode],	a.[DrugDiscEligibleCostAmount],	 
a.[PDEDeleteCode],	a.[MICompoundIndicator],	a.[MICompoundCoverageOption],	a.[MILevelOfEffort],	a.[MIProfServiceFeeAmount],	a.[MICompoundIngredientCount],	a.[MICompoundMEDDElig],	a.[MICompoundMEDDInElig], 
a.[MICompMedDFlatCopayAmount],	a.[MICompMedDPercentCopayAmount],	a.[MICompMedDEligMbrPaidAmount],	a.[MICompMedDEligPlanPaidAmount],	a.[MICompMedDEligCostAmount],	a.[SrcSysID],	a.[ETLBatchID], 
a.[ETLDateCreated],	a.[ETLDateUpdated],	a.[DrugStrength],	a.[TransactionID],	a.[XrefTransactionID],	a.[TransactionTypeCode],	a.[AdjustReasonTypeCode],	a.[BatchID],	a.[PaymentRefrenceNumber], 
 
 UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(  RTRIM(LTRIM(COALESCE(a.[ProductIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[RecordIdentifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProcessorNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[BatchNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[DateBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DateFilled],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[NationalDrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[NeworRefillCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MetricQuantity],''))),':',RTRIM(LTRIM(COALESCE(a.[DaysSupply],''))),':',RTRIM(LTRIM(COALESCE(a.[CalculatedIngredientCost],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DispensingFee],''))),':',RTRIM(LTRIM(COALESCE(a.[TaxAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[AmountBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountClaimed],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountDisallowed],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberDEANumber],''))),':',RTRIM(LTRIM(COALESCE(a.[RelationshipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimSubmissionType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProviderContract],''))),':',RTRIM(LTRIM(COALESCE(a.[TierNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[TherapeuticClass],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BPLNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIDAWCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PriorAuthorizationNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[FormularyStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[DateReceived],''))),':',RTRIM(LTRIM(COALESCE(a.[CheckNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType2],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PassedCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[AncillaryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimAdminFee],''))),':',RTRIM(LTRIM(COALESCE(a.[AverageWholesalePrice],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BrandGenericCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientPrescribingPhysician],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberPCPAssignment],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ClaimType],''))),':',RTRIM(LTRIM(COALESCE(a.[DOBDefault],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIAdjudicationAuditNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MACAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ChainCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MasterGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeCheckName],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCheckAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCity],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeState],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeZipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[PhysicianName],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberProgram],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugConflictCode1],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode2],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode3],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROverflow],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DURIntervention],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROutcomeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DosageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RefillNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[Age],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustmentReasonCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GeneralPurposeField],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyDAWCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MaintenanceDrugIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugLegalStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[SubmittedDOB],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SubmittedGender],''))),':',RTRIM(LTRIM(COALESCE(a.[ReimbursementFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeLastName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeFirstName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeMiddleInitial],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeDOB],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeGender],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeZipCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmplZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeCity],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeState],''))),':',RTRIM(LTRIM(COALESCE(a.[CalcBillCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ProductType],''))),':',RTRIM(LTRIM(COALESCE(a.[FDBMaintIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PartialFillStatusCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjudicationDate],''))),':') + CONCAT(RTRIM(LTRIM(COALESCE(a.[CompoundCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxoutofpocketAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProgramStopLossAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FSAVendorCode],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherPayorAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherCoverageCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PICADrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[FederalDrugClassCode],''))),':',RTRIM(LTRIM(COALESCE(a.[CoinsuranceAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DependentCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanDesignator],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyServiceType],''))),':',RTRIM(LTRIM(COALESCE(a.[PatientLocation],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberQualifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PrescriberIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAAppliedAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAESIFund],''))),':',RTRIM(LTRIM(COALESCE(a.[MedicareDCoveredDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[RetroLICSCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RetroLICSAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[LICSSubsidyAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MedBDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MedBClaim],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayTierLevelNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[OfficeofInspectorGeneralFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[ANDAFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[CDHResponseID],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHESIResponseCode],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[HRASingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[HRARequestAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[VendorID],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxOutofPocketSingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanStopLossSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[TDSSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccinePharmacyType],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccineAdminAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[VaccineAdminType],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHVendorValue],''))),':',RTRIM(LTRIM(COALESCE(a.[ACRAdminFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberACRAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoverageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCovDeductAmt],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredAncillary],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAddonAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FullRxNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PatientResidence],''))),':',RTRIM(LTRIM(COALESCE(a.[NXExistsIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionOriginCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[COBRecoveryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PreCOBBilledClaimAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugCalcDiscAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscExclusionReasonCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugDiscountApplicableCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscEligibleCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PDEDeleteCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundCoverageOption],''))),':',RTRIM(LTRIM(COALESCE(a.[MILevelOfEffort],''))),':',RTRIM(LTRIM(COALESCE(a.[MIProfServiceFeeAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIngredientCount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDInElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDFlatCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDPercentCopayAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompMedDEligMbrPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligPlanPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SrcSysID],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ETLBatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateCreated],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateUpdated],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugStrength],''))),':', 
RTRIM(LTRIM(COALESCE(a.[TransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[XrefTransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[TransactionTypeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustReasonTypeCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[PaymentRefrenceNumber],'')))))),2)), 
'GuildNet_esi_guildnet_1900_extract',NULL 
	FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a 
		INNER JOIN dbo.H_PharmacyClaim b ON a.CentauriPharmacyClaimID = b.PharmacyClaim_BK 
		WHERE  
 UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(  RTRIM(LTRIM(COALESCE(a.[ProductIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[RecordIdentifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProcessorNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[BatchNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[DateBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DateFilled],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[NationalDrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[NeworRefillCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MetricQuantity],''))),':',RTRIM(LTRIM(COALESCE(a.[DaysSupply],''))),':',RTRIM(LTRIM(COALESCE(a.[CalculatedIngredientCost],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DispensingFee],''))),':',RTRIM(LTRIM(COALESCE(a.[TaxAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[AmountBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountClaimed],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountDisallowed],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberDEANumber],''))),':',RTRIM(LTRIM(COALESCE(a.[RelationshipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimSubmissionType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProviderContract],''))),':',RTRIM(LTRIM(COALESCE(a.[TierNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[TherapeuticClass],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BPLNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIDAWCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PriorAuthorizationNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[FormularyStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[DateReceived],''))),':',RTRIM(LTRIM(COALESCE(a.[CheckNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType2],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PassedCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[AncillaryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimAdminFee],''))),':',RTRIM(LTRIM(COALESCE(a.[AverageWholesalePrice],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BrandGenericCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientPrescribingPhysician],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberPCPAssignment],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ClaimType],''))),':',RTRIM(LTRIM(COALESCE(a.[DOBDefault],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIAdjudicationAuditNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MACAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ChainCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MasterGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeCheckName],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCheckAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCity],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeState],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeZipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[PhysicianName],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberProgram],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugConflictCode1],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode2],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode3],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROverflow],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DURIntervention],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROutcomeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DosageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RefillNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[Age],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustmentReasonCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GeneralPurposeField],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyDAWCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MaintenanceDrugIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugLegalStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[SubmittedDOB],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SubmittedGender],''))),':',RTRIM(LTRIM(COALESCE(a.[ReimbursementFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeLastName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeFirstName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeMiddleInitial],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeDOB],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeGender],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeZipCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmplZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeCity],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeState],''))),':',RTRIM(LTRIM(COALESCE(a.[CalcBillCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ProductType],''))),':',RTRIM(LTRIM(COALESCE(a.[FDBMaintIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PartialFillStatusCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjudicationDate],''))),':') + CONCAT(RTRIM(LTRIM(COALESCE(a.[CompoundCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxoutofpocketAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProgramStopLossAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FSAVendorCode],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherPayorAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherCoverageCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PICADrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[FederalDrugClassCode],''))),':',RTRIM(LTRIM(COALESCE(a.[CoinsuranceAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DependentCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanDesignator],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyServiceType],''))),':',RTRIM(LTRIM(COALESCE(a.[PatientLocation],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberQualifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PrescriberIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAAppliedAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAESIFund],''))),':',RTRIM(LTRIM(COALESCE(a.[MedicareDCoveredDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[RetroLICSCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RetroLICSAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[LICSSubsidyAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MedBDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MedBClaim],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayTierLevelNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[OfficeofInspectorGeneralFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[ANDAFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[CDHResponseID],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHESIResponseCode],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[HRASingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[HRARequestAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[VendorID],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxOutofPocketSingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanStopLossSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[TDSSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccinePharmacyType],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccineAdminAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[VaccineAdminType],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHVendorValue],''))),':',RTRIM(LTRIM(COALESCE(a.[ACRAdminFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberACRAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoverageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCovDeductAmt],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredAncillary],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAddonAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FullRxNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PatientResidence],''))),':',RTRIM(LTRIM(COALESCE(a.[NXExistsIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionOriginCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[COBRecoveryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PreCOBBilledClaimAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugCalcDiscAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscExclusionReasonCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugDiscountApplicableCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscEligibleCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PDEDeleteCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundCoverageOption],''))),':',RTRIM(LTRIM(COALESCE(a.[MILevelOfEffort],''))),':',RTRIM(LTRIM(COALESCE(a.[MIProfServiceFeeAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIngredientCount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDInElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDFlatCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDPercentCopayAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompMedDEligMbrPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligPlanPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SrcSysID],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ETLBatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateCreated],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateUpdated],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugStrength],''))),':', 
RTRIM(LTRIM(COALESCE(a.[TransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[XrefTransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[TransactionTypeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustReasonTypeCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[PaymentRefrenceNumber],'')))))),2)) NOT IN (SELECT s.HASHDIFF FROM dbo.S_PharmacyClaimesi1900 s WHERE s.H_PharmacyClaim_RK=b.H_PharmacyClaim_RK) 
GROUP BY  
 UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyClaimID, ''))), ':', 
														  RTRIM(LTRIM(COALESCE(a.[ProductIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[RecordIdentifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProcessorNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[BatchNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[DateBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DateFilled],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[NationalDrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[NeworRefillCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MetricQuantity],''))),':',RTRIM(LTRIM(COALESCE(a.[DaysSupply],''))),':',RTRIM(LTRIM(COALESCE(a.[CalculatedIngredientCost],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DispensingFee],''))),':',RTRIM(LTRIM(COALESCE(a.[TaxAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[AmountBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountClaimed],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountDisallowed],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberDEANumber],''))),':',RTRIM(LTRIM(COALESCE(a.[RelationshipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimSubmissionType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProviderContract],''))),':',RTRIM(LTRIM(COALESCE(a.[TierNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[TherapeuticClass],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BPLNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIDAWCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PriorAuthorizationNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[FormularyStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[DateReceived],''))),':',RTRIM(LTRIM(COALESCE(a.[CheckNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType2],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PassedCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[AncillaryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimAdminFee],''))),':',RTRIM(LTRIM(COALESCE(a.[AverageWholesalePrice],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BrandGenericCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientPrescribingPhysician],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberPCPAssignment],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ClaimType],''))),':',RTRIM(LTRIM(COALESCE(a.[DOBDefault],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIAdjudicationAuditNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MACAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ChainCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MasterGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeCheckName],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCheckAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCity],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeState],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeZipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[PhysicianName],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberProgram],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugConflictCode1],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode2],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode3],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROverflow],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DURIntervention],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROutcomeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DosageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RefillNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[Age],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustmentReasonCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GeneralPurposeField],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyDAWCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MaintenanceDrugIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugLegalStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[SubmittedDOB],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SubmittedGender],''))),':',RTRIM(LTRIM(COALESCE(a.[ReimbursementFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeLastName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeFirstName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeMiddleInitial],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeDOB],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeGender],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeZipCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmplZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeCity],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeState],''))),':',RTRIM(LTRIM(COALESCE(a.[CalcBillCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ProductType],''))),':',RTRIM(LTRIM(COALESCE(a.[FDBMaintIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PartialFillStatusCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjudicationDate],''))),':') + CONCAT(RTRIM(LTRIM(COALESCE(a.[CompoundCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxoutofpocketAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProgramStopLossAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FSAVendorCode],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherPayorAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherCoverageCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PICADrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[FederalDrugClassCode],''))),':',RTRIM(LTRIM(COALESCE(a.[CoinsuranceAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DependentCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanDesignator],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyServiceType],''))),':',RTRIM(LTRIM(COALESCE(a.[PatientLocation],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberQualifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PrescriberIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAAppliedAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAESIFund],''))),':',RTRIM(LTRIM(COALESCE(a.[MedicareDCoveredDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[RetroLICSCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RetroLICSAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[LICSSubsidyAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MedBDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MedBClaim],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayTierLevelNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[OfficeofInspectorGeneralFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[ANDAFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[CDHResponseID],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHESIResponseCode],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[HRASingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[HRARequestAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[VendorID],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxOutofPocketSingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanStopLossSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[TDSSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccinePharmacyType],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccineAdminAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[VaccineAdminType],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHVendorValue],''))),':',RTRIM(LTRIM(COALESCE(a.[ACRAdminFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberACRAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoverageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCovDeductAmt],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredAncillary],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAddonAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FullRxNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PatientResidence],''))),':',RTRIM(LTRIM(COALESCE(a.[NXExistsIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionOriginCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[COBRecoveryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PreCOBBilledClaimAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugCalcDiscAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscExclusionReasonCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugDiscountApplicableCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscEligibleCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PDEDeleteCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundCoverageOption],''))),':',RTRIM(LTRIM(COALESCE(a.[MILevelOfEffort],''))),':',RTRIM(LTRIM(COALESCE(a.[MIProfServiceFeeAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIngredientCount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDInElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDFlatCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDPercentCopayAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompMedDEligMbrPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligPlanPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SrcSysID],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ETLBatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateCreated],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateUpdated],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugStrength],''))),':', 
RTRIM(LTRIM(COALESCE(a.[TransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[XrefTransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[TransactionTypeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustReasonTypeCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[PaymentRefrenceNumber],'')))))),2)), 
b.H_PharmacyClaim_RK, 
a.[ProductIdentifier],	a.[RecordIdentifier],	a.[ProcessorNumber],	a.[BatchNumber],	a.[DateBilled],	a.[PrescriptionNumber],	a.[DateFilled],	a.[UandCFlag],	a.[NationalDrugCode],	a.[DrugName],	 
a.[NeworRefillCode],	a.[MetricQuantity],	a.[DaysSupply],	a.[CalculatedIngredientCost],	a.[DispensingFee],	a.[TaxAmount],	a.[CopayAmount],	a.[DeductibleAmount],	a.[AmountBilled],	a.[AmountClaimed],	a.[AmountDisallowed],	 
a.[PlanType],	a.[GroupNumber],	a.[PrescriberDEANumber],	a.[RelationshipCode],	a.[ClaimSubmissionType],	a.[ProviderContract],	a.[TierNumber],	a.[TherapeuticClass],	a.[GenericCode],	a.[BPLNumber],	a.[UandCAmount],	 
a.[ESIDAWCode],	a.[PriorAuthorizationNumber],	a.[FormularyStatus],	a.[DateReceived],	a.[CheckNumber],	a.[PlanType2],	a.[PassedCopayAmount],	a.[AncillaryAmount],	a.[ClaimAdminFee],	a.[AverageWholesalePrice],	 
a.[BrandGenericCode],	a.[ClientPrescribingPhysician],	a.[ClientIdentifier],	a.[MemberPCPAssignment],	a.[ClaimType],	a.[DOBDefault],	a.[ESIAdjudicationAuditNumber],	a.[ESIExpandedGroupNumber],	a.[MACAmount],	a.[ChainCode],	 
a.[MasterGroupNumber],	a.[ExpandedGroupNumber],	a.[PayeeCheckName],	a.[PayeeCheckAddress],	a.[PayeeCity],	a.[PayeeState],	a.[PayeeZipCode],	a.[PayeeZipCodeExpanded],	a.[PhysicianName],	a.[MemberProgram],	a.[DrugConflictCode1],	 
a.[DrugConflictCode2],	a.[DrugConflictCode3],	a.[DUROverflow],	a.[DURIntervention],	a.[DUROutcomeCode],	a.[DosageCode],	a.[RefillNumber],	a.[Age],	a.[AdjustmentReasonCode],	a.[GeneralPurposeField],	a.[PharmacyDAWCode],	 
a.[MaintenanceDrugIndicator],	a.[DrugLegalStatus],	a.[ESIGroupNumber],	a.[SubmittedDOB],	a.[SubmittedGender],	a.[ReimbursementFlag],	a.[EmployeeLastName],	a.[EmployeeFirstName],	a.[EmployeeMiddleInitial],	a.[EmployeeDOB],	 
a.[EmployeeGender],	a.[EmployeeZipCode],	a.[GroupName],	a.[EmplZipCodeExpanded],	a.[EmployeeAddress],	a.[EmployeeCity],	a.[EmployeeState],	a.[CalcBillCopayAmount],	a.[ProductType],	a.[FDBMaintIndicator], 
a.[PartialFillStatusCode],	a.[AdjudicationDate],	a.[CompoundCode],	a.[MaxoutofpocketAmount],	a.[ProgramStopLossAmt],	a.[FSAVendorCode],	a.[OtherPayorAmount],	a.[OtherCoverageCode],	a.[PICADrugCode],	a.[FederalDrugClassCode], 
a.[CoinsuranceAmount],	a.[DependentCode],	a.[PlanDesignator],	a.[PharmacyServiceType],	a.[PatientLocation],	a.[PrescriberQualifier],	a.[PrescriberIdentifier],	a.[HRAAppliedAmount],	a.[HRAESIFund],	 
a.[MedicareDCoveredDrug],	a.[RetroLICSCode],	a.[RetroLICSAmount],	a.[LICSSubsidyAmount],	a.[MedBDrug],	a.[MedBClaim],	a.[CopayTierLevelNumber],	a.[OfficeofInspectorGeneralFlag],	a.[ANDAFlag],	a.[CDHResponseID],	 
a.[CDHESIResponseCode],	a.[HRAFlag],	a.[HRASingleBookFlag],	a.[HRARequestAmount],	a.[VendorID],	a.[DeductibleSingleBookFlag],	a.[MaxOutofPocketSingleBookFlag],	a.[PlanStopLossSingleBookFlag],	a.[TDSSingleBookFlag],	 
a.[VaccinePharmacyType],	a.[VaccineAdminAmount],	a.[VaccineAdminType],	a.[CDHVendorValue],	a.[ACRAdminFlag],	a.[MemberACRAmount],	a.[SuppPayerPaidAmount],	a.[SuppPayerCopayAmount],	a.[SuppPayerCoverageCode], 
a.[SuppPayerCovDeductAmt],	a.[SuppPayerCoveredCopayAmt],	a.[SuppPayerCoveredAncillary],	a.[SuppPayerCoveredCopayAddonAmt],	a.[FullRxNumber],	a.[PatientResidence],	a.[NXExistsIndicator],	a.[PrescriptionOriginCode], 
a.[GenericProductIndicator],	a.[COBRecoveryAmount],	a.[PreCOBBilledClaimAmount],	a.[DrugCalcDiscAmount],	a.[DrugDiscExclusionReasonCode],	a.[DrugDiscountApplicableCode],	a.[DrugDiscEligibleCostAmount],	 
a.[PDEDeleteCode],	a.[MICompoundIndicator],	a.[MICompoundCoverageOption],	a.[MILevelOfEffort],	a.[MIProfServiceFeeAmount],	a.[MICompoundIngredientCount],	a.[MICompoundMEDDElig],	a.[MICompoundMEDDInElig], 
a.[MICompMedDFlatCopayAmount],	a.[MICompMedDPercentCopayAmount],	a.[MICompMedDEligMbrPaidAmount],	a.[MICompMedDEligPlanPaidAmount],	a.[MICompMedDEligCostAmount],	a.[SrcSysID],	a.[ETLBatchID], 
a.[ETLDateCreated],	a.[ETLDateUpdated],	a.[DrugStrength],	a.[TransactionID],	a.[XrefTransactionID],	a.[TransactionTypeCode],	a.[AdjustReasonTypeCode],	a.[BatchID],	a.[PaymentRefrenceNumber], 
 UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(  RTRIM(LTRIM(COALESCE(a.[ProductIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[RecordIdentifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProcessorNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[BatchNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[DateBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DateFilled],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[NationalDrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[NeworRefillCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MetricQuantity],''))),':',RTRIM(LTRIM(COALESCE(a.[DaysSupply],''))),':',RTRIM(LTRIM(COALESCE(a.[CalculatedIngredientCost],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DispensingFee],''))),':',RTRIM(LTRIM(COALESCE(a.[TaxAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[AmountBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountClaimed],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountDisallowed],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberDEANumber],''))),':',RTRIM(LTRIM(COALESCE(a.[RelationshipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimSubmissionType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProviderContract],''))),':',RTRIM(LTRIM(COALESCE(a.[TierNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[TherapeuticClass],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BPLNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIDAWCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PriorAuthorizationNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[FormularyStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[DateReceived],''))),':',RTRIM(LTRIM(COALESCE(a.[CheckNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType2],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PassedCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[AncillaryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimAdminFee],''))),':',RTRIM(LTRIM(COALESCE(a.[AverageWholesalePrice],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BrandGenericCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientPrescribingPhysician],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberPCPAssignment],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ClaimType],''))),':',RTRIM(LTRIM(COALESCE(a.[DOBDefault],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIAdjudicationAuditNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MACAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ChainCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MasterGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeCheckName],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCheckAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCity],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeState],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeZipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[PhysicianName],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberProgram],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugConflictCode1],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode2],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode3],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROverflow],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DURIntervention],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROutcomeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DosageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RefillNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[Age],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustmentReasonCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GeneralPurposeField],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyDAWCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MaintenanceDrugIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugLegalStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[SubmittedDOB],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SubmittedGender],''))),':',RTRIM(LTRIM(COALESCE(a.[ReimbursementFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeLastName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeFirstName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeMiddleInitial],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeDOB],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeGender],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeZipCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmplZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeCity],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeState],''))),':',RTRIM(LTRIM(COALESCE(a.[CalcBillCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ProductType],''))),':',RTRIM(LTRIM(COALESCE(a.[FDBMaintIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PartialFillStatusCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjudicationDate],''))),':') + CONCAT(RTRIM(LTRIM(COALESCE(a.[CompoundCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxoutofpocketAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProgramStopLossAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FSAVendorCode],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherPayorAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherCoverageCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PICADrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[FederalDrugClassCode],''))),':',RTRIM(LTRIM(COALESCE(a.[CoinsuranceAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DependentCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanDesignator],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyServiceType],''))),':',RTRIM(LTRIM(COALESCE(a.[PatientLocation],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberQualifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PrescriberIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAAppliedAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAESIFund],''))),':',RTRIM(LTRIM(COALESCE(a.[MedicareDCoveredDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[RetroLICSCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RetroLICSAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[LICSSubsidyAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MedBDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MedBClaim],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayTierLevelNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[OfficeofInspectorGeneralFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[ANDAFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[CDHResponseID],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHESIResponseCode],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[HRASingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[HRARequestAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[VendorID],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxOutofPocketSingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanStopLossSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[TDSSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccinePharmacyType],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccineAdminAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[VaccineAdminType],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHVendorValue],''))),':',RTRIM(LTRIM(COALESCE(a.[ACRAdminFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberACRAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoverageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCovDeductAmt],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredAncillary],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAddonAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FullRxNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PatientResidence],''))),':',RTRIM(LTRIM(COALESCE(a.[NXExistsIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionOriginCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[COBRecoveryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PreCOBBilledClaimAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugCalcDiscAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscExclusionReasonCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugDiscountApplicableCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscEligibleCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PDEDeleteCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundCoverageOption],''))),':',RTRIM(LTRIM(COALESCE(a.[MILevelOfEffort],''))),':',RTRIM(LTRIM(COALESCE(a.[MIProfServiceFeeAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIngredientCount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDInElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDFlatCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDPercentCopayAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompMedDEligMbrPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligPlanPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SrcSysID],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ETLBatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateCreated],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateUpdated],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugStrength],''))),':', 
RTRIM(LTRIM(COALESCE(a.[TransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[XrefTransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[TransactionTypeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustReasonTypeCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[PaymentRefrenceNumber],'')))))),2)) 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_PharmacyClaimesi1900 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_PharmacyClaimesi1900 z 
                                  WHERE     z.H_PharmacyClaim_RK = a.H_PharmacyClaim_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_PharmacyClaimesi1900 a 
        WHERE   a.RecordEndDate IS NULL;  
 
 
			 
			--INSERT INTO RecordSources(recordsource) SELECT 'GuildNet_esi_guildnet_1900_extract' 
			 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_PharmacyClaimesi1900' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_PharmacyClaimesi1900', GETDATE() ); 
 
 
--Load History Table for S_esi1900Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_PharmacyClaimesi1900' 
                        ) , 
                         UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyClaimID, ''))), ':', 
														  RTRIM(LTRIM(COALESCE(a.[ProductIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[RecordIdentifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProcessorNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[BatchNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[DateBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DateFilled],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[NationalDrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[NeworRefillCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MetricQuantity],''))),':',RTRIM(LTRIM(COALESCE(a.[DaysSupply],''))),':',RTRIM(LTRIM(COALESCE(a.[CalculatedIngredientCost],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DispensingFee],''))),':',RTRIM(LTRIM(COALESCE(a.[TaxAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[AmountBilled],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountClaimed],''))),':',RTRIM(LTRIM(COALESCE(a.[AmountDisallowed],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberDEANumber],''))),':',RTRIM(LTRIM(COALESCE(a.[RelationshipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimSubmissionType],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProviderContract],''))),':',RTRIM(LTRIM(COALESCE(a.[TierNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[TherapeuticClass],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BPLNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[UandCAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIDAWCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PriorAuthorizationNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[FormularyStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[DateReceived],''))),':',RTRIM(LTRIM(COALESCE(a.[CheckNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PlanType2],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PassedCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[AncillaryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ClaimAdminFee],''))),':',RTRIM(LTRIM(COALESCE(a.[AverageWholesalePrice],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BrandGenericCode],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientPrescribingPhysician],''))),':',RTRIM(LTRIM(COALESCE(a.[ClientIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberPCPAssignment],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ClaimType],''))),':',RTRIM(LTRIM(COALESCE(a.[DOBDefault],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIAdjudicationAuditNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MACAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ChainCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MasterGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[ExpandedGroupNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeCheckName],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCheckAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeCity],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeState],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PayeeZipCode],''))),':',RTRIM(LTRIM(COALESCE(a.[PayeeZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[PhysicianName],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberProgram],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugConflictCode1],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode2],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugConflictCode3],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROverflow],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DURIntervention],''))),':',RTRIM(LTRIM(COALESCE(a.[DUROutcomeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DosageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RefillNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[Age],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustmentReasonCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GeneralPurposeField],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyDAWCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MaintenanceDrugIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugLegalStatus],''))),':',RTRIM(LTRIM(COALESCE(a.[ESIGroupNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[SubmittedDOB],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SubmittedGender],''))),':',RTRIM(LTRIM(COALESCE(a.[ReimbursementFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeLastName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeFirstName],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeMiddleInitial],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeDOB],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeGender],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeZipCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[GroupName],''))),':',RTRIM(LTRIM(COALESCE(a.[EmplZipCodeExpanded],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeAddress],''))),':',RTRIM(LTRIM(COALESCE(a.[EmployeeCity],''))),':', 
RTRIM(LTRIM(COALESCE(a.[EmployeeState],''))),':',RTRIM(LTRIM(COALESCE(a.[CalcBillCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[ProductType],''))),':',RTRIM(LTRIM(COALESCE(a.[FDBMaintIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PartialFillStatusCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjudicationDate],''))),':') + CONCAT(RTRIM(LTRIM(COALESCE(a.[CompoundCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxoutofpocketAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ProgramStopLossAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FSAVendorCode],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherPayorAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[OtherCoverageCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PICADrugCode],''))),':',RTRIM(LTRIM(COALESCE(a.[FederalDrugClassCode],''))),':',RTRIM(LTRIM(COALESCE(a.[CoinsuranceAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DependentCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanDesignator],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyServiceType],''))),':',RTRIM(LTRIM(COALESCE(a.[PatientLocation],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriberQualifier],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PrescriberIdentifier],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAAppliedAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAESIFund],''))),':',RTRIM(LTRIM(COALESCE(a.[MedicareDCoveredDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[RetroLICSCode],''))),':',RTRIM(LTRIM(COALESCE(a.[RetroLICSAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[LICSSubsidyAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MedBDrug],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MedBClaim],''))),':',RTRIM(LTRIM(COALESCE(a.[CopayTierLevelNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[OfficeofInspectorGeneralFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[ANDAFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[CDHResponseID],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHESIResponseCode],''))),':',RTRIM(LTRIM(COALESCE(a.[HRAFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[HRASingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[HRARequestAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[VendorID],''))),':',RTRIM(LTRIM(COALESCE(a.[DeductibleSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MaxOutofPocketSingleBookFlag],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PlanStopLossSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[TDSSingleBookFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccinePharmacyType],''))),':',RTRIM(LTRIM(COALESCE(a.[VaccineAdminAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[VaccineAdminType],''))),':',RTRIM(LTRIM(COALESCE(a.[CDHVendorValue],''))),':',RTRIM(LTRIM(COALESCE(a.[ACRAdminFlag],''))),':',RTRIM(LTRIM(COALESCE(a.[MemberACRAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoverageCode],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCovDeductAmt],''))),':', 
RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredAncillary],''))),':',RTRIM(LTRIM(COALESCE(a.[SuppPayerCoveredCopayAddonAmt],''))),':',RTRIM(LTRIM(COALESCE(a.[FullRxNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PatientResidence],''))),':',RTRIM(LTRIM(COALESCE(a.[NXExistsIndicator],''))),':',RTRIM(LTRIM(COALESCE(a.[PrescriptionOriginCode],''))),':',RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[COBRecoveryAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PreCOBBilledClaimAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugCalcDiscAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscExclusionReasonCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[DrugDiscountApplicableCode],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugDiscEligibleCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[PDEDeleteCode],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIndicator],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundCoverageOption],''))),':',RTRIM(LTRIM(COALESCE(a.[MILevelOfEffort],''))),':',RTRIM(LTRIM(COALESCE(a.[MIProfServiceFeeAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundIngredientCount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompoundMEDDInElig],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDFlatCopayAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDPercentCopayAmount],''))),':', 
RTRIM(LTRIM(COALESCE(a.[MICompMedDEligMbrPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligPlanPaidAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[MICompMedDEligCostAmount],''))),':',RTRIM(LTRIM(COALESCE(a.[SrcSysID],''))),':', 
RTRIM(LTRIM(COALESCE(a.[ETLBatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateCreated],''))),':',RTRIM(LTRIM(COALESCE(a.[ETLDateUpdated],''))),':',RTRIM(LTRIM(COALESCE(a.[DrugStrength],''))),':', 
RTRIM(LTRIM(COALESCE(a.[TransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[XrefTransactionID],''))),':',RTRIM(LTRIM(COALESCE(a.[TransactionTypeCode],''))),':',RTRIM(LTRIM(COALESCE(a.[AdjustReasonTypeCode],''))),':', 
RTRIM(LTRIM(COALESCE(a.[BatchID],''))),':',RTRIM(LTRIM(COALESCE(a.[PaymentRefrenceNumber],'')))))),2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
                           FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a 
		INNER JOIN dbo.H_PharmacyClaim b ON a.CentauriPharmacyClaimID = b.PharmacyClaim_BK;  
 
--esi1900 Pharmacy 
 
INSERT INTO dbo.S_Pharmacyesi1900 
        ( S_Pharmacyesi1900_RK , 
          LoadDate , 
          H_Pharmacy_RK , 
          PharmacyNABPNumber , 
          PharmacyQualifier , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
 
 
 
SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':',RTRIM(LTRIM(COALESCE(a.[PharmacyNABPNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PharmacyQualifier],'')))))),2)),  
@LoadDate,  
b.H_Pharmacy_RK, 
PharmacyNABPNumber , 
          PharmacyQualifier , 
		  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PharmacyNABPNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PharmacyQualifier],'')))))),2)),  
'GuildNet_esi_guildnet_1900_extract',NULL 
 
FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a 
INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PharmacyNABPNumber],''))),':',RTRIM(LTRIM(COALESCE(a.[PharmacyQualifier],'')))))),2))  
NOT IN (SELECT HashDiff FROM dbo.S_Pharmacyesi1900 WHERE b.H_Pharmacy_RK= H_Pharmacy_RK) 
GROUP BY  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':',RTRIM(LTRIM(COALESCE(a.[PharmacyNABPNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PharmacyQualifier],'')))))),2)),  
b.H_Pharmacy_RK, 
PharmacyNABPNumber , 
          PharmacyQualifier , 
		  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PharmacyNABPNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PharmacyQualifier],'')))))),2)) 
 
 
 
 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_Pharmacyesi1900 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_Pharmacyesi1900 z 
                                  WHERE     z.H_Pharmacy_RK = a.H_Pharmacy_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_Pharmacyesi1900 a 
        WHERE   a.RecordEndDate IS NULL;  
 
 
			 
			--INSERT INTO RecordSources(recordsource) SELECT 'GuildNet_esi_guildnet_1900_extract' 
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_Pharmacyesi1900' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_Pharmacyesi1900', GETDATE() ); 
 
 
--Load History Table for S_esi1900Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_Pharmacyesi1900' 
                        ) , 
                       UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':',RTRIM(LTRIM(COALESCE(a.[PharmacyNABPNumber],''))),':', 
RTRIM(LTRIM(COALESCE(a.[PharmacyQualifier],'')))))),2)), 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
                FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a 
INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
 
 
 
--Esi1900 Member 
 
 
INSERT INTO dbo.S_Memberesi1900Details 
        ( S_Memberesi1900Details_RK , 
          LoadDate , 
          H_Member_RK , 
          MemberLastName , 
          MemberFirstName , 
          MemberMiddleInitial , 
          MemberDateofBirth , 
          MemberGender , 
          CardHolderID , 
          MemberNumber , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
		SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID,''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberLastName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberFirstName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberMiddleInitial],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberDateofBirth],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberGender],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[CardHolderID],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberNumber],'')))))),2)), 
				@LoadDate, 
				b.H_Member_RK, 
				a.[MemberLastName], 
				a.[MemberFirstName], 
				a.[MemberMiddleInitial], 
				a.[MemberDateofBirth], 
				a.[MemberGender], 
				a.[CardHolderID], 
				a.[MemberNumber], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT( 
					RTRIM(LTRIM(COALESCE(a.[MemberLastName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberFirstName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberMiddleInitial],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberDateofBirth],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberGender],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[CardHolderID],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberNumber],'')))))),2)), 
					'GuildNet_esi_guildnet_1900_extract',NULL 
		   FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a 
				INNER JOIN dbo.H_Member b ON a.CentauriMemberID=b.Member_BK 
			WHERE UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT( 
					RTRIM(LTRIM(COALESCE(a.[MemberLastName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberFirstName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberMiddleInitial],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberDateofBirth],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberGender],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[CardHolderID],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberNumber],'')))))),2)) NOT IN  
					(SELECT HashDiff FROM dbo.S_Pharmacyesi1900 WHERE H_Member_RK=b.H_Member_RK) 
			GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID,''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberLastName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberFirstName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberMiddleInitial],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberDateofBirth],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberGender],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[CardHolderID],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberNumber],'')))))),2)), 
				b.H_Member_RK, 
				a.[MemberLastName], 
				a.[MemberFirstName], 
				a.[MemberMiddleInitial], 
				a.[MemberDateofBirth], 
				a.[MemberGender], 
				a.[CardHolderID], 
				a.[MemberNumber], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT( 
					RTRIM(LTRIM(COALESCE(a.[MemberLastName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberFirstName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberMiddleInitial],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberDateofBirth],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberGender],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[CardHolderID],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberNumber],'')))))),2)) 
 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_Memberesi1900Details 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_Memberesi1900Details z 
                                  WHERE     z.H_Member_RK = a.H_Member_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_Memberesi1900Details a 
        WHERE   a.RecordEndDate IS NULL;  
 
 
			 
			--INSERT INTO RecordSources(recordsource) SELECT 'GuildNet_esi_guildnet_1900_extract' 
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_Memberesi1900Details' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_Memberesi1900Details', GETDATE() ); 
 
 
--Load History Table for S_esi1900Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_Memberesi1900Details' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID,''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberLastName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberFirstName],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberMiddleInitial],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberDateofBirth],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberGender],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[CardHolderID],''))),':', 
					RTRIM(LTRIM(COALESCE(a.[MemberNumber],'')))))),2)), 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
                 FROM CHSStaging.dbo.GuildNet_esi_guildnet_1900_extract a 
				INNER JOIN dbo.H_Member b ON a.CentauriMemberID=b.Member_BK 
 
 
						 
--MKM301 
		 
--		DECLARE @LoadDate  DATETIME 
--SET @LoadDate = GETDATE() 
 
 
        INSERT  INTO [dbo].[S_MKM301Details] 
                ( [S_MKM301Details_RK] , 
                  [LoadDate] , 
                  [H_CLAIMS_RK] , 
                  [CLAIM NO  ] , 
                  [CLM LN NO  ] , 
                  [NO-UNITS  ] , 
                  [PAIDDTE  ] , 
                  [F D S   ] , 
                  [L D S   ] , 
                  [ALLOW AMT    ] , 
                  [SUBMIT AMT   ] , 
                  [COINS AMT    ] , 
                  [COPAY AMT    ] , 
                  [DEDUCT AMT   ] , 
                  [PAID AMT     ] , 
                  [COB AMT      ] , 
                  [GROUP     ] , 
                  [CAT   ] , 
                  [EVAL ] , 
                  [TOP ] , 
                  [PAR ] , 
                  [CERTIFICA ] , 
                  [MEMNO ] , 
                  [DIAGNO ] , 
                  [SERVCD ] , 
                  [PROC-C ] , 
                  [PLCSRV ] , 
                  [NETWID ] , 
                  [HDREVA ] , 
                  [FUNDC ] , 
                  [FUNDTP ] , 
                  [CLMTYP ] , 
                  [DFLTICD ] , 
                  [DFLTCPT4 ] , 
                  [DFLTCPT4M ] , 
                  [ICD ] , 
                  [ICDTYP ] , 
                  [CPT4  ] , 
                  [CPT4-M1] , 
                  [CPT4-M2] , 
                  [NOPYFLD] , 
                  [HashDiff] , 
                  [RecordSource] 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimDataID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLAIM NO  ], ''))), ':', RTRIM(LTRIM(COALESCE([CLM LN NO  ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([NO-UNITS  ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAIDDTE  ], ''))), ':', RTRIM(LTRIM(COALESCE([F D S   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([L D S   ], ''))), ':', RTRIM(LTRIM(COALESCE([ALLOW AMT    ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([SUBMIT AMT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COINS AMT    ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COPAY AMT    ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DEDUCT AMT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAID AMT     ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COB AMT      ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([GROUP     ], ''))), ':', RTRIM(LTRIM(COALESCE([CAT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([TOP ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CERTIFICA ], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAGNO ], ''))), ':', RTRIM(LTRIM(COALESCE([SERVCD ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROC-C ], ''))), ':', RTRIM(LTRIM(COALESCE([PLCSRV ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NETWID ], ''))), ':', RTRIM(LTRIM(COALESCE([HDREVA ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([FUNDC ], ''))), ':', RTRIM(LTRIM(COALESCE([FUNDTP ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLMTYP ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTICD ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DFLTCPT4 ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTCPT4M ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([ICD ], ''))), ':', RTRIM(LTRIM(COALESCE([ICDTYP ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CPT4  ], ''))), ':', RTRIM(LTRIM(COALESCE([CPT4-M1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CPT4-M2], ''))), ':', RTRIM(LTRIM(COALESCE([NOPYFLD], '')))))), 2)) , 
                        @LoadDate , 
                        b.H_Claims_RK , 
                        a.[CLAIM NO  ] , 
                        a.[CLM LN NO  ] , 
                        a.[NO-UNITS  ] , 
                        a.[PAIDDTE  ] , 
                        a.[F D S   ] , 
                        a.[L D S   ] , 
                        a.[ALLOW AMT    ] , 
                        a.[SUBMIT AMT   ] , 
                        a.[COINS AMT    ] , 
                        a.[COPAY AMT    ] , 
                        a.[DEDUCT AMT   ] , 
                        a.[PAID AMT     ] , 
                        a.[COB AMT      ] , 
                        a.[GROUP     ] , 
                        a.[CAT   ] , 
                        a.[EVAL ] , 
                        a.[TOP ] , 
                        a.[PAR ] , 
                        a.[CERTIFICA ] , 
                        a.[MEMNO ] , 
                        a.[DIAGNO ] , 
                        a.[SERVCD ] , 
                        a.[PROC-C ] , 
                        a.[PLCSRV ] , 
                        a.[NETWID ] , 
                        a.[HDREVA ] , 
                        a.[FUNDC ] , 
                        a.[FUNDTP ] , 
                        a.[CLMTYP ] , 
                        a.[DFLTICD ] , 
                        a.[DFLTCPT4 ] , 
                        a.[DFLTCPT4M ] , 
                        a.[ICD ] , 
                        a.[ICDTYP ] , 
                        a.[CPT4  ] , 
                        a.[CPT4-M1] , 
                        a.[CPT4-M2] , 
                        a.[NOPYFLD] , 
                        a.GHASH , 
                        'GuildNet_GHI_MKM301_MEDCLAIMS_DELM' 
                FROM    CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] a 
                        INNER JOIN dbo.H_Claims b ON a.CentauriClaimDataID = b.Claims_BK 
                WHERE   a.GHASH  COLLATE Compatibility_52_409_30003 NOT IN ( SELECT HashDiff 
                                                                             FROM   dbo.S_MKM301Details 
                                                                             WHERE  H_CLAIMS_RK COLLATE Compatibility_52_409_30003 = b.H_Claims_RK 
                                                                                    AND RecordEndDate IS NULL ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimDataID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLAIM NO  ], ''))), ':', RTRIM(LTRIM(COALESCE([CLM LN NO  ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([NO-UNITS  ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAIDDTE  ], ''))), ':', RTRIM(LTRIM(COALESCE([F D S   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([L D S   ], ''))), ':', RTRIM(LTRIM(COALESCE([ALLOW AMT    ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([SUBMIT AMT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COINS AMT    ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COPAY AMT    ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DEDUCT AMT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAID AMT     ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COB AMT      ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([GROUP     ], ''))), ':', RTRIM(LTRIM(COALESCE([CAT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([TOP ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CERTIFICA ], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAGNO ], ''))), ':', RTRIM(LTRIM(COALESCE([SERVCD ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROC-C ], ''))), ':', RTRIM(LTRIM(COALESCE([PLCSRV ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NETWID ], ''))), ':', RTRIM(LTRIM(COALESCE([HDREVA ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([FUNDC ], ''))), ':', RTRIM(LTRIM(COALESCE([FUNDTP ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLMTYP ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTICD ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DFLTCPT4 ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTCPT4M ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([ICD ], ''))), ':', RTRIM(LTRIM(COALESCE([ICDTYP ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CPT4  ], ''))), ':', RTRIM(LTRIM(COALESCE([CPT4-M1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CPT4-M2], ''))), ':', RTRIM(LTRIM(COALESCE([NOPYFLD], '')))))), 2)) , 
                        b.H_Claims_RK , 
                        a.[CLAIM NO  ] , 
                        a.[CLM LN NO  ] , 
                        a.[NO-UNITS  ] , 
                        a.[PAIDDTE  ] , 
                        a.[F D S   ] , 
                        a.[L D S   ] , 
                        a.[ALLOW AMT    ] , 
                        a.[SUBMIT AMT   ] , 
                        a.[COINS AMT    ] , 
                        a.[COPAY AMT    ] , 
                        a.[DEDUCT AMT   ] , 
                        a.[PAID AMT     ] , 
                        a.[COB AMT      ] , 
                        a.[GROUP     ] , 
                        a.[CAT   ] , 
                        a.[EVAL ] , 
                        a.[PROVIDER ] , 
                        a.[TOP ] , 
                        a.[PAR ] , 
                        a.[CERTIFICA ] , 
                        a.[MEMNO ] , 
                        a.[DIAGNO ] , 
                        a.[SERVCD ] , 
                        a.[PROC-C ] , 
                        a.[PLCSRV ] , 
                        a.[NETWID ] , 
                        a.[HDREVA ] , 
                        a.[FUNDC ] , 
                        a.[FUNDTP ] , 
                        a.[CLMTYP ] , 
                        a.[DFLTICD ] , 
                        a.[DFLTCPT4 ] , 
                        a.[DFLTCPT4M ] , 
                        a.[ICD ] , 
                        a.[ICDTYP ] , 
                        a.[CPT4  ] , 
                        a.[CPT4-M1] , 
                        a.[CPT4-M2] , 
                        a.[NOPYFLD] , 
                        a.[PROVIDER-NPI] , 
                        a.GHASH; 
 
 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_MKM301Details 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_MKM301Details z 
                                  WHERE     z.H_Claims_RK = a.H_Claims_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_MKM301Details a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_MKM301Details' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_MKM301Details', GETDATE() ); 
 
		 
		 
--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] 
--Load History Table for S_MKM301Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_MKM301Details' 
                        ) , 
                       UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimDataID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLAIM NO  ], ''))), ':', RTRIM(LTRIM(COALESCE([CLM LN NO  ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([NO-UNITS  ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAIDDTE  ], ''))), ':', RTRIM(LTRIM(COALESCE([F D S   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([L D S   ], ''))), ':', RTRIM(LTRIM(COALESCE([ALLOW AMT    ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([SUBMIT AMT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COINS AMT    ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COPAY AMT    ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DEDUCT AMT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAID AMT     ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COB AMT      ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([GROUP     ], ''))), ':', RTRIM(LTRIM(COALESCE([CAT   ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([TOP ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CERTIFICA ], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAGNO ], ''))), ':', RTRIM(LTRIM(COALESCE([SERVCD ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROC-C ], ''))), ':', RTRIM(LTRIM(COALESCE([PLCSRV ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NETWID ], ''))), ':', RTRIM(LTRIM(COALESCE([HDREVA ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([FUNDC ], ''))), ':', RTRIM(LTRIM(COALESCE([FUNDTP ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLMTYP ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTICD ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DFLTCPT4 ], ''))), ':', RTRIM(LTRIM(COALESCE([DFLTCPT4M ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([ICD ], ''))), ':', RTRIM(LTRIM(COALESCE([ICDTYP ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CPT4  ], ''))), ':', RTRIM(LTRIM(COALESCE([CPT4-M1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CPT4-M2], ''))), ':', RTRIM(LTRIM(COALESCE([NOPYFLD], '')))))), 2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
                  FROM    CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] a 
                        INNER JOIN dbo.H_Claims b ON a.CentauriClaimDataID = b.Claims_BK 
 
 
--MKM301 Providers 
	 
--		DECLARE @LoadDate  DATETIME 
--SET @LoadDate = GETDATE() 
 
INSERT INTO dbo.S_ProviderDemo 
        ( S_ProviderDemo_RK , 
          LoadDate , 
          H_Provider_RK , 
          NPI , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
SELECT UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PROVIDER ], ''))), ':', RTRIM(LTRIM(COALESCE(a.[PROVIDER-NPI], '')))))),2)) 
				,@LoadDate 
				,b.H_Provider_RK 
				,a.[PROVIDER-NPI] 
				,UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PROVIDER ], ''))), ':', RTRIM(LTRIM(COALESCE(a.[PROVIDER-NPI], '')))))),2)) 
				,'GuildNet_GHI_MKM301_MEDCLAIMS_DELM',NULL 
		FROM CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] a 
		INNER JOIN dbo.H_Provider b ON a.CentauriProviderID = b.Provider_BK  
		WHERE UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PROVIDER ], ''))), ':', RTRIM(LTRIM(COALESCE(a.[PROVIDER-NPI], '')))))),2)) NOT IN (SELECT HashDiff FROM dbo.S_ProviderDemo WHERE b.H_Provider_RK=H_Provider_RK AND RecordEndDate IS null) 
		GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PROVIDER ], ''))), ':', RTRIM(LTRIM(COALESCE(a.[PROVIDER-NPI], '')))))),2)) 
				,b.H_Provider_RK 
				,a.[PROVIDER-NPI] 
				,UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PROVIDER ], ''))), ':', RTRIM(LTRIM(COALESCE(a.[PROVIDER-NPI], '')))))),2)) 
		 
		 
		--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_ProviderDemo 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_ProviderDemo z 
                                  WHERE     z.H_Provider_RK = a.H_Provider_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_ProviderDemo a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_ProviderDemo' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_ProviderDemo', GETDATE() ); 
 
		 
		 
--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] 
--Load History Table for S_ProviderDemo for MKM301 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_ProviderDemo' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PROVIDER ], ''))), ':', RTRIM(LTRIM(COALESCE(a.[PROVIDER-NPI], '')))))),2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
                FROM CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] a 
		INNER JOIN dbo.H_Provider b ON a.CentauriProviderID = b.Provider_BK  
	 
 
--MKM302 
	 
--		DECLARE @LoadDate  DATETIME 
--SET @LoadDate = GETDATE() 
 
        INSERT  INTO [dbo].[S_MKM302Details] 
                ( [S_MKM302Details_RK] , 
                  [LoadDate] , 
                  [H_Claims_RK] , 
                  [CLAIM_NO   ] , 
                  [EVAL ] , 
                  [PAID_DATE] , 
                  [ADMIT_DATE] , 
                  [DISCHG_DTE] , 
                  [ALLOW_AMT] , 
                  [SUBMI_AMT] , 
                  [COINS_AMT] , 
                  [COPAY_AMT] , 
                  [DEDUCT_AMT] , 
                  [PAID_AMT] , 
                  [NONCOV_AMT] , 
                  [APC_COPAY_AMT] , 
                  [GROUP ] , 
                  [CAT_3 ] , 
                  [PAR IND] , 
                  [PROVFIX] , 
                  [COVDAYS] , 
                  [NONCOVDAYS] , 
                  [ADMITTYPE] , 
                  [DRG] , 
                  [MEMNO] , 
                  [IN_OUT] , 
                  [CPAYDEDCT] , 
                  [DIAGNOS] , 
                  [DIAG1] , 
                  [DIAG2] , 
                  [DIAG3] , 
                  [DIAG4] , 
                  [DIAG5] , 
                  [DIAG6] , 
                  [DIAG7] , 
                  [DIAG8] , 
                  [DIAG9] , 
                  [P PROC] , 
                  [P PRDTE] , 
                  [PROCED1] , 
                  [PRODTE1] , 
                  [PROCED2] , 
                  [PRODTE2] , 
                  [PROCED3] , 
                  [PRODTE3] , 
                  [PROCED4] , 
                  [PRODTE4] , 
                  [PROCED5] , 
                  [PRODTE5] , 
                  [PROCED6] , 
                  [PRODTE6] , 
                  [PROCED7] , 
                  [PRODTE7] , 
                  [ADMITDIAG] , 
                  [TREAT_PLAN] , 
                  [CERTIFICATE] , 
                  [CLMTYPE] , 
                  [PRICRSON_1] , 
                  [PRICRSON_2] , 
                  [PRICELEV] , 
                  [FSCALCIN ] , 
                  [TARGET_SRV] , 
                  [N_OCCURS] , 
                  [FACILITY] , 
                  [TOTPAYAMT] , 
                  [ICD-TYPE-IND] , 
                  [HashDiff] , 
                  [RecordSource] 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimDataID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLAIM_NO   ], ''))), ':', RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAID_DATE], ''))), ':', RTRIM(LTRIM(COALESCE([ADMIT_DATE], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([DISCHG_DTE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([ALLOW_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([SUBMI_AMT], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([COINS_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([DEDUCT_AMT], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([PAID_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NONCOV_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([APC_COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([GROUP ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([CAT_3 ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR IND], ''))), 
                                                                       ':',  
                                                                       RTRIM(LTRIM(COALESCE([PROVFIX], ''))), ':', RTRIM(LTRIM(COALESCE([COVDAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NONCOVDAYS], ''))), ':', RTRIM(LTRIM(COALESCE([ADMITTYPE], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([DRG], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([IN_OUT], ''))), ':', RTRIM(LTRIM(COALESCE([CPAYDEDCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAGNOS], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG2], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG4], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG6], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG7], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG8], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG9], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([P PROC], ''))), ':', RTRIM(LTRIM(COALESCE([P PRDTE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED1], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED2], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED3], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED4], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED5], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED6], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE6], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED7], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE7], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([ADMITDIAG], ''))), ':', RTRIM(LTRIM(COALESCE([TREAT_PLAN], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([CERTIFICATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLMTYPE], ''))), ':', RTRIM(LTRIM(COALESCE([PRICRSON_1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PRICRSON_2], ''))), ':', RTRIM(LTRIM(COALESCE([PRICELEV], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([FSCALCIN ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([TARGET_SRV], ''))), ':', RTRIM(LTRIM(COALESCE([N_OCCURS], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([FACILITY], ''))), ':', RTRIM(LTRIM(COALESCE([TOTPAYAMT], ''))), 
                                                                       ':',  
                                                                       RTRIM(LTRIM(COALESCE([ICD-TYPE-IND], '')))))), 2)) , 
                        @LoadDate , 
                        b.H_Claims_RK , 
                        [CLAIM_NO   ] , 
                        [EVAL ] , 
                        [PAID_DATE] , 
                        [ADMIT_DATE] , 
                        [DISCHG_DTE] , 
                        [ALLOW_AMT] , 
                        [SUBMI_AMT] , 
                        [COINS_AMT] , 
                        [COPAY_AMT] , 
                        [DEDUCT_AMT] , 
                        [PAID_AMT] , 
                        [NONCOV_AMT] , 
                        [APC_COPAY_AMT] , 
                        [GROUP ] , 
                        [CAT_3 ] , 
                        [PAR IND] , 
                        [PROVFIX] , 
                        [COVDAYS] , 
                        [NONCOVDAYS] , 
                        [ADMITTYPE] , 
                        [DRG] , 
                        [MEMNO] , 
                        [IN_OUT] , 
                        [CPAYDEDCT] , 
                        [DIAGNOS] , 
                        [DIAG1] , 
                        [DIAG2] , 
                        [DIAG3] , 
                        [DIAG4] , 
                        [DIAG5] , 
                        [DIAG6] , 
                        [DIAG7] , 
                        [DIAG8] , 
                        [DIAG9] , 
                        [P PROC] , 
                        [P PRDTE] , 
                        [PROCED1] , 
                        [PRODTE1] , 
                        [PROCED2] , 
                        [PRODTE2] , 
                        [PROCED3] , 
                        [PRODTE3] , 
                        [PROCED4] , 
                        [PRODTE4] , 
                        [PROCED5] , 
                        [PRODTE5] , 
                        [PROCED6] , 
                        [PRODTE6] , 
                        [PROCED7] , 
                        [PRODTE7] , 
                        [ADMITDIAG] , 
                        [TREAT_PLAN] , 
                        [CERTIFICATE] , 
                        [CLMTYPE] , 
                        [PRICRSON_1] , 
                        [PRICRSON_2] , 
                        [PRICELEV] , 
                        [FSCALCIN ] , 
                        [TARGET_SRV] , 
                        [N_OCCURS] , 
                        [FACILITY] , 
                        [TOTPAYAMT] , 
                        [ICD-TYPE-IND] , 
                        a.GHASH , 
                        'GuildNet_ghi_mkm302_hospclaims_delm' 
                FROM    CHSStaging.[dbo].GuildNet_ghi_mkm302_hospclaims_delm a 
                        INNER JOIN dbo.H_Claims b ON a.CentauriClaimDataID = b.Claims_BK 
                WHERE   a.GHASH  COLLATE Compatibility_52_409_30003 NOT IN ( SELECT HashDiff 
                                                                             FROM   dbo.S_MKM302Details 
                                                                             WHERE  H_Claims_RK = b.H_Claims_RK  COLLATE Compatibility_52_409_30003 
                                                                                    AND RecordEndDate IS NULL ) 
                GROUP BY  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimDataID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLAIM_NO   ], ''))), ':', RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAID_DATE], ''))), ':', RTRIM(LTRIM(COALESCE([ADMIT_DATE], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([DISCHG_DTE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([ALLOW_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([SUBMI_AMT], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([COINS_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([DEDUCT_AMT], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([PAID_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NONCOV_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([APC_COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([GROUP ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([CAT_3 ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR IND], ''))), 
                                                                       ':',  
                                                                       RTRIM(LTRIM(COALESCE([PROVFIX], ''))), ':', RTRIM(LTRIM(COALESCE([COVDAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NONCOVDAYS], ''))), ':', RTRIM(LTRIM(COALESCE([ADMITTYPE], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([DRG], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([IN_OUT], ''))), ':', RTRIM(LTRIM(COALESCE([CPAYDEDCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAGNOS], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG2], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG4], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG6], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG7], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG8], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG9], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([P PROC], ''))), ':', RTRIM(LTRIM(COALESCE([P PRDTE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED1], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED2], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED3], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED4], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED5], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED6], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE6], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED7], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE7], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([ADMITDIAG], ''))), ':', RTRIM(LTRIM(COALESCE([TREAT_PLAN], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([CERTIFICATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLMTYPE], ''))), ':', RTRIM(LTRIM(COALESCE([PRICRSON_1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PRICRSON_2], ''))), ':', RTRIM(LTRIM(COALESCE([PRICELEV], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([FSCALCIN ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([TARGET_SRV], ''))), ':', RTRIM(LTRIM(COALESCE([N_OCCURS], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([FACILITY], ''))), ':', RTRIM(LTRIM(COALESCE([TOTPAYAMT], ''))), 
                                                                       ':',  
                                                                       RTRIM(LTRIM(COALESCE([ICD-TYPE-IND], '')))))), 2)) , 
                        b.H_Claims_RK , 
                        [CLAIM_NO   ] , 
                        [EVAL ] , 
                        [PAID_DATE] , 
                        [ADMIT_DATE] , 
                        [DISCHG_DTE] , 
                        [ALLOW_AMT] , 
                        [SUBMI_AMT] , 
                        [COINS_AMT] , 
                        [COPAY_AMT] , 
                        [DEDUCT_AMT] , 
                        [PAID_AMT] , 
                        [NONCOV_AMT] , 
                        [APC_COPAY_AMT] , 
                        [GROUP ] , 
                        [CAT_3 ] , 
                        [PAR IND] , 
                        [PROVFIX] , 
                        [COVDAYS] , 
                        [NONCOVDAYS] , 
                        [ADMITTYPE] , 
                        [DRG] , 
                        [MEMNO] , 
                        [IN_OUT] , 
                        [CPAYDEDCT] , 
                        [DIAGNOS] , 
                        [DIAG1] , 
                        [DIAG2] , 
                        [DIAG3] , 
                        [DIAG4] , 
                        [DIAG5] , 
                        [DIAG6] , 
                        [DIAG7] , 
                        [DIAG8] , 
                        [DIAG9] , 
                        [P PROC] , 
                        [P PRDTE] , 
                        [PROCED1] , 
                        [PRODTE1] , 
                        [PROCED2] , 
                        [PRODTE2] , 
                        [PROCED3] , 
                        [PRODTE3] , 
                        [PROCED4] , 
                        [PRODTE4] , 
                        [PROCED5] , 
                        [PRODTE5] , 
                        [PROCED6] , 
                        [PRODTE6] , 
                        [PROCED7] , 
                        [PRODTE7] , 
                        [ADMITDIAG] , 
                        [TREAT_PLAN] , 
                        [CERTIFICATE] , 
                        [CLMTYPE] , 
                        [PRICRSON_1] , 
                        [PRICRSON_2] , 
                        [PRICELEV] , 
                        [FSCALCIN ] , 
                        [TARGET_SRV] , 
                        [N_OCCURS] , 
                        [FACILITY] , 
                        [TOTPAYAMT] , 
                        [ICD-TYPE-IND] , 
                        a.GHASH ; 
 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_MKM302Details 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_MKM302Details z 
                                  WHERE     z.H_Claims_RK = a.H_Claims_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_MKM302Details a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_MKM302Details' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_MKM302Details', GETDATE() ); 
 
 
			 
			 
--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.[dbo].[GuildNet_ghi_mkm302_hospclaims_delm] 
--Load History Table for S_MKM302Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_MKM302Details' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimDataID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLAIM_NO   ], ''))), ':', RTRIM(LTRIM(COALESCE([EVAL ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PAID_DATE], ''))), ':', RTRIM(LTRIM(COALESCE([ADMIT_DATE], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([DISCHG_DTE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([ALLOW_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([SUBMI_AMT], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([COINS_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([DEDUCT_AMT], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([PAID_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NONCOV_AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([APC_COPAY_AMT], ''))), ':', RTRIM(LTRIM(COALESCE([GROUP ], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([CAT_3 ], ''))), ':', RTRIM(LTRIM(COALESCE([PAR IND], ''))), 
                                                                       ':',  
                                                                       RTRIM(LTRIM(COALESCE([PROVFIX], ''))), ':', RTRIM(LTRIM(COALESCE([COVDAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([NONCOVDAYS], ''))), ':', RTRIM(LTRIM(COALESCE([ADMITTYPE], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([DRG], ''))), ':', RTRIM(LTRIM(COALESCE([MEMNO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([IN_OUT], ''))), ':', RTRIM(LTRIM(COALESCE([CPAYDEDCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAGNOS], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG2], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG4], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG6], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG7], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([DIAG8], ''))), ':', RTRIM(LTRIM(COALESCE([DIAG9], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([P PROC], ''))), ':', RTRIM(LTRIM(COALESCE([P PRDTE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED1], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED2], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED3], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED4], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED5], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED6], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE6], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PROCED7], ''))), ':', RTRIM(LTRIM(COALESCE([PRODTE7], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([ADMITDIAG], ''))), ':', RTRIM(LTRIM(COALESCE([TREAT_PLAN], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([CERTIFICATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([CLMTYPE], ''))), ':', RTRIM(LTRIM(COALESCE([PRICRSON_1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([PRICRSON_2], ''))), ':', RTRIM(LTRIM(COALESCE([PRICELEV], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([FSCALCIN ], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE([TARGET_SRV], ''))), ':', RTRIM(LTRIM(COALESCE([N_OCCURS], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE([FACILITY], ''))), ':', RTRIM(LTRIM(COALESCE([TOTPAYAMT], ''))), 
                                                                       ':',  
                                                                       RTRIM(LTRIM(COALESCE([ICD-TYPE-IND], '')))))), 2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
	                FROM    CHSStaging.[dbo].GuildNet_ghi_mkm302_hospclaims_delm a 
                        INNER JOIN dbo.H_Claims b ON a.CentauriClaimDataID = b.Claims_BK 
 
 
--MKM302 Providers 
 
--		DECLARE @LoadDate  DATETIME 
--SET @LoadDate = GETDATE() 
 
INSERT INTO dbo.S_ProviderDemo 
        ( S_ProviderDemo_RK , 
          LoadDate , 
          H_Provider_RK , 
          NPI , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
SELECT UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.PROV_NUMBER, ''))), ':', RTRIM(LTRIM(COALESCE(a.[CLAIM-NPI], '')))))),2)) 
				,@LoadDate 
				,b.H_Provider_RK 
				,a.[CLAIM-NPI] 
				,UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.PROV_NUMBER, ''))), ':', RTRIM(LTRIM(COALESCE(a.[CLAIM-NPI], '')))))),2)) 
				,'GuildNet_ghi_mkm302_hospclaims_delm',NULL 
		FROM CHSStaging.[dbo].GuildNet_ghi_mkm302_hospclaims_delm a 
		INNER JOIN dbo.H_Provider b ON a.CentauriProviderID = b.Provider_BK  
		WHERE UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.PROV_NUMBER, ''))), ':', RTRIM(LTRIM(COALESCE(a.[CLAIM-NPI], '')))))),2)) NOT IN (SELECT HashDiff FROM dbo.S_ProviderDemo WHERE b.H_Provider_RK=H_Provider_RK AND RecordEndDate IS null) 
		GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.PROV_NUMBER, ''))), ':', RTRIM(LTRIM(COALESCE(a.[CLAIM-NPI], '')))))),2)) 
				,b.H_Provider_RK 
				,a.[CLAIM-NPI] 
				,UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.PROV_NUMBER, ''))), ':', RTRIM(LTRIM(COALESCE(a.[CLAIM-NPI], '')))))),2)) 
		 
		--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_ProviderDemo 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_ProviderDemo z 
                                  WHERE     z.H_Provider_RK = a.H_Provider_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_ProviderDemo a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_ProviderDemo' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_ProviderDemo', GETDATE() ); 
 
		 
		 
--INSERT INTO RecordSources(recordsource) SELECT DISTINCT filename FROM CHSStaging.[dbo].[GuildNet_GHI_MKM301_MEDCLAIMS_DELM] 
--Load History Table for S_ProviderDemo for MKM301 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_ProviderDemo' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.PROV_NUMBER, ''))), ':', RTRIM(LTRIM(COALESCE(a.[CLAIM-NPI], '')))))),2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.FileName  COLLATE Compatibility_52_409_30003 
                        ) 
    FROM CHSStaging.[dbo].GuildNet_ghi_mkm302_hospclaims_delm a 
		INNER JOIN dbo.H_Provider b ON a.CentauriProviderID = b.Provider_BK  
 
 
 
 
-- S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  
-- S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  
-- S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  
-- S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  S_PharmacyClaim ***  
 
 
 
 
        INSERT  INTO dbo.S_PharmacyClaim 
                ( S_PharmacyClaim_RK , 
                  LoadDate , 
                  H_PharmacyClaim_RK , 
                  [CR-CLAIM-NUMBER] , 
                  [CR-CLAIM-TYPE] , 
                  [CR-TRANSACTION-TYPE] , 
                  [CR-RX-NUMBER] , 
                  [CR-REFILL-FLAG-NO] , 
                  [CR-PROCESSING-DATE-CCYYMMDD] , 
                  [CR-ADJUDICATION-DATE] , 
                  [CR-ORIG-DISPENSING-DATE] , 
                  [CR-COMPOUND-FLAG] , 
                  [CR-EMPLOYER-GROUP-ID] , 
                  [CR-BENEFIT-PLAN-ID] , 
                  [CR-BENEFIT-SET-SEQ-NUMBER] , 
                  [CR-RIDER-CODE] , 
                  [CR-PRIOR-APPROVAL-CODE] , 
                  [CR-NDC-NUMBER] , 
                  [CR-DISPENSING-DATE] , 
                  [CR-QUANTITY-DISPENSED] , 
                  [CR-DAYS-SUPPLY] , 
                  [CR-DRUG-NAME] , 
                  [CR-CLAIM-AMOUNT] , 
                  [FILLERusedforrejectcode1,2] , 
                  [CR-MAC-PRICING-IND] , 
                  [CR-ORIG-CLAIM-AMOUNT] , 
                  [CR-INGREDIENT-COST-CLAIMED] , 
                  [CR-INGREDIENT-COST-PAID] , 
                  [CR-COPAY-AMOUNT] , 
                  [CR-REGION] , 
                  FILLER , 
                  [FILLER(usedforrejectcode3)] , 
                  [CR-END-OF-CYCLE-DATE-CCYYMMDD] , 
                  [CR-DATE-PRESCRIPTION-WRITTEN] , 
                  [CR-CLAIM-CAP-REDUCED] , 
                  [CR-CLAIM-COINSURANCE] , 
                  [CR-CLAIM-DAW] , 
                  [CR-CLAIM-DEDUCTIBLE] , 
                  [CR-CLAIM-NETWORK-CODE] , 
                  [CR-CLAIM-FEE-SUBMITTED] , 
                  [CR-CLAIM-FEE-APPROVED] , 
                  [CR-GC-CATEGORY-CODE] , 
                  [CR-CLAIM-LOB] , 
                  [CR-ADJUDICATION-RIDER] , 
                  [FILLER(ESI,Plan Indicator,Admin Fee)] , 
                  [CR-FORMULARY-STATUS] , 
                  [CR-CLAIM-PAST-MBR-ID] , 
                  [CR-CLAIM-SITE] , 
                  [CR-PIN-NO] , 
                  [CR-AHFS-CODE] , 
                  [CR-GCN-CODE] , 
                  [CR-GPI-CODE] , 
                  [CR-GC3-CODE] , 
                  [CR-CLAIM-STEP-THERAPY] , 
                  [CR-DRUG-NAME-GROUP] , 
                  [CR-GENERIC-NAME] , 
                  [CR-ORIGIN-CODE] , 
                  [CR-WAC-AMT-N] , 
                  [CR-MAC-AMT-N] , 
                  [CR-AWP-AMT-N] , 
                  [CR-REVERSAL-CLAIM-NUM] , 
                  [CR-DRUG-TIER] , 
                  [CR-DR-ID] , 
                  [CR-COB-FLAG] , 
                  [CR-COB-AMT-N] , 
                  [CR-RX-NUMBER-FULL] , 
                  [Tax Amount] , 
                  [GenericProductIndicator(GPI)] , 
                  [Date Billed] , 
                  [Relationship Code] , 
                  [Dependent Code] , 
                  [Patient Location] , 
                  [Submitted DOB] , 
                  [Submitted Gender] , 
                  [Payee Check Name] , 
                  [Payee Check Address] , 
                  [Payee City] , 
                  [Payee State] , 
                  [Payee Zip Code] , 
                  [Payee Zip Code  Expanded] , 
                  [Plan Type] , 
                  [Master Group Number] , 
                  [Expanded Group Number] , 
                  [ESI Group Number] , 
                  [Group Name] , 
                  [Employee Last Name] , 
                  [Employee First Name] , 
                  [Employee Middle Initial] , 
                  [Employee DOB] , 
                  [Employee Address] , 
                  [Employee City] , 
                  [Employee State] , 
                  [Employee Zip Code] , 
                  [Employee Zip Code  Expanded] , 
                  [Employee Gender] , 
                  [Prescriber Qualifier] , 
                  [Physician Name] , 
                  [Provider Contract] , 
                  [Claim Admin Fee] , 
                  [Calculated Billing Copay Amount] , 
                  [Ancillary Amount] , 
                  [Max. out of pocket amount applied] , 
                  [Program Stop Loss amount applied] , 
                  [Brand/Generic Code] , 
                  [Drug Conflict Code 1] , 
                  [Drug Conflict Code 2] , 
                  [Drug Conflict Code 3] , 
                  [DUR Overflow] , 
                  [DUR Intervention] , 
                  [DUR Outcome Code] , 
                  [Dosage Code] , 
                  [Drug Strength] , 
                  [Pharmacy Service Type] , 
                  [Pharmacy Qualifier] , 
                  [U&C Amount] , 
                  [HRA Applied Amount] , 
                  [HRA ESI Fund] , 
                  [Maintenance Drug Indicator] , 
                  [Drug Legal Status] , 
                  [PICA Drug Code] , 
                  [Federal Drug Class Code] , 
                  [Product Type] , 
                  [FSA Vendor Code] , 
                  [Other Coverage Code] , 
                  [Medicare D Covered Drug] , 
                  [Retro LICS Code] , 
                  [Retro LICS Amount] , 
                  [LICS Subsidy Amount] , 
                  [Med B Drug] , 
                  [Med B Claim] , 
                  [Copay Tier Level Number] , 
                  [Office of Inspector General (OIG) flag] , 
                  [ANDA Flag] , 
                  [CDH Response ID] , 
                  [CDH ESI Response Code] , 
                  [HRA Flag] , 
                  [HRA Single Book Flag] , 
                  [HRA Request Amount] , 
                  [Vendor  ID (outbound)] , 
                  [Deductible Single Book Flag] , 
                  [Maximum Out of Pocket Single Book Flag] , 
                  [Plan Stop Loss Single Book Flag] , 
                  [TDS Single Book Flag] , 
                  [Vaccine Pharmacy Type] , 
                  [Vaccine Admin Amount] , 
                  [Vaccine Admin Type] , 
                  [CDH  Vendor Value] , 
                  [ACR Admin Flag] , 
                  [Member ACR amount] , 
                  [Supplemental Payer Paid Amount] , 
                  [Supplemental Payer Copay Amount] , 
                  [Supplemental Payer Coverage Code] , 
                  [Supplemental Payer Covered Deductible Amount] , 
                  [Supplemental Payer Covered Copay Amount] , 
                  [Supplemental Payer Covered Ancillary] , 
                  [Supplemental Payer Covered Copay Add on Amount] , 
                  [Patient Residence] , 
                  [NX exists Indicator] , 
                  [Prescription Origin Code] , 
                  [COB Recovery Amount] , 
                  Filler1 , 
                  [Pre COB Billed Claim Amount] , 
                  [Drug Calculated Discount Amount] , 
                  [Drug Discount Exclusion Reason Code] , 
                  [Drug Discount Applicable Code] , 
                  [Drug Discount Eligible Cost Amount] , 
                  [PDE Delete Code] , 
                  [M-I Compound] , 
                  [M-I Compound Coverage Option] , 
                  [M-I Level Of Effort] , 
                  [M-I Professional Service Fee Amount] , 
                  [M-I Compound Ingredient Count] , 
                  [M-I Compound MED-D Eligible] , 
                  [M-I Compound Med-D Ineligible] , 
                  [M-I Compound Med-D Flat Copay Amount] , 
                  [M-I Compound Med-D Percent Copay Amount] , 
                  [M-I Compound Med-D Eligible Member Paid Amount] , 
                  [M-I Compound Med-D Eligible Plan Paid Amount] , 
                  [M-I Compound Med-D Eligible Cost Amount] , 
                  [Batch Number] , 
                  [PHR-PHARMACY-NABP-NO] , 
                  [MED D Benefit Beginning Phase Cd] , 
                  [MED D Benefit Ending Phase Cd] , 
                  [QCARE Benefit Set Value or GHI Category Code] , 
                  [MED D TrOOP Switch] , 
                  [MED D TrOOP YTD Amount] , 
                  [CMS TrOOP Limit Switch] , 
                  [Date and Time Stamp] , 
                  [Transaction ID] , 
                  [X-Ref Transaction ID] , 
                  [Transaction Type Code] , 
                  [Adjustment Reason Type Code] , 
                  [ESI Batch ID] , 
                  [Payment Reference Number] , 
                  [CR-CLAIM-AMOUNT-EXP] , 
                  [SCB (Sub Client Billing) Ingredient Costs] , 
                  [SCB (Sub Client Billing) Dispensing Fees] , 
                  [SCB (Sub Client Billing) Sales Tax] , 
                  [SCB (Sub Client Billing) Admin Fee] , 
                  [SCB (Sub Client Billing) Claim Amount] , 
                  [SCB (Sub Client Billing) Ancillary Adjustment Amount] , 
                  [SCB Cost Basis] , 
                  FILLER2 , 
                  HashDiff , 
                  RecordSource 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(p.PharmacyClaim_BK, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-TRANSACTION-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REFILL-FLAG-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROCESSING-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COMPOUND-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-EMPLOYER-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-PLAN-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-SET-SEQ-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RIDER-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PRIOR-APPROVAL-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-NDC-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-QUANTITY-DISPENSED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DAYS-SUPPLY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLERusedforrejectcode1,2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-PRICING-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-CLAIMED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-PAID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COPAY-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REGION], ''))), ':', RTRIM(LTRIM(COALESCE(a.[FILLER], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[FILLER(usedforrejectcode3)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-END-OF-CYCLE-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DATE-PRESCRIPTION-WRITTEN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-CAP-REDUCED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-COINSURANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DAW], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DEDUCTIBLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NETWORK-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-SUBMITTED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-APPROVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC-CATEGORY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-RIDER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLER(ESI,Plan Indicator,Admin Fee)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-FORMULARY-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-PAST-MBR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-SITE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PIN-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AHFS-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GCN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GPI-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC3-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-STEP-THERAPY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GENERIC-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIGIN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-WAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AWP-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REVERSAL-CLAIM-NUM], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-TIER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER-FULL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Tax Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator(GPI)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Date Billed], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Relationship Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dependent Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Patient Location], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Plan Type], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Master Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Expanded Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[ESI Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Group Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Prescriber Qualifier], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Physician Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Provider Contract], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Claim Admin Fee], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Calculated Billing Copay Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Ancillary Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Max. out of pocket amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Program Stop Loss amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Brand/Generic Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Overflow], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Intervention], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Outcome Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dosage Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Strength], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Pharmacy Service Type], ''))), ':')) 
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[Pharmacy Qualifier], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[U&C Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Applied Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA ESI Fund], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maintenance Drug Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Legal Status], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PICA Drug Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Federal Drug Class Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Product Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FSA Vendor Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Other Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Medicare D Covered Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[LICS Subsidy Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Claim], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Copay Tier Level Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Office of Inspector General (OIG) flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ANDA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH Response ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH ESI Response Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Request Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vendor  ID (outbound)], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Deductible Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maximum Out of Pocket Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Plan Stop Loss Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[TDS Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Pharmacy Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH  Vendor Value], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ACR Admin Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Member ACR amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Deductible Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Ancillary], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Add on Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Patient Residence], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[NX exists Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Prescription Origin Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[COB Recovery Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Filler1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Pre COB Billed Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Calculated Discount Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Exclusion Reason Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Applicable Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PDE Delete Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Coverage Option], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Level Of Effort], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Professional Service Fee Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Ingredient Count], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound MED-D Eligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Ineligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Flat Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Percent Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Member Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Plan Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Batch Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Beginning Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Ending Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[QCARE Benefit Set Value or GHI Category Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP YTD Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CMS TrOOP Limit Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Date and Time Stamp], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[X-Ref Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Adjustment Reason Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ESI Batch ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Payment Reference Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT-EXP], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ingredient Costs], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Dispensing Fees], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Sales Tax], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Admin Fee], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ancillary Adjustment Amount], ''))), 
                                                                         ':', RTRIM(LTRIM(COALESCE(a.[SCB Cost Basis], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FILLER2 ], '')))))), 2)) , 
                        @LoadDate , 
                        p.H_PharmacyClaim_RK , 
                        [CR-CLAIM-NUMBER] , 
                        [CR-CLAIM-TYPE] , 
                        [CR-TRANSACTION-TYPE] , 
                        [CR-RX-NUMBER] , 
                        [CR-REFILL-FLAG-NO] , 
                        [CR-PROCESSING-DATE-CCYYMMDD] , 
                        [CR-ADJUDICATION-DATE] , 
                        [CR-ORIG-DISPENSING-DATE] , 
                        [CR-COMPOUND-FLAG] , 
                        [CR-EMPLOYER-GROUP-ID] , 
                        [CR-BENEFIT-PLAN-ID] , 
                        [CR-BENEFIT-SET-SEQ-NUMBER] , 
                        [CR-RIDER-CODE] , 
                        [CR-PRIOR-APPROVAL-CODE] , 
                        [CR-NDC-NUMBER] , 
                        [CR-DISPENSING-DATE] , 
                        [CR-QUANTITY-DISPENSED] , 
                        [CR-DAYS-SUPPLY] , 
                        [CR-DRUG-NAME] , 
                        [CR-CLAIM-AMOUNT] , 
                        [FILLERusedforrejectcode1,2] , 
                        [CR-MAC-PRICING-IND] , 
                        [CR-ORIG-CLAIM-AMOUNT] , 
                        [CR-INGREDIENT-COST-CLAIMED] , 
                        [CR-INGREDIENT-COST-PAID] , 
                        [CR-COPAY-AMOUNT] , 
                        [CR-REGION] , 
                        FILLER , 
                        [FILLER(usedforrejectcode3)] , 
                        [CR-END-OF-CYCLE-DATE-CCYYMMDD] , 
                        [CR-DATE-PRESCRIPTION-WRITTEN] , 
                        [CR-CLAIM-CAP-REDUCED] , 
                        [CR-CLAIM-COINSURANCE] , 
                        [CR-CLAIM-DAW] , 
                        [CR-CLAIM-DEDUCTIBLE] , 
                        [CR-CLAIM-NETWORK-CODE] , 
                        [CR-CLAIM-FEE-SUBMITTED] , 
                        [CR-CLAIM-FEE-APPROVED] , 
                        [CR-GC-CATEGORY-CODE] , 
                        [CR-CLAIM-LOB] , 
                        [CR-ADJUDICATION-RIDER] , 
                        [FILLER(ESI,Plan Indicator,Admin Fee)] , 
                        [CR-FORMULARY-STATUS] , 
                        [CR-CLAIM-PAST-MBR-ID] , 
                        [CR-CLAIM-SITE] , 
                        [CR-PIN-NO] , 
                        [CR-AHFS-CODE] , 
                        [CR-GCN-CODE] , 
                        [CR-GPI-CODE] , 
                        [CR-GC3-CODE] , 
                        [CR-CLAIM-STEP-THERAPY] , 
                        [CR-DRUG-NAME-GROUP] , 
                        [CR-GENERIC-NAME] , 
                        [CR-ORIGIN-CODE] , 
                        [CR-WAC-AMT-N] , 
                        [CR-MAC-AMT-N] , 
                        [CR-AWP-AMT-N] , 
                        [CR-REVERSAL-CLAIM-NUM] , 
                        [CR-DRUG-TIER] , 
                        [CR-DR-ID] , 
                        [CR-COB-FLAG] , 
                        [CR-COB-AMT-N] , 
                        [CR-RX-NUMBER-FULL] , 
                        [Tax Amount] , 
                        [GenericProductIndicator(GPI)] , 
                        [Date Billed] , 
                        [Relationship Code] , 
                        [Dependent Code] , 
                        [Patient Location] , 
                        [Submitted DOB] , 
                        [Submitted Gender] , 
                        [Payee Check Name] , 
                        [Payee Check Address] , 
                        [Payee City] , 
                        [Payee State] , 
                        [Payee Zip Code] , 
                        [Payee Zip Code  Expanded] , 
                        [Plan Type] , 
                        [Master Group Number] , 
                        [Expanded Group Number] , 
                        [ESI Group Number] , 
                        [Group Name] , 
                        [Employee Last Name] , 
                        [Employee First Name] , 
                        [Employee Middle Initial] , 
                        [Employee DOB] , 
                        [Employee Address] , 
                        [Employee City] , 
                        [Employee State] , 
                        [Employee Zip Code] , 
                        [Employee Zip Code  Expanded] , 
                        [Employee Gender] , 
                        [Prescriber Qualifier] , 
                        [Physician Name] , 
                        [Provider Contract] , 
                        [Claim Admin Fee] , 
                        [Calculated Billing Copay Amount] , 
                        [Ancillary Amount] , 
                        [Max. out of pocket amount applied] , 
                        [Program Stop Loss amount applied] , 
                        [Brand/Generic Code] , 
                        [Drug Conflict Code 1] , 
                        [Drug Conflict Code 2] , 
                        [Drug Conflict Code 3] , 
                        [DUR Overflow] , 
                        [DUR Intervention] , 
                        [DUR Outcome Code] , 
                        [Dosage Code] , 
                        [Drug Strength] , 
                        [Pharmacy Service Type] , 
                        [Pharmacy Qualifier] , 
                        [U&C Amount] , 
                        [HRA Applied Amount] , 
                        [HRA ESI Fund] , 
                        [Maintenance Drug Indicator] , 
                        [Drug Legal Status] , 
                        [PICA Drug Code] , 
                        [Federal Drug Class Code] , 
                        [Product Type] , 
                        [FSA Vendor Code] , 
                        [Other Coverage Code] , 
                        [Medicare D Covered Drug] , 
                        [Retro LICS Code] , 
                        [Retro LICS Amount] , 
                        [LICS Subsidy Amount] , 
                        [Med B Drug] , 
                        [Med B Claim] , 
                        [Copay Tier Level Number] , 
                        [Office of Inspector General (OIG) flag] , 
                        [ANDA Flag] , 
                        [CDH Response ID] , 
                        [CDH ESI Response Code] , 
                        [HRA Flag] , 
                        [HRA Single Book Flag] , 
                        [HRA Request Amount] , 
                        [Vendor  ID (outbound)] , 
                        [Deductible Single Book Flag] , 
                        [Maximum Out of Pocket Single Book Flag] , 
                        [Plan Stop Loss Single Book Flag] , 
                        [TDS Single Book Flag] , 
                        [Vaccine Pharmacy Type] , 
                        [Vaccine Admin Amount] , 
                        [Vaccine Admin Type] , 
                        [CDH  Vendor Value] , 
                        [ACR Admin Flag] , 
                        [Member ACR amount] , 
                        [Supplemental Payer Paid Amount] , 
                        [Supplemental Payer Copay Amount] , 
                        [Supplemental Payer Coverage Code] , 
                        [Supplemental Payer Covered Deductible Amount] , 
                        [Supplemental Payer Covered Copay Amount] , 
                        [Supplemental Payer Covered Ancillary] , 
                        [Supplemental Payer Covered Copay Add on Amount] , 
                        [Patient Residence] , 
                        [NX exists Indicator] , 
                        [Prescription Origin Code] , 
                        [COB Recovery Amount] , 
                        Filler1 , 
                        [Pre COB Billed Claim Amount] , 
                        [Drug Calculated Discount Amount] , 
                        [Drug Discount Exclusion Reason Code] , 
                        [Drug Discount Applicable Code] , 
                        [Drug Discount Eligible Cost Amount] , 
                        [PDE Delete Code] , 
                        [M-I Compound] , 
                        [M-I Compound Coverage Option] , 
                        [M-I Level Of Effort] , 
                        [M-I Professional Service Fee Amount] , 
                        [M-I Compound Ingredient Count] , 
                        [M-I Compound MED-D Eligible] , 
                        [M-I Compound Med-D Ineligible] , 
                        [M-I Compound Med-D Flat Copay Amount] , 
                        [M-I Compound Med-D Percent Copay Amount] , 
                        [M-I Compound Med-D Eligible Member Paid Amount] , 
                        [M-I Compound Med-D Eligible Plan Paid Amount] , 
                        [M-I Compound Med-D Eligible Cost Amount] , 
                        [Batch Number] , 
                        [PHR-PHARMACY-NABP-NO] , 
                        [MED D Benefit Beginning Phase Cd] , 
                        [MED D Benefit Ending Phase Cd] , 
                        [QCARE Benefit Set Value or GHI Category Code] , 
                        [MED D TrOOP Switch] , 
                        [MED D TrOOP YTD Amount] , 
                        [CMS TrOOP Limit Switch] , 
                        [Date and Time Stamp] , 
                        [Transaction ID] , 
                        [X-Ref Transaction ID] , 
                        [Transaction Type Code] , 
                        [Adjustment Reason Type Code] , 
                        [ESI Batch ID] , 
                        [Payment Reference Number] , 
                        [CR-CLAIM-AMOUNT-EXP] , 
                        [SCB (Sub Client Billing) Ingredient Costs] , 
                        [SCB (Sub Client Billing) Dispensing Fees] , 
                        [SCB (Sub Client Billing) Sales Tax] , 
                        [SCB (Sub Client Billing) Admin Fee] , 
                        [SCB (Sub Client Billing) Claim Amount] , 
                        [SCB (Sub Client Billing) Ancillary Adjustment Amount] , 
                        [SCB Cost Basis] , 
                        FILLER2 , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-TRANSACTION-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REFILL-FLAG-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROCESSING-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COMPOUND-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-EMPLOYER-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-PLAN-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-SET-SEQ-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RIDER-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PRIOR-APPROVAL-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-NDC-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-QUANTITY-DISPENSED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DAYS-SUPPLY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLERusedforrejectcode1,2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-PRICING-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-CLAIMED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-PAID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COPAY-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REGION], ''))), ':', RTRIM(LTRIM(COALESCE(a.[FILLER], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[FILLER(usedforrejectcode3)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-END-OF-CYCLE-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DATE-PRESCRIPTION-WRITTEN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-CAP-REDUCED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-COINSURANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DAW], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DEDUCTIBLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NETWORK-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-SUBMITTED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-APPROVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC-CATEGORY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-RIDER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLER(ESI,Plan Indicator,Admin Fee)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-FORMULARY-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-PAST-MBR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-SITE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PIN-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AHFS-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GCN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GPI-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC3-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-STEP-THERAPY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GENERIC-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIGIN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-WAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AWP-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REVERSAL-CLAIM-NUM], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-TIER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER-FULL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Tax Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator(GPI)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Date Billed], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Relationship Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dependent Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Patient Location], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Plan Type], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Master Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Expanded Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[ESI Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Group Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Prescriber Qualifier], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Physician Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Provider Contract], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Claim Admin Fee], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Calculated Billing Copay Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Ancillary Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Max. out of pocket amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Program Stop Loss amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Brand/Generic Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Overflow], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Intervention], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Outcome Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dosage Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Strength], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Pharmacy Service Type], ''))), ':')) 
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[Pharmacy Qualifier], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[U&C Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Applied Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA ESI Fund], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maintenance Drug Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Legal Status], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PICA Drug Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Federal Drug Class Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Product Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FSA Vendor Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Other Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Medicare D Covered Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[LICS Subsidy Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Claim], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Copay Tier Level Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Office of Inspector General (OIG) flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ANDA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH Response ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH ESI Response Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Request Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vendor  ID (outbound)], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Deductible Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maximum Out of Pocket Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Plan Stop Loss Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[TDS Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Pharmacy Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH  Vendor Value], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ACR Admin Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Member ACR amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Deductible Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Ancillary], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Add on Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Patient Residence], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[NX exists Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Prescription Origin Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[COB Recovery Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Filler1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Pre COB Billed Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Calculated Discount Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Exclusion Reason Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Applicable Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PDE Delete Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Coverage Option], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Level Of Effort], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Professional Service Fee Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Ingredient Count], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound MED-D Eligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Ineligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Flat Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Percent Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Member Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Plan Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Batch Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Beginning Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Ending Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[QCARE Benefit Set Value or GHI Category Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP YTD Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CMS TrOOP Limit Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Date and Time Stamp], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[X-Ref Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Adjustment Reason Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ESI Batch ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Payment Reference Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT-EXP], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ingredient Costs], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Dispensing Fees], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Sales Tax], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Admin Fee], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ancillary Adjustment Amount], ''))), 
                                                                         ':', RTRIM(LTRIM(COALESCE(a.[SCB Cost Basis], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FILLER2 ], '')))))), 2)) , 
                        a.FileName 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyClaim a 
                        INNER JOIN dbo.H_PharmacyClaim p ON a.CentauriID = p.PharmacyClaim_BK 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-TRANSACTION-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REFILL-FLAG-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROCESSING-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COMPOUND-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-EMPLOYER-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-PLAN-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-SET-SEQ-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RIDER-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PRIOR-APPROVAL-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-NDC-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-QUANTITY-DISPENSED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DAYS-SUPPLY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLERusedforrejectcode1,2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-PRICING-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-CLAIMED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-PAID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COPAY-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REGION], ''))), ':', RTRIM(LTRIM(COALESCE(a.[FILLER], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[FILLER(usedforrejectcode3)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-END-OF-CYCLE-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DATE-PRESCRIPTION-WRITTEN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-CAP-REDUCED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-COINSURANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DAW], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DEDUCTIBLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NETWORK-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-SUBMITTED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-APPROVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC-CATEGORY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-RIDER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLER(ESI,Plan Indicator,Admin Fee)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-FORMULARY-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-PAST-MBR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-SITE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PIN-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AHFS-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GCN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GPI-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC3-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-STEP-THERAPY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GENERIC-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIGIN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-WAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AWP-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REVERSAL-CLAIM-NUM], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-TIER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER-FULL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Tax Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator(GPI)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Date Billed], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Relationship Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dependent Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Patient Location], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Plan Type], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Master Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Expanded Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[ESI Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Group Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Prescriber Qualifier], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Physician Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Provider Contract], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Claim Admin Fee], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Calculated Billing Copay Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Ancillary Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Max. out of pocket amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Program Stop Loss amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Brand/Generic Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Overflow], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Intervention], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Outcome Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dosage Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Strength], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Pharmacy Service Type], ''))), ':')) 
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[Pharmacy Qualifier], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[U&C Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Applied Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA ESI Fund], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maintenance Drug Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Legal Status], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PICA Drug Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Federal Drug Class Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Product Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FSA Vendor Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Other Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Medicare D Covered Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[LICS Subsidy Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Claim], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Copay Tier Level Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Office of Inspector General (OIG) flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ANDA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH Response ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH ESI Response Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Request Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vendor  ID (outbound)], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Deductible Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maximum Out of Pocket Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Plan Stop Loss Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[TDS Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Pharmacy Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH  Vendor Value], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ACR Admin Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Member ACR amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Deductible Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Ancillary], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Add on Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Patient Residence], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[NX exists Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Prescription Origin Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[COB Recovery Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Filler1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Pre COB Billed Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Calculated Discount Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Exclusion Reason Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Applicable Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PDE Delete Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Coverage Option], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Level Of Effort], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Professional Service Fee Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Ingredient Count], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound MED-D Eligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Ineligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Flat Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Percent Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Member Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Plan Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Batch Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Beginning Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Ending Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[QCARE Benefit Set Value or GHI Category Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP YTD Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CMS TrOOP Limit Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Date and Time Stamp], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[X-Ref Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Adjustment Reason Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ESI Batch ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Payment Reference Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT-EXP], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ingredient Costs], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Dispensing Fees], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Sales Tax], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Admin Fee], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ancillary Adjustment Amount], ''))), 
                                                                         ':', RTRIM(LTRIM(COALESCE(a.[SCB Cost Basis], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FILLER2 ], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_PharmacyClaim 
                        WHERE   H_PharmacyClaim_RK = p.H_PharmacyClaim_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(p.PharmacyClaim_BK, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-TRANSACTION-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-REFILL-FLAG-NO], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-PROCESSING-DATE-CCYYMMDD], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-ORIG-DISPENSING-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-COMPOUND-FLAG], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-EMPLOYER-GROUP-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-PLAN-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-SET-SEQ-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-RIDER-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-PRIOR-APPROVAL-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-NDC-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DISPENSING-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-QUANTITY-DISPENSED], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DAYS-SUPPLY], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[FILLERusedforrejectcode1,2], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-MAC-PRICING-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-ORIG-CLAIM-AMOUNT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-CLAIMED], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-PAID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-COPAY-AMOUNT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-REGION], ''))), ':', RTRIM(LTRIM(COALESCE(a.[FILLER], ''))), 
                                                                        ':', RTRIM(LTRIM(COALESCE(a.[FILLER(usedforrejectcode3)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-END-OF-CYCLE-DATE-CCYYMMDD], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DATE-PRESCRIPTION-WRITTEN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-CAP-REDUCED], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-COINSURANCE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DAW], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DEDUCTIBLE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NETWORK-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-SUBMITTED], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-APPROVED], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-GC-CATEGORY-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-LOB], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-RIDER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[FILLER(ESI,Plan Indicator,Admin Fee)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-FORMULARY-STATUS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-PAST-MBR-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-SITE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-PIN-NO], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-AHFS-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-GCN-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-GPI-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-GC3-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-STEP-THERAPY], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME-GROUP], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-GENERIC-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-ORIGIN-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-WAC-AMT-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-MAC-AMT-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-AWP-AMT-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-REVERSAL-CLAIM-NUM], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DRUG-TIER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-DR-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-COB-FLAG], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-COB-AMT-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER-FULL], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Tax Amount], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator(GPI)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Date Billed], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Relationship Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Dependent Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Patient Location], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Submitted DOB], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Submitted Gender], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Payee Check Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Payee Check Address], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Payee City], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Payee State], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Payee Zip Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Payee Zip Code  Expanded], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Plan Type], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Master Group Number], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Expanded Group Number], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[ESI Group Number], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Group Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee Last Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee First Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee Middle Initial], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee DOB], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee Address], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee City], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee State], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee Zip Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee Zip Code  Expanded], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Employee Gender], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Prescriber Qualifier], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Physician Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Provider Contract], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Claim Admin Fee], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Calculated Billing Copay Amount], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Ancillary Amount], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Max. out of pocket amount applied], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Program Stop Loss amount applied], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Brand/Generic Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 1], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 2], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 3], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[DUR Overflow], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[DUR Intervention], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[DUR Outcome Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Dosage Code], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Drug Strength], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Pharmacy Service Type], ''))), ':')) 
                                                           + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[Pharmacy Qualifier], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[U&C Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[HRA Applied Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[HRA ESI Fund], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Maintenance Drug Indicator], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Drug Legal Status], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[PICA Drug Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Federal Drug Class Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Product Type], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[FSA Vendor Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Other Coverage Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Medicare D Covered Drug], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Retro LICS Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Retro LICS Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[LICS Subsidy Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Med B Drug], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Med B Claim], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Copay Tier Level Number], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Office of Inspector General (OIG) flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[ANDA Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CDH Response ID], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CDH ESI Response Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[HRA Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[HRA Single Book Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[HRA Request Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Vendor  ID (outbound)], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Deductible Single Book Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Maximum Out of Pocket Single Book Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Plan Stop Loss Single Book Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[TDS Single Book Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Vaccine Pharmacy Type], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Type], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CDH  Vendor Value], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[ACR Admin Flag], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Member ACR amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Paid Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Copay Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Coverage Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Deductible Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Ancillary], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Add on Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Patient Residence], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[NX exists Indicator], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Prescription Origin Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[COB Recovery Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Filler1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Pre COB Billed Claim Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Drug Calculated Discount Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Drug Discount Exclusion Reason Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Drug Discount Applicable Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Drug Discount Eligible Cost Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[PDE Delete Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Coverage Option], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Level Of Effort], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Professional Service Fee Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Ingredient Count], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound MED-D Eligible], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Ineligible], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Flat Copay Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Percent Copay Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Member Paid Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Plan Paid Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Cost Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Batch Number], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[MED D Benefit Beginning Phase Cd], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[MED D Benefit Ending Phase Cd], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[QCARE Benefit Set Value or GHI Category Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[MED D TrOOP Switch], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[MED D TrOOP YTD Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CMS TrOOP Limit Switch], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Date and Time Stamp], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Transaction ID], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[X-Ref Transaction ID], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Transaction Type Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Adjustment Reason Type Code], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[ESI Batch ID], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[Payment Reference Number], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT-EXP], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ingredient Costs], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Dispensing Fees], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Sales Tax], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Admin Fee], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Claim Amount], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ancillary Adjustment Amount], ''))), 
                                                                          ':', RTRIM(LTRIM(COALESCE(a.[SCB Cost Basis], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[FILLER2 ], '')))))), 2)) , 
                        p.H_PharmacyClaim_RK , 
                        [CR-CLAIM-NUMBER] , 
                        [CR-CLAIM-TYPE] , 
                        [CR-TRANSACTION-TYPE] , 
                        [CR-RX-NUMBER] , 
                        [CR-REFILL-FLAG-NO] , 
                        [CR-PROCESSING-DATE-CCYYMMDD] , 
                        [CR-ADJUDICATION-DATE] , 
                        [CR-ORIG-DISPENSING-DATE] , 
                        [CR-COMPOUND-FLAG] , 
                        [CR-EMPLOYER-GROUP-ID] , 
                        [CR-BENEFIT-PLAN-ID] , 
                        [CR-BENEFIT-SET-SEQ-NUMBER] , 
                        [CR-RIDER-CODE] , 
                        [CR-PRIOR-APPROVAL-CODE] , 
                        [CR-NDC-NUMBER] , 
                        [CR-DISPENSING-DATE] , 
                        [CR-QUANTITY-DISPENSED] , 
                        [CR-DAYS-SUPPLY] , 
                        [CR-DRUG-NAME] , 
                        [CR-CLAIM-AMOUNT] , 
                        [FILLERusedforrejectcode1,2] , 
                        [CR-MAC-PRICING-IND] , 
                        [CR-ORIG-CLAIM-AMOUNT] , 
                        [CR-INGREDIENT-COST-CLAIMED] , 
                        [CR-INGREDIENT-COST-PAID] , 
                        [CR-COPAY-AMOUNT] , 
                        [CR-REGION] , 
                        FILLER , 
                        [FILLER(usedforrejectcode3)] , 
                        [CR-END-OF-CYCLE-DATE-CCYYMMDD] , 
                        [CR-DATE-PRESCRIPTION-WRITTEN] , 
                        [CR-CLAIM-CAP-REDUCED] , 
                        [CR-CLAIM-COINSURANCE] , 
                        [CR-CLAIM-DAW] , 
                        [CR-CLAIM-DEDUCTIBLE] , 
                        [CR-CLAIM-NETWORK-CODE] , 
                        [CR-CLAIM-FEE-SUBMITTED] , 
                        [CR-CLAIM-FEE-APPROVED] , 
                        [CR-GC-CATEGORY-CODE] , 
                        [CR-CLAIM-LOB] , 
                        [CR-ADJUDICATION-RIDER] , 
                        [FILLER(ESI,Plan Indicator,Admin Fee)] , 
                        [CR-FORMULARY-STATUS] , 
                        [CR-CLAIM-PAST-MBR-ID] , 
                        [CR-CLAIM-SITE] , 
                        [CR-PIN-NO] , 
                        [CR-AHFS-CODE] , 
                        [CR-GCN-CODE] , 
                        [CR-GPI-CODE] , 
                        [CR-GC3-CODE] , 
                        [CR-CLAIM-STEP-THERAPY] , 
                        [CR-DRUG-NAME-GROUP] , 
                        [CR-GENERIC-NAME] , 
                        [CR-ORIGIN-CODE] , 
                        [CR-WAC-AMT-N] , 
                        [CR-MAC-AMT-N] , 
                        [CR-AWP-AMT-N] , 
                        [CR-REVERSAL-CLAIM-NUM] , 
                        [CR-DRUG-TIER] , 
                        [CR-DR-ID] , 
                        [CR-COB-FLAG] , 
                        [CR-COB-AMT-N] , 
                        [CR-RX-NUMBER-FULL] , 
                        [Tax Amount] , 
                        [GenericProductIndicator(GPI)] , 
                        [Date Billed] , 
                        [Relationship Code] , 
                        [Dependent Code] , 
                        [Patient Location] , 
                        [Submitted DOB] , 
                        [Submitted Gender] , 
                        [Payee Check Name] , 
                        [Payee Check Address] , 
                        [Payee City] , 
                        [Payee State] , 
                        [Payee Zip Code] , 
                        [Payee Zip Code  Expanded] , 
                        [Plan Type] , 
                        [Master Group Number] , 
                        [Expanded Group Number] , 
                        [ESI Group Number] , 
                        [Group Name] , 
                        [Employee Last Name] , 
                        [Employee First Name] , 
                        [Employee Middle Initial] , 
                        [Employee DOB] , 
                        [Employee Address] , 
                        [Employee City] , 
                        [Employee State] , 
                        [Employee Zip Code] , 
                        [Employee Zip Code  Expanded] , 
                        [Employee Gender] , 
                        [Prescriber Qualifier] , 
                        [Physician Name] , 
                        [Provider Contract] , 
                        [Claim Admin Fee] , 
                        [Calculated Billing Copay Amount] , 
                        [Ancillary Amount] , 
                        [Max. out of pocket amount applied] , 
                        [Program Stop Loss amount applied] , 
                        [Brand/Generic Code] , 
                        [Drug Conflict Code 1] , 
                        [Drug Conflict Code 2] , 
                        [Drug Conflict Code 3] , 
                        [DUR Overflow] , 
                        [DUR Intervention] , 
                        [DUR Outcome Code] , 
                        [Dosage Code] , 
                        [Drug Strength] , 
                        [Pharmacy Service Type] , 
                        [Pharmacy Qualifier] , 
                        [U&C Amount] , 
                        [HRA Applied Amount] , 
                        [HRA ESI Fund] , 
                        [Maintenance Drug Indicator] , 
                        [Drug Legal Status] , 
                        [PICA Drug Code] , 
                        [Federal Drug Class Code] , 
                        [Product Type] , 
                        [FSA Vendor Code] , 
                        [Other Coverage Code] , 
                        [Medicare D Covered Drug] , 
                        [Retro LICS Code] , 
                        [Retro LICS Amount] , 
                        [LICS Subsidy Amount] , 
                        [Med B Drug] , 
                        [Med B Claim] , 
                        [Copay Tier Level Number] , 
                        [Office of Inspector General (OIG) flag] , 
                        [ANDA Flag] , 
                        [CDH Response ID] , 
                        [CDH ESI Response Code] , 
                        [HRA Flag] , 
                        [HRA Single Book Flag] , 
                        [HRA Request Amount] , 
                        [Vendor  ID (outbound)] , 
                        [Deductible Single Book Flag] , 
                        [Maximum Out of Pocket Single Book Flag] , 
                        [Plan Stop Loss Single Book Flag] , 
                        [TDS Single Book Flag] , 
                        [Vaccine Pharmacy Type] , 
                        [Vaccine Admin Amount] , 
                        [Vaccine Admin Type] , 
                        [CDH  Vendor Value] , 
                        [ACR Admin Flag] , 
                        [Member ACR amount] , 
                        [Supplemental Payer Paid Amount] , 
                        [Supplemental Payer Copay Amount] , 
                        [Supplemental Payer Coverage Code] , 
                        [Supplemental Payer Covered Deductible Amount] , 
                        [Supplemental Payer Covered Copay Amount] , 
                        [Supplemental Payer Covered Ancillary] , 
                        [Supplemental Payer Covered Copay Add on Amount] , 
                        [Patient Residence] , 
                        [NX exists Indicator] , 
                        [Prescription Origin Code] , 
                        [COB Recovery Amount] , 
                        Filler1 , 
                        [Pre COB Billed Claim Amount] , 
                        [Drug Calculated Discount Amount] , 
                        [Drug Discount Exclusion Reason Code] , 
                        [Drug Discount Applicable Code] , 
                        [Drug Discount Eligible Cost Amount] , 
                        [PDE Delete Code] , 
                        [M-I Compound] , 
                        [M-I Compound Coverage Option] , 
                        [M-I Level Of Effort] , 
                        [M-I Professional Service Fee Amount] , 
                        [M-I Compound Ingredient Count] , 
                        [M-I Compound MED-D Eligible] , 
                        [M-I Compound Med-D Ineligible] , 
                        [M-I Compound Med-D Flat Copay Amount] , 
                        [M-I Compound Med-D Percent Copay Amount] , 
                        [M-I Compound Med-D Eligible Member Paid Amount] , 
                        [M-I Compound Med-D Eligible Plan Paid Amount] , 
                        [M-I Compound Med-D Eligible Cost Amount] , 
                        [Batch Number] , 
                        [PHR-PHARMACY-NABP-NO] , 
                        [MED D Benefit Beginning Phase Cd] , 
                        [MED D Benefit Ending Phase Cd] , 
                        [QCARE Benefit Set Value or GHI Category Code] , 
                        [MED D TrOOP Switch] , 
                        [MED D TrOOP YTD Amount] , 
                        [CMS TrOOP Limit Switch] , 
                        [Date and Time Stamp] , 
                        [Transaction ID] , 
                        [X-Ref Transaction ID] , 
                        [Transaction Type Code] , 
                        [Adjustment Reason Type Code] , 
                        [ESI Batch ID] , 
                        [Payment Reference Number] , 
                        [CR-CLAIM-AMOUNT-EXP] , 
                        [SCB (Sub Client Billing) Ingredient Costs] , 
                        [SCB (Sub Client Billing) Dispensing Fees] , 
                        [SCB (Sub Client Billing) Sales Tax] , 
                        [SCB (Sub Client Billing) Admin Fee] , 
                        [SCB (Sub Client Billing) Claim Amount] , 
                        [SCB (Sub Client Billing) Ancillary Adjustment Amount] , 
                        [SCB Cost Basis] , 
                        FILLER2 , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-TRANSACTION-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REFILL-FLAG-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROCESSING-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COMPOUND-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-EMPLOYER-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-PLAN-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-SET-SEQ-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RIDER-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PRIOR-APPROVAL-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-NDC-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-QUANTITY-DISPENSED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DAYS-SUPPLY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLERusedforrejectcode1,2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-PRICING-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-CLAIMED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-PAID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COPAY-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REGION], ''))), ':', RTRIM(LTRIM(COALESCE(a.[FILLER], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[FILLER(usedforrejectcode3)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-END-OF-CYCLE-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DATE-PRESCRIPTION-WRITTEN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-CAP-REDUCED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-COINSURANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DAW], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DEDUCTIBLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NETWORK-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-SUBMITTED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-APPROVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC-CATEGORY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-RIDER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLER(ESI,Plan Indicator,Admin Fee)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-FORMULARY-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-PAST-MBR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-SITE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PIN-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AHFS-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GCN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GPI-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC3-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-STEP-THERAPY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GENERIC-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIGIN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-WAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AWP-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REVERSAL-CLAIM-NUM], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-TIER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER-FULL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Tax Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator(GPI)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Date Billed], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Relationship Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dependent Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Patient Location], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Plan Type], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Master Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Expanded Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[ESI Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Group Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Prescriber Qualifier], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Physician Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Provider Contract], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Claim Admin Fee], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Calculated Billing Copay Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Ancillary Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Max. out of pocket amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Program Stop Loss amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Brand/Generic Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Overflow], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Intervention], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Outcome Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dosage Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Strength], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Pharmacy Service Type], ''))), ':')) 
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[Pharmacy Qualifier], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[U&C Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Applied Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA ESI Fund], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maintenance Drug Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Legal Status], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PICA Drug Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Federal Drug Class Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Product Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FSA Vendor Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Other Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Medicare D Covered Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[LICS Subsidy Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Claim], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Copay Tier Level Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Office of Inspector General (OIG) flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ANDA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH Response ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH ESI Response Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Request Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vendor  ID (outbound)], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Deductible Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maximum Out of Pocket Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Plan Stop Loss Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[TDS Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Pharmacy Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH  Vendor Value], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ACR Admin Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Member ACR amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Deductible Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Ancillary], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Add on Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Patient Residence], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[NX exists Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Prescription Origin Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[COB Recovery Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Filler1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Pre COB Billed Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Calculated Discount Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Exclusion Reason Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Applicable Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PDE Delete Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Coverage Option], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Level Of Effort], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Professional Service Fee Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Ingredient Count], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound MED-D Eligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Ineligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Flat Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Percent Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Member Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Plan Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Batch Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Beginning Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Ending Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[QCARE Benefit Set Value or GHI Category Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP YTD Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CMS TrOOP Limit Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Date and Time Stamp], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[X-Ref Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Adjustment Reason Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ESI Batch ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Payment Reference Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT-EXP], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ingredient Costs], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Dispensing Fees], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Sales Tax], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Admin Fee], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ancillary Adjustment Amount], ''))), 
                                                                         ':', RTRIM(LTRIM(COALESCE(a.[SCB Cost Basis], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FILLER2 ], '')))))), 2)) , 
                        a.FileName; 
 
--Update RecordEndDate for S_PharmacyClaim 
        UPDATE  dbo.S_PharmacyClaim 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_PharmacyClaim z 
                                  WHERE     z.H_PharmacyClaim_RK = a.H_PharmacyClaim_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_PharmacyClaim a 
        WHERE   a.RecordEndDate IS NULL;  
 
 
 
 
 
--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_PharmacyClaim' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_PharmacyClaim', GETDATE() ); 
 
 
 
--Load History Table for S_PharmacyClaim 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_PharmacyClaim' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(p.PharmacyClaim_BK, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-TRANSACTION-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REFILL-FLAG-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROCESSING-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COMPOUND-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-EMPLOYER-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-PLAN-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-BENEFIT-SET-SEQ-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RIDER-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PRIOR-APPROVAL-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-NDC-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DISPENSING-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-QUANTITY-DISPENSED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DAYS-SUPPLY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLERusedforrejectcode1,2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-PRICING-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIG-CLAIM-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-CLAIMED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-INGREDIENT-COST-PAID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COPAY-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REGION], ''))), ':', RTRIM(LTRIM(COALESCE(a.[FILLER], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[FILLER(usedforrejectcode3)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-END-OF-CYCLE-DATE-CCYYMMDD], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DATE-PRESCRIPTION-WRITTEN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-CAP-REDUCED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-COINSURANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DAW], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-DEDUCTIBLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-NETWORK-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-SUBMITTED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-FEE-APPROVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC-CATEGORY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ADJUDICATION-RIDER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[FILLER(ESI,Plan Indicator,Admin Fee)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-FORMULARY-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-PAST-MBR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-SITE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PIN-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AHFS-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GCN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GPI-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GC3-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-STEP-THERAPY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-NAME-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-GENERIC-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-ORIGIN-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-WAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MAC-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-AWP-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-REVERSAL-CLAIM-NUM], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DRUG-TIER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-DR-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-FLAG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-COB-AMT-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-RX-NUMBER-FULL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Tax Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[GenericProductIndicator(GPI)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Date Billed], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Relationship Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dependent Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Patient Location], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Submitted Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Check Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Payee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Plan Type], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Master Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Expanded Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[ESI Group Number], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Group Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee DOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Address], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee City], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee State], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Zip Code  Expanded], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Employee Gender], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Prescriber Qualifier], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Physician Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Provider Contract], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Claim Admin Fee], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Calculated Billing Copay Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Ancillary Amount], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Max. out of pocket amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Program Stop Loss amount applied], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Brand/Generic Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Conflict Code 3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Overflow], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Intervention], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DUR Outcome Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Dosage Code], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Drug Strength], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Pharmacy Service Type], ''))), ':')) 
                                                          + UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[Pharmacy Qualifier], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[U&C Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Applied Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA ESI Fund], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maintenance Drug Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Legal Status], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PICA Drug Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Federal Drug Class Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Product Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FSA Vendor Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Other Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Medicare D Covered Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Retro LICS Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[LICS Subsidy Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Drug], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Med B Claim], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Copay Tier Level Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Office of Inspector General (OIG) flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ANDA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH Response ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH ESI Response Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[HRA Request Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vendor  ID (outbound)], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Deductible Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Maximum Out of Pocket Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Plan Stop Loss Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[TDS Single Book Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Pharmacy Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Vaccine Admin Type], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CDH  Vendor Value], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ACR Admin Flag], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Member ACR amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Coverage Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Deductible Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Ancillary], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Supplemental Payer Covered Copay Add on Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Patient Residence], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[NX exists Indicator], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Prescription Origin Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[COB Recovery Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Filler1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Pre COB Billed Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Calculated Discount Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Exclusion Reason Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Applicable Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Drug Discount Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PDE Delete Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Coverage Option], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Level Of Effort], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Professional Service Fee Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Ingredient Count], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound MED-D Eligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Ineligible], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Flat Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Percent Copay Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Member Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Plan Paid Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[M-I Compound Med-D Eligible Cost Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Batch Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Beginning Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D Benefit Ending Phase Cd], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[QCARE Benefit Set Value or GHI Category Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[MED D TrOOP YTD Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CMS TrOOP Limit Switch], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Date and Time Stamp], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[X-Ref Transaction ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Transaction Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Adjustment Reason Type Code], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[ESI Batch ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[Payment Reference Number], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CR-CLAIM-AMOUNT-EXP], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ingredient Costs], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Dispensing Fees], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Sales Tax], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Admin Fee], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Claim Amount], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[SCB (Sub Client Billing) Ancillary Adjustment Amount], ''))), 
                                                                         ':', RTRIM(LTRIM(COALESCE(a.[SCB Cost Basis], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[FILLER2 ], '')))))), 2)) , 
                         
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource COLLATE Compatibility_52_409_30003 = a.FileName 
                        ) 
			FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyClaim a 
                        INNER JOIN dbo.H_PharmacyClaim p ON a.CentauriID = p.PharmacyClaim_BK 
 
 
-- S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  
-- S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  
-- S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  
-- S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  ***  S_ProviderPharmacyClaim  *** 		 
 
	--DECLARE @LoadDate  DATETIME 
	--SET @LoadDate = GETDATE() 
 
        INSERT  INTO dbo.S_ProviderPharmacyClaim 
                ( S_ProviderPharmacyClaim_RK , 
                  LoadDate , 
                  H_Provider_RK , 
                  [CR-PROV-ID] , 
                  [CR-PROV-ID-LOC] , 
                  [CR-PROVIDER-NPI-ID] , 
                  HashDiff , 
                  RecordSource 
	            ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID-LOC], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROVIDER-NPI-ID], '')))))), 2)) , 
                        @LoadDate , 
                        h.H_Provider_RK , 
                        a.[CR-PROV-ID] , 
                        a.[CR-PROV-ID-LOC] , 
                        a.[CR-PROVIDER-NPI-ID] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID-LOC], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROVIDER-NPI-ID], '')))))), 2)) , 
                        'GuildNet_GNESIBatchPayDet_PharmacyClaim ' 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyClaim a 
                        INNER JOIN dbo.H_Provider h ON a.CentauriProviderID = h.Provider_BK 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID-LOC], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROVIDER-NPI-ID], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_ProviderPharmacyClaim 
                        WHERE   H_Provider_RK = h.H_Provider_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID-LOC], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-PROVIDER-NPI-ID], '')))))), 2)) , 
                        h.H_Provider_RK , 
                        a.[CR-PROV-ID] , 
                        a.[CR-PROV-ID-LOC] , 
                        a.[CR-PROVIDER-NPI-ID] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID-LOC], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROVIDER-NPI-ID], '')))))), 2)); 
 
 
 
--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_ProviderPharmacyClaim 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_ProviderPharmacyClaim z 
                                  WHERE     z.H_Provider_RK = a.H_Provider_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_ProviderPharmacyClaim a 
        WHERE   a.RecordEndDate IS NULL;  
																	    
 
	--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_ProviderPharmacyClaim' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_ProviderPharmacyClaim' , 
                      GETDATE() 
                    ); 
 
 
 
--Load History Table for S_ProviderPharmacyClaim 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_ProviderPharmacyClaim' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROV-ID-LOC], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-PROVIDER-NPI-ID], '')))))), 2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource COLLATE Compatibility_52_409_30003 = a.FileName 
                        ) 
                 FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyClaim a 
                        INNER JOIN dbo.H_Provider h ON a.CentauriProviderID = h.Provider_BK 
	 
 
-- S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  
-- S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  
-- S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  
-- S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  ***  S_MemberPharmacyClaim  *** 		 
 
	--DECLARE @LoadDate  DATETIME 
	--SET @LoadDate = GETDATE() 
 
        INSERT  INTO dbo.S_MemberPharmacyClaim 
                ( S_MemberPharmacyClaim_RK , 
                  LoadDate , 
                  H_Member_RK , 
                  [CR-MEMBER-ID] , 
                  [CR-MEMBER-BIRTH-DATE] , 
                  [Member Last Name] , 
                  [Member First Name] , 
                  [Member Middle Initial] , 
                  [Member Gender] , 
                  Age , 
                  [Member PCP Assignment] , 
                  [Member Program] , 
                  [DOB Default] , 
                  HashDiff , 
                  RecordSource 
	            ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-BIRTH-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Gender], ''))), ':', RTRIM(LTRIM(COALESCE(a.[Age], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[Member PCP Assignment], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Program], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DOB Default], '')))))), 2)) , 
                        @LoadDate , 
                        h.H_Member_RK , 
                        [CR-MEMBER-ID] , 
                        [CR-MEMBER-BIRTH-DATE] , 
                        [Member Last Name] , 
                        [Member First Name] , 
                        [Member Middle Initial] , 
                        [Member Gender] , 
                        Age , 
                        [Member PCP Assignment] , 
                        [Member Program] , 
                        [DOB Default] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-BIRTH-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Gender], ''))), ':', RTRIM(LTRIM(COALESCE(a.[Age], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[Member PCP Assignment], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Program], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DOB Default], '')))))), 2)) , 
                        'GuildNet_GNESIBatchPayDet_PharmacyClaim ' 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyClaim a 
                        INNER JOIN dbo.H_Member h ON a.CentauriMemberID = h.Member_BK 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-BIRTH-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Gender], ''))), ':', RTRIM(LTRIM(COALESCE(a.[Age], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[Member PCP Assignment], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Program], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DOB Default], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_MemberPharmacyClaim 
                        WHERE   H_Member_RK = h.H_Member_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-BIRTH-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Member Last Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Member First Name], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Member Middle Initial], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Member Gender], ''))), ':', RTRIM(LTRIM(COALESCE(a.[Age], ''))), 
                                                                        ':', RTRIM(LTRIM(COALESCE(a.[Member PCP Assignment], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[Member Program], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[DOB Default], '')))))), 2)) , 
                        h.H_Member_RK , 
                        [CR-MEMBER-ID] , 
                        [CR-MEMBER-BIRTH-DATE] , 
                        [Member Last Name] , 
                        [Member First Name] , 
                        [Member Middle Initial] , 
                        [Member Gender] , 
                        Age , 
                        [Member PCP Assignment] , 
                        [Member Program] , 
                        [DOB Default] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-BIRTH-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Gender], ''))), ':', RTRIM(LTRIM(COALESCE(a.[Age], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[Member PCP Assignment], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Program], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DOB Default], '')))))), 2)); 
 
 
--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_MemberPharmacyClaim 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_MemberPharmacyClaim z 
                                  WHERE     z.H_Member_RK = a.H_Member_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_MemberPharmacyClaim a 
        WHERE   a.RecordEndDate IS NULL;  
 
 
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_MemberPharmacyClaim' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_MemberPharmacyClaim' , 
                      GETDATE() 
                    ); 
 
 
 
--Load History Table for S_MemberPharmacyClaim 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_MemberPharmacyClaim' 
                        ) , 
                     UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CR-MEMBER-BIRTH-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Last Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member First Name], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Middle Initial], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Gender], ''))), ':', RTRIM(LTRIM(COALESCE(a.[Age], ''))), 
                                                                       ':', RTRIM(LTRIM(COALESCE(a.[Member PCP Assignment], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[Member Program], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[DOB Default], '')))))), 2))  , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource COLLATE Compatibility_52_409_30003 = a.FileName 
                        ) 
                 FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyClaim a 
                        INNER JOIN dbo.H_Member h ON a.CentauriMemberID = h.Member_BK 
 
 
--  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  
--  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  
--  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  
--  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  S_PharmacyHeader ***  
 
        --DECLARE @LoadDate DATETIME; 
        SET @LoadDate = GETDATE(); 
 
        INSERT  INTO dbo.S_PharmacyHeader 
                ( S_PharmacyHeader_RK , 
                  LoadDate , 
                  H_Pharmacy_RK , 
                  [PHR-BATCH-NUMBER] , 
                  [PHR-END-OF-CYCLE-DATE] , 
                  [PHR-PHARMACY-NABP-NO] , 
                  [PHR-VENDOR-NUMBER] , 
                  [PHR-PHARMACY-NAME] , 
                  [PHR-HIP-PHARMACY-CODE] , 
                  [PHR-RECONCILIATION-GROUP] , 
                  [PHR-STATE-LICENSE-NUMBER] , 
                  [PHR-MEDICAID-PROVIDER-ID] , 
                  [PHR-NPI-ID] , 
                  [PHR-CLIENT] , 
                  HashDiff , 
                  RecordSource 
	            ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        @LoadDate , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PHR-END-OF-CYCLE-DATE] , 
                        a.[PHR-PHARMACY-NABP-NO] , 
                        a.[PHR-VENDOR-NUMBER] , 
                        a.[PHR-PHARMACY-NAME] , 
                        a.[PHR-HIP-PHARMACY-CODE] , 
                        a.[PHR-RECONCILIATION-GROUP] , 
                        a.[PHR-STATE-LICENSE-NUMBER] , 
                        a.[PHR-MEDICAID-PROVIDER-ID] , 
                        a.[PHR-NPI-ID] , 
                        a.[PHR-CLIENT] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        a.FileName 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyHeader a 
                        INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
                                                       AND FileName = ( SELECT TOP 1 
                                                                                FileName 
                                                                        FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyHeader 
                                                                        ORDER BY FileName 
                                                                      ) 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_PharmacyHeader 
                        WHERE   H_Pharmacy_RK = b.H_Pharmacy_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PHR-END-OF-CYCLE-DATE] , 
                        a.[PHR-PHARMACY-NABP-NO] , 
                        a.[PHR-VENDOR-NUMBER] , 
                        a.[PHR-PHARMACY-NAME] , 
                        a.[PHR-HIP-PHARMACY-CODE] , 
                        a.[PHR-RECONCILIATION-GROUP] , 
                        a.[PHR-STATE-LICENSE-NUMBER] , 
                        a.[PHR-MEDICAID-PROVIDER-ID] , 
                        a.[PHR-NPI-ID] , 
                        a.[PHR-CLIENT] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        a.FileName; 
 
			 
--DECLARE @LoadDate  DATETIME 
        SET @LoadDate = GETDATE(); 
 
        INSERT  INTO dbo.S_PharmacyHeader 
                ( S_PharmacyHeader_RK , 
                  LoadDate , 
                  H_Pharmacy_RK , 
                  [PHR-BATCH-NUMBER] , 
                  [PHR-END-OF-CYCLE-DATE] , 
                  [PHR-PHARMACY-NABP-NO] , 
                  [PHR-VENDOR-NUMBER] , 
                  [PHR-PHARMACY-NAME] , 
                  [PHR-HIP-PHARMACY-CODE] , 
                  [PHR-RECONCILIATION-GROUP] , 
                  [PHR-STATE-LICENSE-NUMBER] , 
                  [PHR-MEDICAID-PROVIDER-ID] , 
                  [PHR-NPI-ID] , 
                  [PHR-CLIENT] , 
                  HashDiff , 
                  RecordSource 
	            ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        @LoadDate , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PHR-END-OF-CYCLE-DATE] , 
                        a.[PHR-PHARMACY-NABP-NO] , 
                        a.[PHR-VENDOR-NUMBER] , 
                        a.[PHR-PHARMACY-NAME] , 
                        a.[PHR-HIP-PHARMACY-CODE] , 
                        a.[PHR-RECONCILIATION-GROUP] , 
                        a.[PHR-STATE-LICENSE-NUMBER] , 
                        a.[PHR-MEDICAID-PROVIDER-ID] , 
                        a.[PHR-NPI-ID] , 
                        a.[PHR-CLIENT] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        a.FileName 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyHeader a 
                        INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
                                                       AND FileName = ( SELECT TOP 1 
                                                                                FileName 
                                                                        FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyHeader 
                                                                        ORDER BY FileName DESC 
                                                                      ) 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_PharmacyHeader 
                        WHERE   H_Pharmacy_RK = b.H_Pharmacy_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PHR-END-OF-CYCLE-DATE] , 
                        a.[PHR-PHARMACY-NABP-NO] , 
                        a.[PHR-VENDOR-NUMBER] , 
                        a.[PHR-PHARMACY-NAME] , 
                        a.[PHR-HIP-PHARMACY-CODE] , 
                        a.[PHR-RECONCILIATION-GROUP] , 
                        a.[PHR-STATE-LICENSE-NUMBER] , 
                        a.[PHR-MEDICAID-PROVIDER-ID] , 
                        a.[PHR-NPI-ID] , 
                        a.[PHR-CLIENT] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)) , 
                        a.FileName; 
 
 
						 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_PharmacyHeader 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_PharmacyHeader z 
                                  WHERE     z.H_Pharmacy_RK = a.H_Pharmacy_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_PharmacyHeader a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_PharmacyHeader' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_PharmacyHeader', GETDATE() ); 
 
 
			 
     /*   INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        FileName 
                FROM    CHSStaging.[dbo].GuildNet_GNESIBatchPayDet_PharmacyHeader; 
				*/ 
 
 
--Load History Table for S_PharmacyHeader 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_PharmacyHeader' 
                        ) , 
                     UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-VENDOR-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-PHARMACY-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-HIP-PHARMACY-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-RECONCILIATION-GROUP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-STATE-LICENSE-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-MEDICAID-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-CLIENT], '')))))), 2)), 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource COLLATE Compatibility_52_409_30003 = a.FileName 
                        ) 
     FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyHeader a 
                        INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
 
 
 
 
--  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  
--  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  
--  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  
--  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  S_PharmacyTrailer ***  
 
        --DECLARE @LoadDate DATETIME; 
        SET @LoadDate = GETDATE(); 
 
        INSERT  INTO dbo.S_PharmacyTrailer 
                ( S_PharmacyTrailer_RK , 
                  LoadDate , 
                  H_Pharmacy_RK , 
                  [PHR-BATCH-NUMBER] , 
                  [PTR-END-OF-CYCLE-DATE] , 
                  [PTR-PHARMACY-NABP-NO] , 
                  [PTR-VENDOR] , 
                  [PTR-TOTAL-AMOUNT] , 
                  [PTR-NUMBER-OF-CLAIMS] , 
                  [PTR-TOTAL-REJECTS] , 
                  [PTR-NPI-ID] , 
                  [PTR-TOTAL-ADMIN] , 
                  HashDiff , 
                  RecordSource 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        @LoadDate , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PTR-END-OF-CYCLE-DATE] , 
                        a.[PTR-PHARMACY-NABP-NO] , 
                        a.[PTR-VENDOR] , 
                        a.[PTR-TOTAL-AMOUNT] , 
                        a.[PTR-NUMBER-OF-CLAIMS] , 
                        a.[PTR-TOTAL-REJECTS] , 
                        a.[PTR-NPI-ID] , 
                        a.[PTR-TOTAL-ADMIN] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        a.FileName 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyTrailer a 
                        INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
                                                       AND FileName = ( SELECT TOP 1 
                                                                                FileName 
                                                                        FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyTrailer 
                                                                        ORDER BY FileName 
                                                                      ) 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_PharmacyTrailer 
                        WHERE   H_Pharmacy_RK = b.H_Pharmacy_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PTR-END-OF-CYCLE-DATE] , 
                        a.[PTR-PHARMACY-NABP-NO] , 
                        a.[PTR-VENDOR] , 
                        a.[PTR-TOTAL-AMOUNT] , 
                        a.[PTR-NUMBER-OF-CLAIMS] , 
                        a.[PTR-TOTAL-REJECTS] , 
                        a.[PTR-NPI-ID] , 
                        a.[PTR-TOTAL-ADMIN] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        a.FileName; 
 
			 
--DECLARE @LoadDate  DATETIME 
        SET @LoadDate = GETDATE(); 
 
        INSERT  INTO dbo.S_PharmacyTrailer 
                ( S_PharmacyTrailer_RK , 
                  LoadDate , 
                  H_Pharmacy_RK , 
                  [PHR-BATCH-NUMBER] , 
                  [PTR-END-OF-CYCLE-DATE] , 
                  [PTR-PHARMACY-NABP-NO] , 
                  [PTR-VENDOR] , 
                  [PTR-TOTAL-AMOUNT] , 
                  [PTR-NUMBER-OF-CLAIMS] , 
                  [PTR-TOTAL-REJECTS] , 
                  [PTR-NPI-ID] , 
                  [PTR-TOTAL-ADMIN] , 
                  HashDiff , 
                  RecordSource 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        @LoadDate , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PTR-END-OF-CYCLE-DATE] , 
                        a.[PTR-PHARMACY-NABP-NO] , 
                        a.[PTR-VENDOR] , 
                        a.[PTR-TOTAL-AMOUNT] , 
                        a.[PTR-NUMBER-OF-CLAIMS] , 
                        a.[PTR-TOTAL-REJECTS] , 
                        a.[PTR-NPI-ID] , 
                        a.[PTR-TOTAL-ADMIN] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        a.FileName 
                FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyTrailer a 
                        INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
                                                       AND FileName = ( SELECT TOP 1 
                                                                                FileName 
                                                                        FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyTrailer 
                                                                        ORDER BY FileName DESC 
                                                                      ) 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_PharmacyTrailer 
                        WHERE   H_Pharmacy_RK = b.H_Pharmacy_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        b.H_Pharmacy_RK , 
                        a.[PHR-BATCH-NUMBER] , 
                        a.[PTR-END-OF-CYCLE-DATE] , 
                        a.[PTR-PHARMACY-NABP-NO] , 
                        a.[PTR-VENDOR] , 
                        a.[PTR-TOTAL-AMOUNT] , 
                        a.[PTR-NUMBER-OF-CLAIMS] , 
                        a.[PTR-TOTAL-REJECTS] , 
                        a.[PTR-NPI-ID] , 
                        a.[PTR-TOTAL-ADMIN] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2)) , 
                        a.FileName; 
 
 
						 
						 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_PharmacyTrailer 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_PharmacyTrailer z 
                                  WHERE     z.H_Pharmacy_RK = a.H_Pharmacy_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_PharmacyTrailer a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_PharmacyTrailer' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName, CreateDate ) 
            VALUES  ( 'S_PharmacyTrailer', GETDATE() ); 
 
 
 
              
 
--Load History Table for S_PharmacyTrailer 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_PharmacyTrailer' 
                        ) , 
                       UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PHR-BATCH-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-END-OF-CYCLE-DATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-PHARMACY-NABP-NO], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-VENDOR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-AMOUNT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NUMBER-OF-CLAIMS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-REJECTS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-NPI-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[PTR-TOTAL-ADMIN], '')))))), 2))  , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource COLLATE Compatibility_52_409_30003 = a.FileName 
                        ) 
                 FROM    CHSStaging.dbo.GuildNet_GNESIBatchPayDet_PharmacyTrailer a 
                        INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
 
 
 
--Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details **  
--Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details **  
--Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details **  
--Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details ** Load S_GNClaims160807Details **  
 
 
        INSERT  INTO dbo.S_GNClaims160807Details 
                ( S_GNClaims160807Details_RK , 
                  LoadDate , 
                  H_Claims_RK , 
                  [CL-EXT-FILE-IND] , 
                  [CL-EXT-0003-SITE-ID] , 
                  [CL-EXT-1001-CLAIM-NUMBER] , 
                  [CL-EXT-1415-RELATIONSHIP] , 
                  [CL-EXT-3017-MBR-FAMLY-LINK] , 
                  [CL-EXT-3816-MEDICAL-GRP] , 
                  [CL-EXT-3113-PCP-ID] , 
                  [CL-EXT-3808-PC-MG-ID] , 
                  [CL-EXT-SERV-MGCT] , 
                  [CL-EXT-4302-EMPL-GROUP-ID] , 
                  [    CL-EXT-EMP-GRP1] , 
                  [    FILLER] , 
                  [CL-EXT-4332-LOB] , 
                  [CL-EXT-4428-MBR-ORIGIN] , 
                  [CL-EXT-2616-REIMBURSE-IND] , 
                  [CL-EXT-4173-BENSET-ID] , 
                  [CL-EXT-1206-TYPE-OF-SERVICE] , 
                  [CL-EXT-1207-PLACE-OF-SERVICE] , 
                  [CL-EXT-BEG-DOS] , 
                  [CL-EXT-END-DOS] , 
                  [CL-EXT-2045-OUT-OF-PLAN-IND] , 
                  [CL-EXT-1208-PRIMARY-DIAG-CODE] , 
                  [CL-EXT-1211-SECOND-DIAG-CODE] , 
                  [CL-EXT-1218-PROC-CODE] , 
                  [CL-EXT-1219-PROC-MODIFY] , 
                  [CL-EXT-4508-ANESTHESIA-UNITS] , 
                  [CL-EXT-4508-ANESTHESIA-SIGN] , 
                  [CL-EXT-6003-REC-TYPE] , 
                  [CL-EXT-1721-ADMIT-SOURCE] , 
                  [CL-EXT-1531-ADMIT-TYPE] , 
                  [CL-EXT-1503-ADMIT-DT] , 
                  [CL-EXT-1510-ADMIT-HOUR] , 
                  [CL-EXT-1513-ATTEND-PHYSICIAN] , 
                  [CL-EXT-1481-OTHER-PHYSICIAN] , 
                  [CL-EXT-1700-BILL-TYPE] , 
                  [CL-EXT-1445-BIRTH-WEIGHT] , 
                  [CL-EXT-1512-COVERED-DAYS] , 
                  [    CL-EXT-1512-COVERED-DAYS-N] , 
                  [CL-EXT-1430-NON-COVERED-DAYS] , 
                  [    CL-EXT-1430-NON-COVERED-DAYS-N] , 
                  [CL-EXT-1653-DRG] , 
                  [CL-EXT-DISCHARGE-DT] , 
                  [CL-EXT-1511-DISCHARGE-HOUR] , 
                  [CL-EXT-1704-DISCHARGE-STATUS] , 
                  [CL-EXT-LOS] , 
                  [CL-EXT-1519-CAT-OF-SERVICE] , 
                  [CL-EXT-4684-DISC-CATEGORY] , 
                  [CL-EXT-TARGETED-SVC-CODE] , 
                  [CL-EXT-1097-CLAIM-SOURCE] , 
                  [CL-EXT-OUTLIER-DAYS] , 
                  [    CL-EXT-OUTLIER-DAYS-N] , 
                  [CL-EXT-OUTLIER-AMT] , 
                  [CL-EXT-1668-OUTLIER-TYPE] , 
                  [CL-EXT-1130-MAN-PRICE-DOC-IND] , 
                  [CL-EXT-MEMBER-ON-FILE-IND] , 
                  [CL-EXT-MEMBER-ELIGIBLE-IND] , 
                  [CL-EXT-1495-INFANT-NEWBORN-IND] , 
                  [CL-EXT-6001-PA-NUMBER] , 
                  [CL-EXT-1017-DT-RECEIVED] , 
                  [CL-EXT-TYPE-OF-ASSISTANCE] , 
                  [CL-EXT-1096-LCHANGE-OP-ID] , 
                  [CL-EXT-1539-EST-AMOUNT-DUE-1] , 
                  [CL-EXT-1539-EST-AMT-DUE-1-SIGN] , 
                  [CL-EXT-1717-EMPLOY-STATUS-CD-1] , 
                  [CL-EXT-1539-EST-AMOUNT-DUE-2] , 
                  [CL-EXT-1539-EST-AMT-DUE-2-SIGN] , 
                  [CL-EXT-1717-EMPLOY-STATUS-CD-2] , 
                  [CL-EXT-1539-EST-AMOUNT-DUE-3] , 
                  [CL-EXT-1539-EST-AMT-DUE-3-SIGN] , 
                  [CL-EXT-1717-EMPLOY-STATUS-CD-3] , 
                  [CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES] , 
                  [CL-EXT-REV-TABLE-CNTR] , 
                  [CL-EXT-REVENUE-TABLE] , 
                  [    CL-EXT-REV-TBL(1) OCCURS 99 TIMES] , 
                  [    CL-EXT-1714-REVENUE-CODE(1)] , 
                  [    CL-EXT-REVENUE-UNITS(1)] , 
                  [    CL-EXT-REVENUE-UNITS-SIGN(1)] , 
                  [    CL-EXT-REVENUE-CHARGES(1)] , 
                  [    CL-EXT-REVENUE-CHARGES-SIGN(1)] , 
                  [    CL-EXT-REVENUE-ADJUD-AMT(1)] , 
                  [    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)] , 
                  [CL-EXT-VALUE-TBL-CNTR] , 
                  [CL-EXT-VALUE-TABLE] , 
                  [    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES] , 
                  [    CL-EXT-1715-VALUE-CODE(1)] , 
                  [    CL-EXT-1543-VALUE-AMOUNT(1)] , 
                  [    CL-EXT-VALUE-AMOUNT-SIGN(1)] , 
                  [CL-EXT-ERROR-TBL-CNTR] , 
                  [CL-EXT-ERROR-TABLE] , 
                  [CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE] , 
                  [CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES] , 
                  [    CL-EXT-1061-ERROR-RSN(1)] , 
                  [CL-EXT-1216-PRIN-DIAG-CODE] , 
                  [CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES] , 
                  [CL-EXT-1506-PRIN-PROC-CODE] , 
                  [CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES] , 
                  [CL-EXT-ANCILLARY-RATE] , 
                  [CL-EXT-1218-PROCEDURE-CODE] , 
                  [    CL-EXT-1218-PROC-CD] , 
                  [    CL-EXT-1219-MODIFIER] , 
                  [    CL-EXT-1219-MODIFIER-2] , 
                  [CL-EXT-PAYMT-STATUS-1] , 
                  [CL-EXT-PAYMT-DATE-1] , 
                  [CL-EXT-CHECK-NUM-1] , 
                  [CL-EXT-BILLED-AMT-1] , 
                  [CL-EXT-BILLED-AMT-1-SIGN] , 
                  [CL-EXT-PAID-AMT-1] , 
                  [CL-EXT-PAID-AMT-1-SIGN] , 
                  [CL-EXT-ADJUD-AMT-1] , 
                  [CL-EXT-ADJUD-AMT-1-SIGN] , 
                  [CL-EXT-UNITS-1] , 
                  [    CL-EXT-UNITS-N-1] , 
                  [CL-EXT-FFS-OR-CAP-IND-1] , 
                  [CL-EXT-AMOUNT-APPROVED-1] , 
                  [CL-EXT-AMT-APPROVED-1-SIGN] , 
                  [CL-EXT-REVIEWED-AMOUNT-1] , 
                  [CL-EXT-REVIEWED-AMOUNT-1-SIGN] , 
                  [CL-EXT-ALLOWED-AMOUNT-1] , 
                  [CL-EXT-ALLOWED-AMOUNT-1-SIGN] , 
                  [CL-EXT-ENCOUNTER-AMOUNT-1] , 
                  [CL-EXT-ENCOUNTER-AMOUNT-1-SIGN] , 
                  [CL-EXT-1222-CPT4-AMOUNT-1] , 
                  [CL-EXT-1222-CPT4-AMT-1-SIGN] , 
                  [CL-EXT-PAYMT-STATUS-2] , 
                  [CL-EXT-PAYMT-DATE-2] , 
                  [CL-EXT-CHECK-NUM-2] , 
                  [CL-EXT-BILLED-AMT-2] , 
                  [CL-EXT-BILLED-AMT-2-SIGN] , 
                  [CL-EXT-PAID-AMT-2] , 
                  [CL-EXT-PAID-AMT-2-SIGN] , 
                  [CL-EXT-ADJUD-AMT-2] , 
                  [CL-EXT-ADJUD-AMT-2-SIGN] , 
                  [CL-EXT-UNITS-2] , 
                  [    CL-EXT-UNITS-N-2] , 
                  [CL-EXT-FFS-OR-CAP-IND-2] , 
                  [CL-EXT-AMOUNT-APPROVED-2] , 
                  [CL-EXT-AMT-APPROVED-2-SIGN] , 
                  [CL-EXT-REVIEWED-AMOUNT-2] , 
                  [CL-EXT-REVIEWED-AMOUNT-2-SIGN] , 
                  [CL-EXT-ALLOWED-AMOUNT-2] , 
                  [CL-EXT-ALLOWED-AMOUNT-2-SIGN] , 
                  [CL-EXT-ENCOUNTER-AMOUNT-2] , 
                  [CL-EXT-ENCOUNTER-AMOUNT-2-SIGN] , 
                  [CL-EXT-1222-CPT4-AMOUNT-2] , 
                  [CL-EXT-1222-CPT4-AMT-2-SIGN] , 
                  [CL-EXT-PAYMT-STATUS-3] , 
                  [CL-EXT-PAYMT-DATE-3] , 
                  [CL-EXT-CHECK-NUM-3] , 
                  [CL-EXT-BILLED-AMT-3] , 
                  [CL-EXT-BILLED-AMT-3-SIGN] , 
                  [CL-EXT-PAID-AMT-3] , 
                  [CL-EXT-PAID-AMT-3-SIGN] , 
                  [CL-EXT-ADJUD-AMT-3] , 
                  [CL-EXT-ADJUD-AMT-3-SIGN] , 
                  [CL-EXT-UNITS-3] , 
                  [    CL-EXT-UNITS-N-3] , 
                  [CL-EXT-FFS-OR-CAP-IND-3] , 
                  [CL-EXT-AMOUNT-APPROVED-3] , 
                  [CL-EXT-AMT-APPROVED-3-SIGN] , 
                  [CL-EXT-REVIEWED-AMOUNT-3] , 
                  [CL-EXT-REVIEWED-AMOUNT-3-SIGN] , 
                  [CL-EXT-ALLOWED-AMOUNT-3] , 
                  [CL-EXT-ALLOWED-AMOUNT-3-SIGN] , 
                  [CL-EXT-ENCOUNTER-AMOUNT-3] , 
                  [CL-EXT-ENCOUNTER-AMOUNT-3-SIGN] , 
                  [CL-EXT-1222-CPT4-AMOUNT-3] , 
                  [CL-EXT-1222-CPT4-AMT-3-SIGN] , 
                  [CL-EXT-MP-EOC] , 
                  [CL-EXT-INTEREST-1] , 
                  [CL-EXT-INTEREST-1-SIGN] , 
                  [CL-EXT-INTEREST-2] , 
                  [CL-EXT-INTEREST-2-SIGN] , 
                  [CL-EXT-INTEREST-3] , 
                  [CL-EXT-INTEREST-3-SIGN] , 
                  [CL-EXT-CHECK-ACCT-1] , 
                  [CL-EXT-CHECK-ACCT-2] , 
                  [CL-EXT-CHECK-ACCT-3] , 
                  [CL-EXT-1027-PROV-REF-QUAL] , 
                  [CL-EXT-1027-PROV-REF-NPI] , 
                  [CL-EXT-0506-PROV-AFF-QUAL] , 
                  [CL-EXT-0506-PROV-AFF-NPI] , 
                  [CL-EXT-9999-PROV-BILL-QUAL] , 
                  [CL-EXT-9999-PROV-BILL-NPI] , 
                  [CL-EXT-1508-PAT-ACCT-NO] , 
                  [CL-EXT-PAR-IND] , 
                  [CL-EXT-1532-MEDICAL-RECORD-NO] , 
                  [CL-EXT-9999-ICD-INDICATOR] , 
                  [CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES] , 
                  [CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES] , 
                  [CL-EXT-1517-PRIN-PROC-DT] , 
                  [CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES] , 
                  [CL-EXT-1039-OTHER-INS-PAID-1] , 
                  [CL-EXT-1039-OTHER-INS-PAID-2] , 
                  [CL-EXT-1039-OTHER-INS-PAID-3] , 
                  [CL-EXT-1056-DEDUCTIBLE-1] , 
                  [CL-EXT-1056-DEDUCTIBLE-2] , 
                  [CL-EXT-1056-DEDUCTIBLE-3] , 
                  [CL-EXT-1040-CO-PAY-1] , 
                  [CL-EXT-1040-CO-PAY-2] , 
                  [CL-EXT-1040-CO-PAY-3] , 
                  [CL-EXT-1047-COINS-AMOUNT-1] , 
                  [CL-EXT-1047-COINS-AMOUNT-2] , 
                  [CL-EXT-1047-COINS-AMOUNT-3] , 
                  [CL-EXT-1057-DISCT-AMOUNT-1] , 
                  [CL-EXT-1057-DISCT-AMOUNT-2] , 
                  [CL-EXT-1057-DISCT-AMOUNT-3] , 
                  [CL-EXT-1224-WITHHOLD-1] , 
                  [CL-EXT-1224-WITHHOLD-2] , 
                  [CL-EXT-1224-WITHHOLD-3] , 
                  [CL-EXT-1231-COB-PAYOUT-AMT-1] , 
                  [CL-EXT-1231-COB-PAYOUT-AMT-2] , 
                  [CL-EXT-1231-COB-PAYOUT-AMT-3] , 
                  [CL-EXT-2783-NETWORK-ID] , 
                  [CL-EXT-FILLER-01] , 
                  HashDiff , 
                  RecordSource , 
                  RecordEndDate 
						 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimsID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-0003-SITE-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1001-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1415-RELATIONSHIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3017-MBR-FAMLY-LINK], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3816-MEDICAL-GRP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3113-PCP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3808-PC-MG-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-SERV-MGCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4302-EMPL-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-EMP-GRP1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    FILLER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4332-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4428-MBR-ORIGIN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2616-REIMBURSE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4173-BENSET-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1206-TYPE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1207-PLACE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-BEG-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-END-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2045-OUT-OF-PLAN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-PRIMARY-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1211-SECOND-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1219-PROC-MODIFY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-UNITS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6003-REC-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1721-ADMIT-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1531-ADMIT-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1503-ADMIT-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1510-ADMIT-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1513-ATTEND-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1481-OTHER-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1700-BILL-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1445-BIRTH-WEIGHT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1512-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1512-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1430-NON-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1430-NON-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1653-DRG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-DISCHARGE-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1511-DISCHARGE-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1704-DISCHARGE-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-LOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1519-CAT-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4684-DISC-CATEGORY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TARGETED-SVC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1097-CLAIM-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-OUTLIER-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1668-OUTLIER-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1130-MAN-PRICE-DOC-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ON-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ELIGIBLE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1495-INFANT-NEWBORN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6001-PA-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1017-DT-RECEIVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TYPE-OF-ASSISTANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1096-LCHANGE-OP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REV-TABLE-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVENUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1714-REVENUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1715-VALUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1543-VALUE-AMOUNT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1061-ERROR-RSN(1)], ''))), ':') 
                                                                + CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-1216-PRIN-DIAG-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-PRIN-PROC-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ANCILLARY-RATE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROCEDURE-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1218-PROC-CD], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-MP-EOC], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1508-PAT-ACCT-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAR-IND], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1532-MEDICAL-RECORD-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-ICD-INDICATOR], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1517-PRIN-PROC-DT], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-2783-NETWORK-ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILLER-01], '')))))), 2)) , 
                        GETDATE() , 
                        b.H_Claims_RK , 
                        a.[CL-EXT-FILE-IND] , 
                        a.[CL-EXT-0003-SITE-ID] , 
                        a.[CL-EXT-1001-CLAIM-NUMBER] , 
                        a.[CL-EXT-1415-RELATIONSHIP] , 
                        a.[CL-EXT-3017-MBR-FAMLY-LINK] , 
                        a.[CL-EXT-3816-MEDICAL-GRP] , 
                        a.[CL-EXT-3113-PCP-ID] , 
                        a.[CL-EXT-3808-PC-MG-ID] , 
                        a.[CL-EXT-SERV-MGCT] , 
                        a.[CL-EXT-4302-EMPL-GROUP-ID] , 
                        a.[    CL-EXT-EMP-GRP1] , 
                        a.[    FILLER] , 
                        a.[CL-EXT-4332-LOB] , 
                        a.[CL-EXT-4428-MBR-ORIGIN] , 
                        a.[CL-EXT-2616-REIMBURSE-IND] , 
                        a.[CL-EXT-4173-BENSET-ID] , 
                        a.[CL-EXT-1206-TYPE-OF-SERVICE] , 
                        a.[CL-EXT-1207-PLACE-OF-SERVICE] , 
                        a.[CL-EXT-BEG-DOS] , 
                        a.[CL-EXT-END-DOS] , 
                        a.[CL-EXT-2045-OUT-OF-PLAN-IND] , 
                        a.[CL-EXT-1208-PRIMARY-DIAG-CODE] , 
                        a.[CL-EXT-1211-SECOND-DIAG-CODE] , 
                        a.[CL-EXT-1218-PROC-CODE] , 
                        a.[CL-EXT-1219-PROC-MODIFY] , 
                        a.[CL-EXT-4508-ANESTHESIA-UNITS] , 
                        a.[CL-EXT-4508-ANESTHESIA-SIGN] , 
                        a.[CL-EXT-6003-REC-TYPE] , 
                        a.[CL-EXT-1721-ADMIT-SOURCE] , 
                        a.[CL-EXT-1531-ADMIT-TYPE] , 
                        a.[CL-EXT-1503-ADMIT-DT] , 
                        a.[CL-EXT-1510-ADMIT-HOUR] , 
                        a.[CL-EXT-1513-ATTEND-PHYSICIAN] , 
                        a.[CL-EXT-1481-OTHER-PHYSICIAN] , 
                        a.[CL-EXT-1700-BILL-TYPE] , 
                        a.[CL-EXT-1445-BIRTH-WEIGHT] , 
                        a.[CL-EXT-1512-COVERED-DAYS] , 
                        a.[    CL-EXT-1512-COVERED-DAYS-N] , 
                        a.[CL-EXT-1430-NON-COVERED-DAYS] , 
                        a.[    CL-EXT-1430-NON-COVERED-DAYS-N] , 
                        a.[CL-EXT-1653-DRG] , 
                        a.[CL-EXT-DISCHARGE-DT] , 
                        a.[CL-EXT-1511-DISCHARGE-HOUR] , 
                        a.[CL-EXT-1704-DISCHARGE-STATUS] , 
                        a.[CL-EXT-LOS] , 
                        a.[CL-EXT-1519-CAT-OF-SERVICE] , 
                        a.[CL-EXT-4684-DISC-CATEGORY] , 
                        a.[CL-EXT-TARGETED-SVC-CODE] , 
                        a.[CL-EXT-1097-CLAIM-SOURCE] , 
                        a.[CL-EXT-OUTLIER-DAYS] , 
                        a.[    CL-EXT-OUTLIER-DAYS-N] , 
                        a.[CL-EXT-OUTLIER-AMT] , 
                        a.[CL-EXT-1668-OUTLIER-TYPE] , 
                        a.[CL-EXT-1130-MAN-PRICE-DOC-IND] , 
                        a.[CL-EXT-MEMBER-ON-FILE-IND] , 
                        a.[CL-EXT-MEMBER-ELIGIBLE-IND] , 
                        a.[CL-EXT-1495-INFANT-NEWBORN-IND] , 
                        a.[CL-EXT-6001-PA-NUMBER] , 
                        a.[CL-EXT-1017-DT-RECEIVED] , 
                        a.[CL-EXT-TYPE-OF-ASSISTANCE] , 
                        a.[CL-EXT-1096-LCHANGE-OP-ID] , 
                        a.[CL-EXT-1539-EST-AMOUNT-DUE-1] , 
                        a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN] , 
                        a.[CL-EXT-1717-EMPLOY-STATUS-CD-1] , 
                        a.[CL-EXT-1539-EST-AMOUNT-DUE-2] , 
                        a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN] , 
                        a.[CL-EXT-1717-EMPLOY-STATUS-CD-2] , 
                        a.[CL-EXT-1539-EST-AMOUNT-DUE-3] , 
                        a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN] , 
                        a.[CL-EXT-1717-EMPLOY-STATUS-CD-3] , 
                        a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES] , 
                        a.[CL-EXT-REV-TABLE-CNTR] , 
                        a.[CL-EXT-REVENUE-TABLE] , 
                        a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES] , 
                        a.[    CL-EXT-1714-REVENUE-CODE(1)] , 
                        a.[    CL-EXT-REVENUE-UNITS(1)] , 
                        a.[    CL-EXT-REVENUE-UNITS-SIGN(1)] , 
                        a.[    CL-EXT-REVENUE-CHARGES(1)] , 
                        a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)] , 
                        a.[    CL-EXT-REVENUE-ADJUD-AMT(1)] , 
                        a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)] , 
                        a.[CL-EXT-VALUE-TBL-CNTR] , 
                        a.[CL-EXT-VALUE-TABLE] , 
                        a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES] , 
                        a.[    CL-EXT-1715-VALUE-CODE(1)] , 
                        a.[    CL-EXT-1543-VALUE-AMOUNT(1)] , 
                        a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)] , 
                        a.[CL-EXT-ERROR-TBL-CNTR] , 
                        a.[CL-EXT-ERROR-TABLE] , 
                        a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE] , 
                        a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES] , 
                        a.[    CL-EXT-1061-ERROR-RSN(1)] , 
                        a.[CL-EXT-1216-PRIN-DIAG-CODE] , 
                        a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES] , 
                        a.[CL-EXT-1506-PRIN-PROC-CODE] , 
                        a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES] , 
                        a.[CL-EXT-ANCILLARY-RATE] , 
                        a.[CL-EXT-1218-PROCEDURE-CODE] , 
                        a.[    CL-EXT-1218-PROC-CD] , 
                        a.[    CL-EXT-1219-MODIFIER] , 
                        a.[    CL-EXT-1219-MODIFIER-2] , 
                        a.[CL-EXT-PAYMT-STATUS-1] , 
                        a.[CL-EXT-PAYMT-DATE-1] , 
                        a.[CL-EXT-CHECK-NUM-1] , 
                        a.[CL-EXT-BILLED-AMT-1] , 
                        a.[CL-EXT-BILLED-AMT-1-SIGN] , 
                        a.[CL-EXT-PAID-AMT-1] , 
                        a.[CL-EXT-PAID-AMT-1-SIGN] , 
                        a.[CL-EXT-ADJUD-AMT-1] , 
                        a.[CL-EXT-ADJUD-AMT-1-SIGN] , 
                        a.[CL-EXT-UNITS-1] , 
                        a.[    CL-EXT-UNITS-N-1] , 
                        a.[CL-EXT-FFS-OR-CAP-IND-1] , 
                        a.[CL-EXT-AMOUNT-APPROVED-1] , 
                        a.[CL-EXT-AMT-APPROVED-1-SIGN] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-1] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-1] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-1] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN] , 
                        a.[CL-EXT-1222-CPT4-AMOUNT-1] , 
                        a.[CL-EXT-1222-CPT4-AMT-1-SIGN] , 
                        a.[CL-EXT-PAYMT-STATUS-2] , 
                        a.[CL-EXT-PAYMT-DATE-2] , 
                        a.[CL-EXT-CHECK-NUM-2] , 
                        a.[CL-EXT-BILLED-AMT-2] , 
                        a.[CL-EXT-BILLED-AMT-2-SIGN] , 
                        a.[CL-EXT-PAID-AMT-2] , 
                        a.[CL-EXT-PAID-AMT-2-SIGN] , 
                        a.[CL-EXT-ADJUD-AMT-2] , 
                        a.[CL-EXT-ADJUD-AMT-2-SIGN] , 
                        a.[CL-EXT-UNITS-2] , 
                        a.[    CL-EXT-UNITS-N-2] , 
                        a.[CL-EXT-FFS-OR-CAP-IND-2] , 
                        a.[CL-EXT-AMOUNT-APPROVED-2] , 
                        a.[CL-EXT-AMT-APPROVED-2-SIGN] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-2] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-2] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-2] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN] , 
                        a.[CL-EXT-1222-CPT4-AMOUNT-2] , 
                        a.[CL-EXT-1222-CPT4-AMT-2-SIGN] , 
                        a.[CL-EXT-PAYMT-STATUS-3] , 
                        a.[CL-EXT-PAYMT-DATE-3] , 
                        a.[CL-EXT-CHECK-NUM-3] , 
                        a.[CL-EXT-BILLED-AMT-3] , 
                        a.[CL-EXT-BILLED-AMT-3-SIGN] , 
                        a.[CL-EXT-PAID-AMT-3] , 
                        a.[CL-EXT-PAID-AMT-3-SIGN] , 
                        a.[CL-EXT-ADJUD-AMT-3] , 
                        a.[CL-EXT-ADJUD-AMT-3-SIGN] , 
                        a.[CL-EXT-UNITS-3] , 
                        a.[    CL-EXT-UNITS-N-3] , 
                        a.[CL-EXT-FFS-OR-CAP-IND-3] , 
                        a.[CL-EXT-AMOUNT-APPROVED-3] , 
                        a.[CL-EXT-AMT-APPROVED-3-SIGN] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-3] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-3] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-3] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN] , 
                        a.[CL-EXT-1222-CPT4-AMOUNT-3] , 
                        a.[CL-EXT-1222-CPT4-AMT-3-SIGN] , 
                        a.[CL-EXT-MP-EOC] , 
                        a.[CL-EXT-INTEREST-1] , 
                        a.[CL-EXT-INTEREST-1-SIGN] , 
                        a.[CL-EXT-INTEREST-2] , 
                        a.[CL-EXT-INTEREST-2-SIGN] , 
                        a.[CL-EXT-INTEREST-3] , 
                        a.[CL-EXT-INTEREST-3-SIGN] , 
                        a.[CL-EXT-CHECK-ACCT-1] , 
                        a.[CL-EXT-CHECK-ACCT-2] , 
                        a.[CL-EXT-CHECK-ACCT-3] , 
                        a.[CL-EXT-1027-PROV-REF-QUAL] , 
                        a.[CL-EXT-1027-PROV-REF-NPI] , 
                        a.[CL-EXT-0506-PROV-AFF-QUAL] , 
                        a.[CL-EXT-0506-PROV-AFF-NPI] , 
                        a.[CL-EXT-9999-PROV-BILL-QUAL] , 
                        a.[CL-EXT-9999-PROV-BILL-NPI] , 
                        a.[CL-EXT-1508-PAT-ACCT-NO] , 
                        a.[CL-EXT-PAR-IND] , 
                        a.[CL-EXT-1532-MEDICAL-RECORD-NO] , 
                        a.[CL-EXT-9999-ICD-INDICATOR] , 
                        a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES] , 
                        a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES] , 
                        a.[CL-EXT-1517-PRIN-PROC-DT] , 
                        a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES] , 
                        a.[CL-EXT-1039-OTHER-INS-PAID-1] , 
                        a.[CL-EXT-1039-OTHER-INS-PAID-2] , 
                        a.[CL-EXT-1039-OTHER-INS-PAID-3] , 
                        a.[CL-EXT-1056-DEDUCTIBLE-1] , 
                        a.[CL-EXT-1056-DEDUCTIBLE-2] , 
                        a.[CL-EXT-1056-DEDUCTIBLE-3] , 
                        a.[CL-EXT-1040-CO-PAY-1] , 
                        a.[CL-EXT-1040-CO-PAY-2] , 
                        a.[CL-EXT-1040-CO-PAY-3] , 
                        a.[CL-EXT-1047-COINS-AMOUNT-1] , 
                        a.[CL-EXT-1047-COINS-AMOUNT-2] , 
                        a.[CL-EXT-1047-COINS-AMOUNT-3] , 
                        a.[CL-EXT-1057-DISCT-AMOUNT-1] , 
                        a.[CL-EXT-1057-DISCT-AMOUNT-2] , 
                        a.[CL-EXT-1057-DISCT-AMOUNT-3] , 
                        a.[CL-EXT-1224-WITHHOLD-1] , 
                        a.[CL-EXT-1224-WITHHOLD-2] , 
                        a.[CL-EXT-1224-WITHHOLD-3] , 
                        a.[CL-EXT-1231-COB-PAYOUT-AMT-1] , 
                        a.[CL-EXT-1231-COB-PAYOUT-AMT-2] , 
                        a.[CL-EXT-1231-COB-PAYOUT-AMT-3] , 
                        a.[CL-EXT-2783-NETWORK-ID] , 
                        a.[CL-EXT-FILLER-01] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-0003-SITE-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1001-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1415-RELATIONSHIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3017-MBR-FAMLY-LINK], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3816-MEDICAL-GRP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3113-PCP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3808-PC-MG-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-SERV-MGCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4302-EMPL-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-EMP-GRP1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    FILLER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4332-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4428-MBR-ORIGIN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2616-REIMBURSE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4173-BENSET-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1206-TYPE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1207-PLACE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-BEG-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-END-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2045-OUT-OF-PLAN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-PRIMARY-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1211-SECOND-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1219-PROC-MODIFY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-UNITS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6003-REC-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1721-ADMIT-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1531-ADMIT-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1503-ADMIT-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1510-ADMIT-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1513-ATTEND-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1481-OTHER-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1700-BILL-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1445-BIRTH-WEIGHT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1512-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1512-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1430-NON-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1430-NON-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1653-DRG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-DISCHARGE-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1511-DISCHARGE-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1704-DISCHARGE-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-LOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1519-CAT-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4684-DISC-CATEGORY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TARGETED-SVC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1097-CLAIM-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-OUTLIER-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1668-OUTLIER-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1130-MAN-PRICE-DOC-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ON-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ELIGIBLE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1495-INFANT-NEWBORN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6001-PA-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1017-DT-RECEIVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TYPE-OF-ASSISTANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1096-LCHANGE-OP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REV-TABLE-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVENUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1714-REVENUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1715-VALUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1543-VALUE-AMOUNT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1061-ERROR-RSN(1)], ''))), ':') 
                                                                + CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-1216-PRIN-DIAG-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-PRIN-PROC-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ANCILLARY-RATE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROCEDURE-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1218-PROC-CD], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-MP-EOC], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1508-PAT-ACCT-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAR-IND], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1532-MEDICAL-RECORD-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-ICD-INDICATOR], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1517-PRIN-PROC-DT], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-2783-NETWORK-ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILLER-01], '')))))), 2)) , 
                        'GNClaims_160807' , 
                        NULL 
                FROM    CHSStaging.dbo.GNClaims_160807Parsed a 
                        INNER JOIN dbo.H_Claims b ON a.CentauriClaimsID = b.Claims_BK 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-0003-SITE-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1001-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1415-RELATIONSHIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3017-MBR-FAMLY-LINK], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3816-MEDICAL-GRP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3113-PCP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3808-PC-MG-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-SERV-MGCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4302-EMPL-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-EMP-GRP1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    FILLER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4332-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4428-MBR-ORIGIN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2616-REIMBURSE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4173-BENSET-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1206-TYPE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1207-PLACE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-BEG-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-END-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2045-OUT-OF-PLAN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-PRIMARY-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1211-SECOND-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1219-PROC-MODIFY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-UNITS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6003-REC-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1721-ADMIT-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1531-ADMIT-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1503-ADMIT-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1510-ADMIT-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1513-ATTEND-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1481-OTHER-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1700-BILL-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1445-BIRTH-WEIGHT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1512-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1512-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1430-NON-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1430-NON-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1653-DRG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-DISCHARGE-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1511-DISCHARGE-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1704-DISCHARGE-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-LOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1519-CAT-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4684-DISC-CATEGORY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TARGETED-SVC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1097-CLAIM-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-OUTLIER-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1668-OUTLIER-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1130-MAN-PRICE-DOC-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ON-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ELIGIBLE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1495-INFANT-NEWBORN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6001-PA-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1017-DT-RECEIVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TYPE-OF-ASSISTANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1096-LCHANGE-OP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REV-TABLE-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVENUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1714-REVENUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1715-VALUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1543-VALUE-AMOUNT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1061-ERROR-RSN(1)], ''))), ':') 
                                                                + CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-1216-PRIN-DIAG-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-PRIN-PROC-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ANCILLARY-RATE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROCEDURE-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1218-PROC-CD], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-MP-EOC], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1508-PAT-ACCT-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAR-IND], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1532-MEDICAL-RECORD-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-ICD-INDICATOR], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1517-PRIN-PROC-DT], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-2783-NETWORK-ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILLER-01], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_GNClaims160807Details 
                        WHERE   H_Claims_RK = b.H_Claims_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimsID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILE-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-0003-SITE-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1001-CLAIM-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1415-RELATIONSHIP], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3017-MBR-FAMLY-LINK], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3816-MEDICAL-GRP], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3113-PCP-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3808-PC-MG-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-SERV-MGCT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4302-EMPL-GROUP-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-EMP-GRP1], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    FILLER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4332-LOB], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4428-MBR-ORIGIN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2616-REIMBURSE-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4173-BENSET-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1206-TYPE-OF-SERVICE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1207-PLACE-OF-SERVICE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-BEG-DOS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-END-DOS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2045-OUT-OF-PLAN-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-PRIMARY-DIAG-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1211-SECOND-DIAG-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROC-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1219-PROC-MODIFY], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-UNITS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-SIGN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-6003-REC-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1721-ADMIT-SOURCE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1531-ADMIT-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1503-ADMIT-DT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1510-ADMIT-HOUR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1513-ATTEND-PHYSICIAN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1481-OTHER-PHYSICIAN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1700-BILL-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1445-BIRTH-WEIGHT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1512-COVERED-DAYS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1512-COVERED-DAYS-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1430-NON-COVERED-DAYS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1430-NON-COVERED-DAYS-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1653-DRG], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-DISCHARGE-DT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1511-DISCHARGE-HOUR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1704-DISCHARGE-STATUS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-LOS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1519-CAT-OF-SERVICE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-4684-DISC-CATEGORY], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-TARGETED-SVC-CODE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1097-CLAIM-SOURCE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-DAYS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-OUTLIER-DAYS-N], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-AMT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1668-OUTLIER-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1130-MAN-PRICE-DOC-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ON-FILE-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ELIGIBLE-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1495-INFANT-NEWBORN-IND], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-6001-PA-NUMBER], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1017-DT-RECEIVED], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-TYPE-OF-ASSISTANCE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1096-LCHANGE-OP-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-1], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-1], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-2], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-2], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-3], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-3], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-REV-TABLE-CNTR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVENUE-TABLE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1714-REVENUE-CODE(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS-SIGN(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TBL-CNTR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TABLE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1715-VALUE-CODE(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1543-VALUE-AMOUNT(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL-CNTR], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1061-ERROR-RSN(1)], ''))), ':') 
                                                                 + CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-1216-PRIN-DIAG-CODE], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-PRIN-PROC-CODE], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ANCILLARY-RATE], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROCEDURE-CODE], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1218-PROC-CD], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-MP-EOC], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3-SIGN], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-QUAL], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-NPI], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-QUAL], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-NPI], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-QUAL], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-NPI], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1508-PAT-ACCT-NO], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAR-IND], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1532-MEDICAL-RECORD-NO], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-ICD-INDICATOR], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1517-PRIN-PROC-DT], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-1], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-2], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-3], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-2783-NETWORK-ID], ''))), ':', 
                                                                          RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILLER-01], '')))))), 2)) , 
                        b.H_Claims_RK , 
                        a.[CL-EXT-FILE-IND] , 
                        a.[CL-EXT-0003-SITE-ID] , 
                        a.[CL-EXT-1001-CLAIM-NUMBER] , 
                        a.[CL-EXT-1415-RELATIONSHIP] , 
                        a.[CL-EXT-3017-MBR-FAMLY-LINK] , 
                        a.[CL-EXT-3816-MEDICAL-GRP] , 
                        a.[CL-EXT-3113-PCP-ID] , 
                        a.[CL-EXT-3808-PC-MG-ID] , 
                        a.[CL-EXT-SERV-MGCT] , 
                        a.[CL-EXT-4302-EMPL-GROUP-ID] , 
                        a.[    CL-EXT-EMP-GRP1] , 
                        a.[    FILLER] , 
                        a.[CL-EXT-4332-LOB] , 
                        a.[CL-EXT-4428-MBR-ORIGIN] , 
                        a.[CL-EXT-2616-REIMBURSE-IND] , 
                        a.[CL-EXT-4173-BENSET-ID] , 
                        a.[CL-EXT-1206-TYPE-OF-SERVICE] , 
                        a.[CL-EXT-1207-PLACE-OF-SERVICE] , 
                        a.[CL-EXT-BEG-DOS] , 
                        a.[CL-EXT-END-DOS] , 
                        a.[CL-EXT-2045-OUT-OF-PLAN-IND] , 
                        a.[CL-EXT-1208-PRIMARY-DIAG-CODE] , 
                        a.[CL-EXT-1211-SECOND-DIAG-CODE] , 
                        a.[CL-EXT-1218-PROC-CODE] , 
                        a.[CL-EXT-1219-PROC-MODIFY] , 
                        a.[CL-EXT-4508-ANESTHESIA-UNITS] , 
                        a.[CL-EXT-4508-ANESTHESIA-SIGN] , 
                        a.[CL-EXT-6003-REC-TYPE] , 
                        a.[CL-EXT-1721-ADMIT-SOURCE] , 
                        a.[CL-EXT-1531-ADMIT-TYPE] , 
                        a.[CL-EXT-1503-ADMIT-DT] , 
                        a.[CL-EXT-1510-ADMIT-HOUR] , 
                        a.[CL-EXT-1513-ATTEND-PHYSICIAN] , 
                        a.[CL-EXT-1481-OTHER-PHYSICIAN] , 
                        a.[CL-EXT-1700-BILL-TYPE] , 
                        a.[CL-EXT-1445-BIRTH-WEIGHT] , 
                        a.[CL-EXT-1512-COVERED-DAYS] , 
                        a.[    CL-EXT-1512-COVERED-DAYS-N] , 
                        a.[CL-EXT-1430-NON-COVERED-DAYS] , 
                        a.[    CL-EXT-1430-NON-COVERED-DAYS-N] , 
                        a.[CL-EXT-1653-DRG] , 
                        a.[CL-EXT-DISCHARGE-DT] , 
                        a.[CL-EXT-1511-DISCHARGE-HOUR] , 
                        a.[CL-EXT-1704-DISCHARGE-STATUS] , 
                        a.[CL-EXT-LOS] , 
                        a.[CL-EXT-1519-CAT-OF-SERVICE] , 
                        a.[CL-EXT-4684-DISC-CATEGORY] , 
                        a.[CL-EXT-TARGETED-SVC-CODE] , 
                        a.[CL-EXT-1097-CLAIM-SOURCE] , 
                        a.[CL-EXT-OUTLIER-DAYS] , 
                        a.[    CL-EXT-OUTLIER-DAYS-N] , 
                        a.[CL-EXT-OUTLIER-AMT] , 
                        a.[CL-EXT-1668-OUTLIER-TYPE] , 
                        a.[CL-EXT-1130-MAN-PRICE-DOC-IND] , 
                        a.[CL-EXT-MEMBER-ON-FILE-IND] , 
                        a.[CL-EXT-MEMBER-ELIGIBLE-IND] , 
                        a.[CL-EXT-1495-INFANT-NEWBORN-IND] , 
                        a.[CL-EXT-6001-PA-NUMBER] , 
                        a.[CL-EXT-1017-DT-RECEIVED] , 
                        a.[CL-EXT-TYPE-OF-ASSISTANCE] , 
                        a.[CL-EXT-1096-LCHANGE-OP-ID] , 
                        a.[CL-EXT-1539-EST-AMOUNT-DUE-1] , 
                        a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN] , 
                        a.[CL-EXT-1717-EMPLOY-STATUS-CD-1] , 
                        a.[CL-EXT-1539-EST-AMOUNT-DUE-2] , 
                        a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN] , 
                        a.[CL-EXT-1717-EMPLOY-STATUS-CD-2] , 
                        a.[CL-EXT-1539-EST-AMOUNT-DUE-3] , 
                        a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN] , 
                        a.[CL-EXT-1717-EMPLOY-STATUS-CD-3] , 
                        a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES] , 
                        a.[CL-EXT-REV-TABLE-CNTR] , 
                        a.[CL-EXT-REVENUE-TABLE] , 
                        a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES] , 
                        a.[    CL-EXT-1714-REVENUE-CODE(1)] , 
                        a.[    CL-EXT-REVENUE-UNITS(1)] , 
                        a.[    CL-EXT-REVENUE-UNITS-SIGN(1)] , 
                        a.[    CL-EXT-REVENUE-CHARGES(1)] , 
                        a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)] , 
                        a.[    CL-EXT-REVENUE-ADJUD-AMT(1)] , 
                        a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)] , 
                        a.[CL-EXT-VALUE-TBL-CNTR] , 
                        a.[CL-EXT-VALUE-TABLE] , 
                        a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES] , 
                        a.[    CL-EXT-1715-VALUE-CODE(1)] , 
                        a.[    CL-EXT-1543-VALUE-AMOUNT(1)] , 
                        a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)] , 
                        a.[CL-EXT-ERROR-TBL-CNTR] , 
                        a.[CL-EXT-ERROR-TABLE] , 
                        a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE] , 
                        a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES] , 
                        a.[    CL-EXT-1061-ERROR-RSN(1)] , 
                        a.[CL-EXT-1216-PRIN-DIAG-CODE] , 
                        a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES] , 
                        a.[CL-EXT-1506-PRIN-PROC-CODE] , 
                        a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES] , 
                        a.[CL-EXT-ANCILLARY-RATE] , 
                        a.[CL-EXT-1218-PROCEDURE-CODE] , 
                        a.[    CL-EXT-1218-PROC-CD] , 
                        a.[    CL-EXT-1219-MODIFIER] , 
                        a.[    CL-EXT-1219-MODIFIER-2] , 
                        a.[CL-EXT-PAYMT-STATUS-1] , 
                        a.[CL-EXT-PAYMT-DATE-1] , 
                        a.[CL-EXT-CHECK-NUM-1] , 
                        a.[CL-EXT-BILLED-AMT-1] , 
                        a.[CL-EXT-BILLED-AMT-1-SIGN] , 
                        a.[CL-EXT-PAID-AMT-1] , 
                        a.[CL-EXT-PAID-AMT-1-SIGN] , 
                        a.[CL-EXT-ADJUD-AMT-1] , 
                        a.[CL-EXT-ADJUD-AMT-1-SIGN] , 
                        a.[CL-EXT-UNITS-1] , 
                        a.[    CL-EXT-UNITS-N-1] , 
                        a.[CL-EXT-FFS-OR-CAP-IND-1] , 
                        a.[CL-EXT-AMOUNT-APPROVED-1] , 
                        a.[CL-EXT-AMT-APPROVED-1-SIGN] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-1] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-1] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-1] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN] , 
                        a.[CL-EXT-1222-CPT4-AMOUNT-1] , 
                        a.[CL-EXT-1222-CPT4-AMT-1-SIGN] , 
                        a.[CL-EXT-PAYMT-STATUS-2] , 
                        a.[CL-EXT-PAYMT-DATE-2] , 
                        a.[CL-EXT-CHECK-NUM-2] , 
                        a.[CL-EXT-BILLED-AMT-2] , 
                        a.[CL-EXT-BILLED-AMT-2-SIGN] , 
                        a.[CL-EXT-PAID-AMT-2] , 
                        a.[CL-EXT-PAID-AMT-2-SIGN] , 
                        a.[CL-EXT-ADJUD-AMT-2] , 
                        a.[CL-EXT-ADJUD-AMT-2-SIGN] , 
                        a.[CL-EXT-UNITS-2] , 
                        a.[    CL-EXT-UNITS-N-2] , 
                        a.[CL-EXT-FFS-OR-CAP-IND-2] , 
                        a.[CL-EXT-AMOUNT-APPROVED-2] , 
                        a.[CL-EXT-AMT-APPROVED-2-SIGN] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-2] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-2] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-2] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN] , 
                        a.[CL-EXT-1222-CPT4-AMOUNT-2] , 
                        a.[CL-EXT-1222-CPT4-AMT-2-SIGN] , 
                        a.[CL-EXT-PAYMT-STATUS-3] , 
                        a.[CL-EXT-PAYMT-DATE-3] , 
                        a.[CL-EXT-CHECK-NUM-3] , 
                        a.[CL-EXT-BILLED-AMT-3] , 
                        a.[CL-EXT-BILLED-AMT-3-SIGN] , 
                        a.[CL-EXT-PAID-AMT-3] , 
                        a.[CL-EXT-PAID-AMT-3-SIGN] , 
                        a.[CL-EXT-ADJUD-AMT-3] , 
                        a.[CL-EXT-ADJUD-AMT-3-SIGN] , 
                        a.[CL-EXT-UNITS-3] , 
                        a.[    CL-EXT-UNITS-N-3] , 
                        a.[CL-EXT-FFS-OR-CAP-IND-3] , 
                        a.[CL-EXT-AMOUNT-APPROVED-3] , 
                        a.[CL-EXT-AMT-APPROVED-3-SIGN] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-3] , 
                        a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-3] , 
                        a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-3] , 
                        a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN] , 
                        a.[CL-EXT-1222-CPT4-AMOUNT-3] , 
                        a.[CL-EXT-1222-CPT4-AMT-3-SIGN] , 
                        a.[CL-EXT-MP-EOC] , 
                        a.[CL-EXT-INTEREST-1] , 
                        a.[CL-EXT-INTEREST-1-SIGN] , 
                        a.[CL-EXT-INTEREST-2] , 
                        a.[CL-EXT-INTEREST-2-SIGN] , 
                        a.[CL-EXT-INTEREST-3] , 
                        a.[CL-EXT-INTEREST-3-SIGN] , 
                        a.[CL-EXT-CHECK-ACCT-1] , 
                        a.[CL-EXT-CHECK-ACCT-2] , 
                        a.[CL-EXT-CHECK-ACCT-3] , 
                        a.[CL-EXT-1027-PROV-REF-QUAL] , 
                        a.[CL-EXT-1027-PROV-REF-NPI] , 
                        a.[CL-EXT-0506-PROV-AFF-QUAL] , 
                        a.[CL-EXT-0506-PROV-AFF-NPI] , 
                        a.[CL-EXT-9999-PROV-BILL-QUAL] , 
                        a.[CL-EXT-9999-PROV-BILL-NPI] , 
                        a.[CL-EXT-1508-PAT-ACCT-NO] , 
                        a.[CL-EXT-PAR-IND] , 
                        a.[CL-EXT-1532-MEDICAL-RECORD-NO] , 
                        a.[CL-EXT-9999-ICD-INDICATOR] , 
                        a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES] , 
                        a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES] , 
                        a.[CL-EXT-1517-PRIN-PROC-DT] , 
                        a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES] , 
                        a.[CL-EXT-1039-OTHER-INS-PAID-1] , 
                        a.[CL-EXT-1039-OTHER-INS-PAID-2] , 
                        a.[CL-EXT-1039-OTHER-INS-PAID-3] , 
                        a.[CL-EXT-1056-DEDUCTIBLE-1] , 
                        a.[CL-EXT-1056-DEDUCTIBLE-2] , 
                        a.[CL-EXT-1056-DEDUCTIBLE-3] , 
                        a.[CL-EXT-1040-CO-PAY-1] , 
                        a.[CL-EXT-1040-CO-PAY-2] , 
                        a.[CL-EXT-1040-CO-PAY-3] , 
                        a.[CL-EXT-1047-COINS-AMOUNT-1] , 
                        a.[CL-EXT-1047-COINS-AMOUNT-2] , 
                        a.[CL-EXT-1047-COINS-AMOUNT-3] , 
                        a.[CL-EXT-1057-DISCT-AMOUNT-1] , 
                        a.[CL-EXT-1057-DISCT-AMOUNT-2] , 
                        a.[CL-EXT-1057-DISCT-AMOUNT-3] , 
                        a.[CL-EXT-1224-WITHHOLD-1] , 
                        a.[CL-EXT-1224-WITHHOLD-2] , 
                        a.[CL-EXT-1224-WITHHOLD-3] , 
                        a.[CL-EXT-1231-COB-PAYOUT-AMT-1] , 
                        a.[CL-EXT-1231-COB-PAYOUT-AMT-2] , 
                        a.[CL-EXT-1231-COB-PAYOUT-AMT-3] , 
                        a.[CL-EXT-2783-NETWORK-ID] , 
                        a.[CL-EXT-FILLER-01] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-0003-SITE-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1001-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1415-RELATIONSHIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3017-MBR-FAMLY-LINK], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3816-MEDICAL-GRP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3113-PCP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3808-PC-MG-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-SERV-MGCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4302-EMPL-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-EMP-GRP1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    FILLER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4332-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4428-MBR-ORIGIN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2616-REIMBURSE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4173-BENSET-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1206-TYPE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1207-PLACE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-BEG-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-END-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2045-OUT-OF-PLAN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-PRIMARY-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1211-SECOND-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1219-PROC-MODIFY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-UNITS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6003-REC-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1721-ADMIT-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1531-ADMIT-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1503-ADMIT-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1510-ADMIT-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1513-ATTEND-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1481-OTHER-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1700-BILL-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1445-BIRTH-WEIGHT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1512-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1512-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1430-NON-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1430-NON-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1653-DRG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-DISCHARGE-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1511-DISCHARGE-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1704-DISCHARGE-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-LOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1519-CAT-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4684-DISC-CATEGORY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TARGETED-SVC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1097-CLAIM-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-OUTLIER-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1668-OUTLIER-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1130-MAN-PRICE-DOC-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ON-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ELIGIBLE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1495-INFANT-NEWBORN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6001-PA-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1017-DT-RECEIVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TYPE-OF-ASSISTANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1096-LCHANGE-OP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REV-TABLE-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVENUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1714-REVENUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1715-VALUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1543-VALUE-AMOUNT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1061-ERROR-RSN(1)], ''))), ':') 
                                                                + CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-1216-PRIN-DIAG-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-PRIN-PROC-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ANCILLARY-RATE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROCEDURE-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1218-PROC-CD], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-MP-EOC], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1508-PAT-ACCT-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAR-IND], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1532-MEDICAL-RECORD-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-ICD-INDICATOR], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1517-PRIN-PROC-DT], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-2783-NETWORK-ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILLER-01], '')))))), 2)); 
 
	 
						 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_GNClaims160807Details 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_GNClaims160807Details z 
                                  WHERE     z.H_Claims_RK = a.H_Claims_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_GNClaims160807Details a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_GNClaims160807Details' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_GNClaims160807Details' , 
                      GETDATE() 
                    ); 
 
 
 
                 /*INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        'GNClaims_160807' 
                FROM    CHSStaging.[dbo].GNClaims_160807Parsed 
				*/ 
     
 
--Load History Table for S_GNClaims160807Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_GNClaims160807Details' 
                        ) , 
                     UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriClaimsID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-0003-SITE-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1001-CLAIM-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1415-RELATIONSHIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3017-MBR-FAMLY-LINK], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3816-MEDICAL-GRP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3113-PCP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3808-PC-MG-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-SERV-MGCT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4302-EMPL-GROUP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-EMP-GRP1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    FILLER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4332-LOB], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4428-MBR-ORIGIN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2616-REIMBURSE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4173-BENSET-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1206-TYPE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1207-PLACE-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-BEG-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-END-DOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2045-OUT-OF-PLAN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-PRIMARY-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1211-SECOND-DIAG-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1219-PROC-MODIFY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-UNITS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4508-ANESTHESIA-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6003-REC-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1721-ADMIT-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1531-ADMIT-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1503-ADMIT-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1510-ADMIT-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1513-ATTEND-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1481-OTHER-PHYSICIAN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1700-BILL-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1445-BIRTH-WEIGHT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1512-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1512-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1430-NON-COVERED-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1430-NON-COVERED-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1653-DRG], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-DISCHARGE-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1511-DISCHARGE-HOUR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1704-DISCHARGE-STATUS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-LOS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1519-CAT-OF-SERVICE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-4684-DISC-CATEGORY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TARGETED-SVC-CODE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1097-CLAIM-SOURCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-DAYS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-OUTLIER-DAYS-N], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-OUTLIER-AMT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1668-OUTLIER-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1130-MAN-PRICE-DOC-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ON-FILE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-MEMBER-ELIGIBLE-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1495-INFANT-NEWBORN-IND], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-6001-PA-NUMBER], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1017-DT-RECEIVED], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-TYPE-OF-ASSISTANCE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1096-LCHANGE-OP-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-1-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-2-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMOUNT-DUE-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1539-EST-AMT-DUE-3-SIGN], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1717-EMPLOY-STATUS-CD-3], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1709-OCCURANCE-CODE(1) OCCURS 20 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REV-TABLE-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVENUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REV-TBL(1) OCCURS 99 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1714-REVENUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-UNITS-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-CHARGES-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-REVENUE-ADJUD-AMT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-VALUE-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-TBL(1) OCCURS 36 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1715-VALUE-CODE(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1543-VALUE-AMOUNT(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-VALUE-AMOUNT-SIGN(1)], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL-CNTR], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL REDEFINES CL-EXT-ERROR-TABLE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-ERROR-TBL(1) OCCURS 15 TIMES], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1061-ERROR-RSN(1)], ''))), ':') 
                                                                + CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-1216-PRIN-DIAG-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1208-ICD9-DIAG-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-PRIN-PROC-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1506-ICD9-PROC-CODE(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ANCILLARY-RATE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1218-PROCEDURE-CODE], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1218-PROC-CD], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-1219-MODIFIER-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-STATUS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAYMT-DATE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-NUM-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-BILLED-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAID-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ADJUD-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-UNITS-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[    CL-EXT-UNITS-N-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FFS-OR-CAP-IND-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMOUNT-APPROVED-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-AMT-APPROVED-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-REVIEWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ALLOWED-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-ENCOUNTER-AMOUNT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1222-CPT4-AMT-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-MP-EOC], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-1-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-2-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-INTEREST-3-SIGN], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-CHECK-ACCT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1027-PROV-REF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-0506-PROV-AFF-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-QUAL], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-PROV-BILL-NPI], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1508-PAT-ACCT-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-PAR-IND], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1532-MEDICAL-RECORD-NO], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-9999-ICD-INDICATOR], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1701-CONDITION-CODE(1) OCCURS 30 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1541-OCCURANCE-DT(1) OCCURS 20 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1517-PRIN-PROC-DT], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1435-ICD9-PROC-DT(1) OCCURS 14 TIMES], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1039-OTHER-INS-PAID-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1056-DEDUCTIBLE-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1040-CO-PAY-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1047-COINS-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1057-DISCT-AMOUNT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1224-WITHHOLD-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-1], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-2], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-1231-COB-PAYOUT-AMT-3], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-2783-NETWORK-ID], ''))), ':', 
                                                                         RTRIM(LTRIM(COALESCE(a.[CL-EXT-FILLER-01], '')))))), 2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = 'GNClaims_160807' 
                        ) 
     FROM    CHSStaging.dbo.GNClaims_160807Parsed a 
                        INNER JOIN dbo.H_Claims b ON a.CentauriClaimsID = b.Claims_BK 
 
-- S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  
-- S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  
-- S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  
-- S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  S_Member160807Details **  
 
        INSERT  INTO dbo.S_Member160807Details 
                ( S_Member160807Details_RK , 
                  LoadDate , 
                  H_Member_RK , 
                  [CL-EXT-3001-MEMBER-ID] , 
                  [CL-EXT-3005-MBR-NAME] , 
                  [    CL-EXT-3005-MBR-LAST-NAME] , 
                  [    CL-EXT-3005-MBR-FIRST-NAME] , 
                  [    CL-EXT-3005-MBR-INIT] , 
                  [CL-EXT-3006-MBR-ADDRESS] , 
                  [    CL-EXT-MBR-3006-ADDR-LINE1] , 
                  [    CL-EXT-MBR-3006-ADDR-LINE2] , 
                  [    CL-EXT-3008-MBR-CITY] , 
                  [    CL-EXT-3009-MBR-STATE] , 
                  [    CL-EXT-3010-MBR-ZIP] , 
                  [      CL-EXT-3010-MBR-ZIP5] , 
                  [      CL-EXT-3010-MBR-ZIP4] , 
                  [CL-EXT-1016-BIRTH-DT] , 
                  [CL-EXT-1018-SEX] , 
                  HashDiff , 
                  RecordSource , 
                  RecordEndDate 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3001-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3005-MBR-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-INIT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3006-MBR-ADDRESS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3008-MBR-CITY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3009-MBR-STATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3010-MBR-ZIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1016-BIRTH-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1018-SEX], '')))))), 2)) , 
                        GETDATE() , 
                        b.H_Member_RK , 
                        a.[CL-EXT-3001-MEMBER-ID] , 
                        a.[CL-EXT-3005-MBR-NAME] , 
                        a.[    CL-EXT-3005-MBR-LAST-NAME] , 
                        a.[    CL-EXT-3005-MBR-FIRST-NAME] , 
                        a.[    CL-EXT-3005-MBR-INIT] , 
                        a.[CL-EXT-3006-MBR-ADDRESS] , 
                        a.[    CL-EXT-MBR-3006-ADDR-LINE1] , 
                        a.[    CL-EXT-MBR-3006-ADDR-LINE2] , 
                        a.[    CL-EXT-3008-MBR-CITY] , 
                        a.[    CL-EXT-3009-MBR-STATE] , 
                        a.[    CL-EXT-3010-MBR-ZIP] , 
                        a.[      CL-EXT-3010-MBR-ZIP5] , 
                        a.[      CL-EXT-3010-MBR-ZIP4] , 
                        a.[CL-EXT-1016-BIRTH-DT] , 
                        a.[CL-EXT-1018-SEX] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-3001-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3005-MBR-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-INIT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3006-MBR-ADDRESS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3008-MBR-CITY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3009-MBR-STATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3010-MBR-ZIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1016-BIRTH-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1018-SEX], '')))))), 2)) , 
                        'CHSStaging.dbo.GNClaims_160807' , 
                        NULL 
                FROM    CHSStaging.dbo.GNClaims_160807Parsed a 
                        INNER JOIN dbo.H_Member b ON a.CentauriMemberID = b.Member_BK 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-3001-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3005-MBR-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-INIT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3006-MBR-ADDRESS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3008-MBR-CITY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3009-MBR-STATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3010-MBR-ZIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1016-BIRTH-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1018-SEX], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_Member160807Details 
                        WHERE   H_Member_RK = b.H_Member_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3001-MEMBER-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3005-MBR-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-LAST-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-FIRST-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-INIT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-3006-MBR-ADDRESS], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE1], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE2], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3008-MBR-CITY], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3009-MBR-STATE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3010-MBR-ZIP], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP5], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP4], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1016-BIRTH-DT], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-1018-SEX], '')))))), 2)) , 
                        b.H_Member_RK , 
                        a.[CL-EXT-3001-MEMBER-ID] , 
                        a.[CL-EXT-3005-MBR-NAME] , 
                        a.[    CL-EXT-3005-MBR-LAST-NAME] , 
                        a.[    CL-EXT-3005-MBR-FIRST-NAME] , 
                        a.[    CL-EXT-3005-MBR-INIT] , 
                        a.[CL-EXT-3006-MBR-ADDRESS] , 
                        a.[    CL-EXT-MBR-3006-ADDR-LINE1] , 
                        a.[    CL-EXT-MBR-3006-ADDR-LINE2] , 
                        a.[    CL-EXT-3008-MBR-CITY] , 
                        a.[    CL-EXT-3009-MBR-STATE] , 
                        a.[    CL-EXT-3010-MBR-ZIP] , 
                        a.[      CL-EXT-3010-MBR-ZIP5] , 
                        a.[      CL-EXT-3010-MBR-ZIP4] , 
                        a.[CL-EXT-1016-BIRTH-DT] , 
                        a.[CL-EXT-1018-SEX] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-3001-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3005-MBR-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-INIT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3006-MBR-ADDRESS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3008-MBR-CITY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3009-MBR-STATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3010-MBR-ZIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1016-BIRTH-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1018-SEX], '')))))), 2)); 
 
 
--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_Member160807Details 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_Member160807Details z 
                                  WHERE     z.H_Member_RK = a.H_Member_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_Member160807Details a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_Member160807Details' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_Member160807Details' , 
                      GETDATE() 
                    ); 
 
 
 
                 /*INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        'GNClaims_160807' 
                FROM    CHSStaging.[dbo].GNClaims_160807Parsed 
				*/ 
     
 
--Load History Table for S_GNClaims160807Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_Member160807Details' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3001-MEMBER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3005-MBR-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3005-MBR-INIT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-3006-MBR-ADDRESS], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE1], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-MBR-3006-ADDR-LINE2], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3008-MBR-CITY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3009-MBR-STATE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-3010-MBR-ZIP], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP5], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[      CL-EXT-3010-MBR-ZIP4], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1016-BIRTH-DT], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-1018-SEX], '')))))), 2))  , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = 'GNClaims_160807' 
                        ) 
                 FROM    CHSStaging.dbo.GNClaims_160807Parsed a 
                        INNER JOIN dbo.H_Member b ON a.CentauriMemberID = b.Member_BK 
					 
 
 
 
					 
-- S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  
-- S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  
-- S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  
-- S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  S_Provider160807Details **  
 
        INSERT  INTO dbo.S_Provider160807Details 
                ( S_Provider160807Details_RK , 
                  LoadDate , 
                  H_Provider_RK , 
                  [CL-EXT-2001-PROVIDER-ID] , 
                  [CL-EXT-2003-PROV-NAME] , 
                  [    CL-EXT-PROV-LAST-NAME] , 
                  [    CL-EXT-PROV-FIRST-NAME] , 
                  [CL-EXT-2712-PROV-SPECIALTY] , 
                  [CL-EXT-2615-PROV-TYPE] , 
                  [CL-EXT-2001-PROV-ID-QUAL] , 
                  [CL-EXT-2001-PROV-NPI] , 
                  HashDiff , 
                  RecordSource , 
                  RecordEndDate 
                ) 
                SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2003-PROV-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2712-PROV-SPECIALTY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2615-PROV-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-ID-QUAL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-NPI], '')))))), 2)) , 
                        GETDATE() , 
                        b.H_Provider_RK , 
                        a.[CL-EXT-2001-PROVIDER-ID] , 
                        a.[CL-EXT-2003-PROV-NAME] , 
                        a.[    CL-EXT-PROV-LAST-NAME] , 
                        a.[    CL-EXT-PROV-FIRST-NAME] , 
                        a.[CL-EXT-2712-PROV-SPECIALTY] , 
                        a.[CL-EXT-2615-PROV-TYPE] , 
                        a.[CL-EXT-2001-PROV-ID-QUAL] , 
                        [CL-EXT-2001-PROV-NPI] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2003-PROV-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2712-PROV-SPECIALTY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2615-PROV-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-ID-QUAL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-NPI], '')))))), 2)) , 
                        'CHSStaging.dbo.GNClaims_160807' , 
                        NULL 
                FROM    CHSStaging.dbo.GNClaims_160807Parsed a 
                        INNER JOIN dbo.H_Provider b ON a.CentauriProviderID = b.Provider_BK 
                WHERE   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2003-PROV-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2712-PROV-SPECIALTY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2615-PROV-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-ID-QUAL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-NPI], '')))))), 2)) NOT IN ( 
                        SELECT  HashDiff 
                        FROM    dbo.S_Provider160807Details 
                        WHERE   H_Provider_RK = b.H_Provider_RK ) 
                GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                           UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROVIDER-ID], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2003-PROV-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-LAST-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-FIRST-NAME], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2712-PROV-SPECIALTY], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2615-PROV-TYPE], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-ID-QUAL], ''))), ':', 
                                                                        RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-NPI], '')))))), 2)) , 
                        b.H_Provider_RK , 
                        a.[CL-EXT-2001-PROVIDER-ID] , 
                        a.[CL-EXT-2003-PROV-NAME] , 
                        a.[    CL-EXT-PROV-LAST-NAME] , 
                        a.[    CL-EXT-PROV-FIRST-NAME] , 
                        a.[CL-EXT-2712-PROV-SPECIALTY] , 
                        a.[CL-EXT-2615-PROV-TYPE] , 
                        a.[CL-EXT-2001-PROV-ID-QUAL] , 
                        [CL-EXT-2001-PROV-NPI] , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2003-PROV-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2712-PROV-SPECIALTY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2615-PROV-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-ID-QUAL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-NPI], '')))))), 2)); 
 
 
--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_Provider160807Details 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_Provider160807Details z 
                                  WHERE     z.H_Provider_RK = a.H_Provider_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_Provider160807Details a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_Provider160807Details' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_Provider160807Details' , 
                      GETDATE() 
                    ); 
 
 
 
                 /*INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        'GNClaims_160807' 
                FROM    CHSStaging.[dbo].GNClaims_160807Parsed 
				*/ 
     
 
--Load History Table for S_GNClaims160807Details 
 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_Provider160807Details' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
                                                          UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriProviderID, ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROVIDER-ID], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2003-PROV-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-LAST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[    CL-EXT-PROV-FIRST-NAME], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2712-PROV-SPECIALTY], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2615-PROV-TYPE], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-ID-QUAL], ''))), ':', 
                                                                       RTRIM(LTRIM(COALESCE(a.[CL-EXT-2001-PROV-NPI], '')))))), 2)), 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = 'GNClaims_160807' 
                        ) 
              FROM    CHSStaging.dbo.GNClaims_160807Parsed a 
                        INNER JOIN dbo.H_Provider b ON a.CentauriProviderID = b.Provider_BK 
 
 
-- GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  
-- GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  
-- GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  
-- GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  GuildNet_GNClaimRpt **  
        --DECLARE @LoadDate DATETIME; 
        --SET @LoadDate = GETDATE(); 
 
 
INSERT INTO dbo.S_GNClaimRptDetails 
        ( S_GNClaimRptDetails_RK , 
          LoadDate , 
          H_PharmacyClaim_RK , 
          [RECORD IND] , 
          [CLAIM NO] , 
          [CLAIM TYPE] , 
          [RX TRAN TYPE] , 
          [RX NO] , 
          [REFILL NO] , 
          [PROCESS DATE] , 
          [RETRO LICS CODE] , 
          [ORIG DISP DATE] , 
          [COMPOUND FLAG] , 
          [EMPL GRP ID] , 
          [BEN PLAN ID] , 
          [CATEGORY CODE] , 
          [RIDER CODE] , 
          [PRIOR APP CODE] , 
          [NDC NO] , 
          [RX FILL DATE] , 
          [RX QTY] , 
          [NO OF DAYS SUPPL] , 
          [DRUG NAME] , 
          [CLAIM AMT] , 
          [REJECT CODE1] , 
          [REJECT CODE2] , 
          [PRC IND     ] , 
          [ORIG CLAIM AMT] , 
          [PRV ID] , 
          [PRV LOC] , 
          [ING COST CLAIM AMT] , 
          [ING COST PAID AMT] , 
          [COPAY AMT] , 
          REGION , 
          [END OF CYCLE DATE] , 
          [PRESCR DATE] , 
          [REDUCED CLAIM CAP AMT] , 
          [COINS CLAIM AMT] , 
          [DAW IND] , 
          [CLAIM DEDUCT AMT] , 
          [CLAIM NTWK CODE] , 
          [CLAIM FEE SUBMITTED AMT] , 
          [CLAIM FEE APPROVED AMT] , 
          LOB , 
          [ADJUD RIDER] , 
          [PLAN INDICATOR] , 
          [CLAIM ADMIN FEE AMT] , 
          [FORMULARY IND] , 
          [PREV MBR ID] , 
          [CLAIM SITE ID] , 
          [PIN NO] , 
          [AHFS CODE] , 
          [GCN CODE] , 
          [GPI CODE] , 
          [GC3 CODE] , 
          [STEP THER IND] , 
          [GRP DRUG NAME] , 
          [GENERIC NAME] , 
          [ORIGIN CODE] , 
          [EXP GRP NO] , 
          [GL BATCHID] , 
          [WAC AMT] , 
          [MAC AMT] , 
          [AWP AMT] , 
          [REV CLAIM NO] , 
          [DRUG TIER IND] , 
          [NDC DRUG ID] , 
          [COB FLAG] , 
          [COB AMT] , 
          [FULL RX NO] , 
          [SALES TAX AMT] , 
          [GPI IND] , 
          [BILL DATE] , 
          [RELATIONSHIP CODE] , 
          [DEPENDENT CODE] , 
          [DOB DEFAULT IND] , 
          [PATIENT LOC] , 
          [SUBMITTED DOB] , 
          [SUBMITTED GENDER] , 
          [PAYEE NAME] , 
          [PAYEE ADDR] , 
          [PAYEE CITY] , 
          [PAYEE STATE] , 
          [PAYEE ZIP] , 
          [PAYEE ZIP EXT] , 
          [PLAN TYPE] , 
          [MASTER GRP NO] , 
          [ESI GRP NO] , 
          [GRP NAME] , 
          [SUB LAST NAME] , 
          [SUB FIRST NAME] , 
          SUB_MIDDLE_NAME , 
          [SUB DOB] , 
          [SUB ADDR] , 
          [SUB CITY] , 
          SUB_STATE , 
          [SUB ZIP] , 
          [SUB ZIP EXT] , 
          [SUB GENDER] , 
          [PRESCR QUALIFIER] , 
          [PHYS NAME] , 
          [PRV CONTRACT] , 
          [CALC COPAY AMT] , 
          ANCILLARY_AMT , 
          [OUT OF POC MAX AMT] , 
          [STOP LOSS AMT] , 
          [BRAND CODE] , 
          [CONFLICT CODE1] , 
          [CONFLICT CODE2] , 
          CONFLICT_CODE3 , 
          [DUR OVERFLOW] , 
          [DUR INTERVENTION] , 
          [DUR CUSTOMER CODE] , 
          [DOSAGE CODE] , 
          [DRUG STRENGTH] , 
          [PHARM SER TYPE] , 
          [PHARM QUALIFIER] , 
          [UANDC AMT] , 
          [HRA APPL AMT] , 
          [HRA ESI FUND IND] , 
          [MAINT DRUG IND] , 
          [DRUG LEGAL STATUS] , 
          [PICA DRUG CODE] , 
          [FED DRUG CLASS CODE] , 
          [PROD TYPE] , 
          [FSA VENDOR CODE] , 
          [OTHER COVERAGE CODE] , 
          [PARTD MEDICARE DRUG] , 
          [RETRO LICS AMT] , 
          [LICS SUBSIDY AMT] , 
          [PARTB MEDICARE DRUG] , 
          [PARTB MEDICARE CLAIM] , 
          [TIER COPAY NO] , 
          [OIG FLAG] , 
          [ANDA FLAG] , 
          [CDH RESPONSE ID] , 
          [CDH ESI RESPONSE CODE] , 
          [HRA FLAG             ] , 
          [HRA SIN BOOK FLAG] , 
          [HRA REQUEST AMT] , 
          [VENDOR ID] , 
          [DED SIN BOOK FLAG] , 
          [MAX OUT OF POC SIN BK FLAG] , 
          [PL STOP LOSS SIN BK FLAG] , 
          [TDS SIN BK FLAG] , 
          [VACCINE RX TYPE] , 
          [VACCINE ADMIN AMT] , 
          [VACCINE ADMIN TYPE] , 
          [VENDOR VALUE] , 
          [ACR ADMIN FLAG] , 
          [MBR ACR AMT] , 
          [SUPP PAYER PAID AMT] , 
          [SUPP PAYER COPAY AMT] , 
          [SUPP PAYER CVG CODE] , 
          [SUPP PAYER COV DED AMT] , 
          [SUPP PAYER COV COPAY AMT] , 
          [SUPP PAYER COV ANCILLARY AMT] , 
          [SUPP PAYER COV COADD ON AMT] , 
          [PATIENT RESIDENCE] , 
          [NX IND] , 
          [PRESCR ORIG CODE] , 
          [COB RECOVERY AMT] , 
          [PRE COB BILLED CLAIM AMT] , 
          [DRUG CALC DISCOUNT AMT] , 
          [DRUG DISCOUNT EXRSN CODE] , 
          [DRUG DISCOUNT APP CODE] , 
          [DRUG DISCOUNT EL COST AMT] , 
          [PDE DELETE CODE] , 
          MI_COMPOUND_IND , 
          [MI COMPOUND COV OPT] , 
          [MI LVL OF EFFT] , 
          [MI PRF SERV FEE AMT] , 
          [MI CMPD ING CNT] , 
          [MI CMPD MEDD ELIG AMT] , 
          [MI CMPD MEDD INELIG AMT] , 
          [MI CMPD MEDD COPAY AMT] , 
          [MI CMPD MEDD PR COPAY AMT] , 
          [MI CMPD MEDD PAID AMT] , 
          [MI CMPD MEDD EL PLN AMT] , 
          [MI CMPD MEDD EL COST AMT] , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
SELECT  UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.centauripharmacyclaimid,''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RECORD IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RX TRAN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[REFILL NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROCESS DATE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RETRO LICS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG DISP DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COMPOUND FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[EMPL GRP ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[BEN PLAN ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CATEGORY CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RIDER CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRIOR APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[NDC NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX FILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX QTY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NO OF DAYS SUPPL],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REJECT CODE1],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REJECT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRC IND     ],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRV LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[COPAY AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REGION],''))),':',				RTRIM(LTRIM(COALESCE(a.[END OF CYCLE DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[REDUCED CLAIM CAP AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[COINS CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DAW IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM DEDUCT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NTWK CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE SUBMITTED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE APPROVED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[ADJUD RIDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PLAN INDICATOR],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM ADMIN FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FORMULARY IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PREV MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM SITE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[PIN NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[AHFS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GCN CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GPI CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GC3 CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[STEP THER IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[GENERIC NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[ORIGIN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[EXP GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GL BATCHID],''))),':',				RTRIM(LTRIM(COALESCE(a.[WAC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MAC AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[AWP AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REV CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG TIER IND],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NDC DRUG ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FULL RX NO],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SALES TAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[GPI IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[BILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RELATIONSHIP CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DEPENDENT CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUBMITTED DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUBMITTED GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ADDR],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE CITY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PAYEE STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP EXT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PLAN TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MASTER GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[ESI GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP NAME],''))),':')			+ CONCAT (RTRIM(LTRIM(COALESCE(a.[SUB LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB FIRST NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_MIDDLE_NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB DOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ADDR],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB CITY],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP EXT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHYS NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV CONTRACT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CALC COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANCILLARY_AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[OUT OF POC MAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[STOP LOSS AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[BRAND CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE1],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT_CODE3],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DUR OVERFLOW],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR INTERVENTION],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR CUSTOMER CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOSAGE CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG STRENGTH],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM SER TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[UANDC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA APPL AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA ESI FUND IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAINT DRUG IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG LEGAL STATUS],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PICA DRUG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FED DRUG CLASS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROD TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FSA VENDOR CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[OTHER COVERAGE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTD MEDICARE DRUG],''))),':',				RTRIM(LTRIM(COALESCE(a.[RETRO LICS AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LICS SUBSIDY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE DRUG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE CLAIM],''))),':',				RTRIM(LTRIM(COALESCE(a.[TIER COPAY NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[OIG FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANDA FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CDH RESPONSE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CDH ESI RESPONSE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA FLAG             ],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA SIN BOOK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA REQUEST AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[DED SIN BOOK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAX OUT OF POC SIN BK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PL STOP LOSS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[TDS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE RX TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR VALUE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ACR ADMIN FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MBR ACR AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER CVG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV DED AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV ANCILLARY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COADD ON AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT RESIDENCE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NX IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR ORIG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB RECOVERY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRE COB BILLED CLAIM AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG CALC DISCOUNT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EXRSN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EL COST AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PDE DELETE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI_COMPOUND_IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI COMPOUND COV OPT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI LVL OF EFFT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI PRF SERV FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD ING CNT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD ELIG AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD INELIG AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PR COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL PLN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL COST AMT],'')))))),2)), 
				@LOADDATE, 
				b.H_PharmacyClaim_RK , 
				a.[RECORD IND],	a.[CLAIM NO],	a.[CLAIM TYPE],	a.[RX TRAN TYPE],	a.[RX NO],	a.[REFILL NO],	a.[PROCESS DATE],	 
				a.[RETRO LICS CODE],	a.[ORIG DISP DATE],	a.[COMPOUND FLAG],	a.[EMPL GRP ID],	a.[BEN PLAN ID],	a.[CATEGORY CODE],	a.[RIDER CODE],	a.[PRIOR APP CODE],	a.[NDC NO],	 
				a.[RX FILL DATE],	a.[RX QTY],	a.[NO OF DAYS SUPPL],	a.[DRUG NAME],	a.[CLAIM AMT],	a.[REJECT CODE1],	a.[REJECT CODE2],	a.[PRC IND     ],	a.[ORIG CLAIM AMT],	a.[PRV ID],	 
				a.[PRV LOC],	a.[ING COST CLAIM AMT],	a.[ING COST PAID AMT],	a.[COPAY AMT],	a.[REGION],	a.[END OF CYCLE DATE],	a.[PRESCR DATE],	a.[REDUCED CLAIM CAP AMT],	a.[COINS CLAIM AMT], 
				a.[DAW IND],	a.[CLAIM DEDUCT AMT],	a.[CLAIM NTWK CODE],	a.[CLAIM FEE SUBMITTED AMT],	a.[CLAIM FEE APPROVED AMT],	a.[LOB],	a.[ADJUD RIDER],	a.[PLAN INDICATOR], 
				a.[CLAIM ADMIN FEE AMT],	a.[FORMULARY IND],	a.[PREV MBR ID],	a.[CLAIM SITE ID],	a.[PIN NO],	a.[AHFS CODE],	a.[GCN CODE],	a.[GPI CODE],	a.[GC3 CODE],	 
				a.[STEP THER IND],	a.[GRP DRUG NAME],	a.[GENERIC NAME],	a.[ORIGIN CODE],	a.[EXP GRP NO],	a.[GL BATCHID],	a.[WAC AMT],	a.[MAC AMT],	a.[AWP AMT],	 
				a.[REV CLAIM NO],	a.[DRUG TIER IND],	a.[NDC DRUG ID],	a.[COB FLAG],	a.[COB AMT],	a.[FULL RX NO],	a.[SALES TAX AMT],	a.[GPI IND],	a.[BILL DATE],	 
				a.[RELATIONSHIP CODE],	a.[DEPENDENT CODE],	a.[DOB DEFAULT IND],	a.[PATIENT LOC],	a.[SUBMITTED DOB],	a.[SUBMITTED GENDER],	a.[PAYEE NAME],	a.[PAYEE ADDR],	 
				a.[PAYEE CITY],	a.[PAYEE STATE],	a.[PAYEE ZIP],	a.[PAYEE ZIP EXT],	a.[PLAN TYPE],	a.[MASTER GRP NO],	a.[ESI GRP NO],	a.[GRP NAME],	a.[SUB LAST NAME],	 
				a.[SUB FIRST NAME],	a.[SUB_MIDDLE_NAME],	a.[SUB DOB],	a.[SUB ADDR],	a.[SUB CITY],	a.[SUB_STATE],	a.[SUB ZIP],	a.[SUB ZIP EXT],	a.[SUB GENDER],	 
				a.[PRESCR QUALIFIER],	a.[PHYS NAME],	a.[PRV CONTRACT],	a.[CALC COPAY AMT],	a.[ANCILLARY_AMT],	a.[OUT OF POC MAX AMT],	a.[STOP LOSS AMT],	a.[BRAND CODE],	 
				a.[CONFLICT CODE1],	a.[CONFLICT CODE2],	a.[CONFLICT_CODE3],	a.[DUR OVERFLOW],	a.[DUR INTERVENTION],	a.[DUR CUSTOMER CODE],	a.[DOSAGE CODE],	a.[DRUG STRENGTH],	 
				a.[PHARM SER TYPE],	a.[PHARM QUALIFIER],	a.[UANDC AMT],	a.[HRA APPL AMT],	a.[HRA ESI FUND IND],	a.[MAINT DRUG IND],	a.[DRUG LEGAL STATUS],	a.[PICA DRUG CODE],	 
				a.[FED DRUG CLASS CODE],	a.[PROD TYPE],	a.[FSA VENDOR CODE],	a.[OTHER COVERAGE CODE],	a.[PARTD MEDICARE DRUG],	a.[RETRO LICS AMT],	a.[LICS SUBSIDY AMT],	 
				a.[PARTB MEDICARE DRUG],	a.[PARTB MEDICARE CLAIM],	a.[TIER COPAY NO],	a.[OIG FLAG],	a.[ANDA FLAG],	a.[CDH RESPONSE ID],	a.[CDH ESI RESPONSE CODE],	 
				a.[HRA FLAG             ],	a.[HRA SIN BOOK FLAG],	a.[HRA REQUEST AMT],	a.[VENDOR ID],	a.[DED SIN BOOK FLAG],	a.[MAX OUT OF POC SIN BK FLAG],	a.[PL STOP LOSS SIN BK FLAG], 
				a.[TDS SIN BK FLAG],	a.[VACCINE RX TYPE],	a.[VACCINE ADMIN AMT],	a.[VACCINE ADMIN TYPE],	a.[VENDOR VALUE],	a.[ACR ADMIN FLAG],	a.[MBR ACR AMT],	 
				a.[SUPP PAYER PAID AMT],	a.[SUPP PAYER COPAY AMT],	a.[SUPP PAYER CVG CODE],	a.[SUPP PAYER COV DED AMT],	a.[SUPP PAYER COV COPAY AMT],	 
				a.[SUPP PAYER COV ANCILLARY AMT],	a.[SUPP PAYER COV COADD ON AMT],	a.[PATIENT RESIDENCE],	a.[NX IND],	a.[PRESCR ORIG CODE],	a.[COB RECOVERY AMT],	 
				a.[PRE COB BILLED CLAIM AMT],	a.[DRUG CALC DISCOUNT AMT],	a.[DRUG DISCOUNT EXRSN CODE],	a.[DRUG DISCOUNT APP CODE],	a.[DRUG DISCOUNT EL COST AMT],	 
				a.[PDE DELETE CODE],	a.[MI_COMPOUND_IND],	a.[MI COMPOUND COV OPT],	a.[MI LVL OF EFFT],	a.[MI PRF SERV FEE AMT],	a.[MI CMPD ING CNT],	a.[MI CMPD MEDD ELIG AMT],	 
				a.[MI CMPD MEDD INELIG AMT],	a.[MI CMPD MEDD COPAY AMT],	a.[MI CMPD MEDD PR COPAY AMT],	a.[MI CMPD MEDD PAID AMT],	a.[MI CMPD MEDD EL PLN AMT],	a.[MI CMPD MEDD EL COST AMT], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[RECORD IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RX TRAN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[REFILL NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROCESS DATE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RETRO LICS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG DISP DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COMPOUND FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[EMPL GRP ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[BEN PLAN ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CATEGORY CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RIDER CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRIOR APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[NDC NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX FILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX QTY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NO OF DAYS SUPPL],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REJECT CODE1],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REJECT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRC IND     ],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRV LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[COPAY AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REGION],''))),':',				RTRIM(LTRIM(COALESCE(a.[END OF CYCLE DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[REDUCED CLAIM CAP AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[COINS CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DAW IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM DEDUCT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NTWK CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE SUBMITTED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE APPROVED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[ADJUD RIDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PLAN INDICATOR],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM ADMIN FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FORMULARY IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PREV MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM SITE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[PIN NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[AHFS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GCN CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GPI CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GC3 CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[STEP THER IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[GENERIC NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[ORIGIN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[EXP GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GL BATCHID],''))),':',				RTRIM(LTRIM(COALESCE(a.[WAC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MAC AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[AWP AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REV CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG TIER IND],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NDC DRUG ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FULL RX NO],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SALES TAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[GPI IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[BILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RELATIONSHIP CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DEPENDENT CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUBMITTED DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUBMITTED GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ADDR],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE CITY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PAYEE STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP EXT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PLAN TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MASTER GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[ESI GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP NAME],''))),':')			+ CONCAT (RTRIM(LTRIM(COALESCE(a.[SUB LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB FIRST NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_MIDDLE_NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB DOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ADDR],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB CITY],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP EXT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHYS NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV CONTRACT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CALC COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANCILLARY_AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[OUT OF POC MAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[STOP LOSS AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[BRAND CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE1],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT_CODE3],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DUR OVERFLOW],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR INTERVENTION],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR CUSTOMER CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOSAGE CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG STRENGTH],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM SER TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[UANDC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA APPL AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA ESI FUND IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAINT DRUG IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG LEGAL STATUS],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PICA DRUG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FED DRUG CLASS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROD TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FSA VENDOR CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[OTHER COVERAGE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTD MEDICARE DRUG],''))),':',				RTRIM(LTRIM(COALESCE(a.[RETRO LICS AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LICS SUBSIDY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE DRUG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE CLAIM],''))),':',				RTRIM(LTRIM(COALESCE(a.[TIER COPAY NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[OIG FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANDA FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CDH RESPONSE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CDH ESI RESPONSE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA FLAG             ],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA SIN BOOK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA REQUEST AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[DED SIN BOOK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAX OUT OF POC SIN BK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PL STOP LOSS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[TDS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE RX TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR VALUE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ACR ADMIN FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MBR ACR AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER CVG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV DED AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV ANCILLARY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COADD ON AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT RESIDENCE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NX IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR ORIG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB RECOVERY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRE COB BILLED CLAIM AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG CALC DISCOUNT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EXRSN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EL COST AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PDE DELETE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI_COMPOUND_IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI COMPOUND COV OPT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI LVL OF EFFT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI PRF SERV FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD ING CNT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD ELIG AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD INELIG AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PR COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL PLN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL COST AMT],'')))))),2)), 
				'GuildNet_GNClaimRpt',NULL 
 
 FROM CHSStaging.dbo.GuildNet_GNClaimRpt a 
INNER JOIN dbo.H_PharmacyClaim b ON a.centauripharmacyclaimid = b.PharmacyClaim_BK 
					WHERE UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[RECORD IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RX TRAN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[REFILL NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROCESS DATE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RETRO LICS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG DISP DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COMPOUND FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[EMPL GRP ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[BEN PLAN ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CATEGORY CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RIDER CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRIOR APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[NDC NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX FILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX QTY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NO OF DAYS SUPPL],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REJECT CODE1],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REJECT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRC IND     ],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRV LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[COPAY AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REGION],''))),':',				RTRIM(LTRIM(COALESCE(a.[END OF CYCLE DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[REDUCED CLAIM CAP AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[COINS CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DAW IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM DEDUCT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NTWK CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE SUBMITTED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE APPROVED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[ADJUD RIDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PLAN INDICATOR],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM ADMIN FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FORMULARY IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PREV MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM SITE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[PIN NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[AHFS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GCN CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GPI CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GC3 CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[STEP THER IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[GENERIC NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[ORIGIN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[EXP GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GL BATCHID],''))),':',				RTRIM(LTRIM(COALESCE(a.[WAC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MAC AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[AWP AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REV CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG TIER IND],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NDC DRUG ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FULL RX NO],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SALES TAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[GPI IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[BILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RELATIONSHIP CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DEPENDENT CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUBMITTED DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUBMITTED GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ADDR],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE CITY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PAYEE STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP EXT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PLAN TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MASTER GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[ESI GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP NAME],''))),':')			+ CONCAT (RTRIM(LTRIM(COALESCE(a.[SUB LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB FIRST NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_MIDDLE_NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB DOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ADDR],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB CITY],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP EXT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHYS NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV CONTRACT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CALC COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANCILLARY_AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[OUT OF POC MAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[STOP LOSS AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[BRAND CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE1],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT_CODE3],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DUR OVERFLOW],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR INTERVENTION],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR CUSTOMER CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOSAGE CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG STRENGTH],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM SER TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[UANDC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA APPL AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA ESI FUND IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAINT DRUG IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG LEGAL STATUS],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PICA DRUG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FED DRUG CLASS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROD TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FSA VENDOR CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[OTHER COVERAGE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTD MEDICARE DRUG],''))),':',				RTRIM(LTRIM(COALESCE(a.[RETRO LICS AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LICS SUBSIDY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE DRUG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE CLAIM],''))),':',				RTRIM(LTRIM(COALESCE(a.[TIER COPAY NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[OIG FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANDA FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CDH RESPONSE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CDH ESI RESPONSE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA FLAG             ],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA SIN BOOK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA REQUEST AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[DED SIN BOOK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAX OUT OF POC SIN BK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PL STOP LOSS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[TDS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE RX TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR VALUE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ACR ADMIN FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MBR ACR AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER CVG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV DED AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV ANCILLARY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COADD ON AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT RESIDENCE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NX IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR ORIG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB RECOVERY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRE COB BILLED CLAIM AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG CALC DISCOUNT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EXRSN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EL COST AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PDE DELETE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI_COMPOUND_IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI COMPOUND COV OPT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI LVL OF EFFT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI PRF SERV FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD ING CNT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD ELIG AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD INELIG AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PR COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL PLN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL COST AMT],'')))))),2)) NOT IN (SELECT HashDiff FROM dbo.S_GNClaimRptDetails WHERE H_PharmacyClaim_RK =b.H_PharmacyClaim_RK) 
				GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.centauripharmacyclaimid,''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RECORD IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RX TRAN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[REFILL NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROCESS DATE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RETRO LICS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG DISP DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COMPOUND FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[EMPL GRP ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[BEN PLAN ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CATEGORY CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RIDER CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRIOR APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[NDC NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX FILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX QTY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NO OF DAYS SUPPL],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REJECT CODE1],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REJECT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRC IND     ],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRV LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[COPAY AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REGION],''))),':',				RTRIM(LTRIM(COALESCE(a.[END OF CYCLE DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[REDUCED CLAIM CAP AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[COINS CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DAW IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM DEDUCT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NTWK CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE SUBMITTED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE APPROVED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[ADJUD RIDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PLAN INDICATOR],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM ADMIN FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FORMULARY IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PREV MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM SITE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[PIN NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[AHFS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GCN CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GPI CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GC3 CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[STEP THER IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[GENERIC NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[ORIGIN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[EXP GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GL BATCHID],''))),':',				RTRIM(LTRIM(COALESCE(a.[WAC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MAC AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[AWP AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REV CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG TIER IND],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NDC DRUG ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FULL RX NO],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SALES TAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[GPI IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[BILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RELATIONSHIP CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DEPENDENT CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUBMITTED DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUBMITTED GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ADDR],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE CITY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PAYEE STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP EXT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PLAN TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MASTER GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[ESI GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP NAME],''))),':')			+ CONCAT (RTRIM(LTRIM(COALESCE(a.[SUB LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB FIRST NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_MIDDLE_NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB DOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ADDR],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB CITY],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP EXT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHYS NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV CONTRACT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CALC COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANCILLARY_AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[OUT OF POC MAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[STOP LOSS AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[BRAND CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE1],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT_CODE3],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DUR OVERFLOW],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR INTERVENTION],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR CUSTOMER CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOSAGE CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG STRENGTH],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM SER TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[UANDC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA APPL AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA ESI FUND IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAINT DRUG IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG LEGAL STATUS],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PICA DRUG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FED DRUG CLASS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROD TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FSA VENDOR CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[OTHER COVERAGE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTD MEDICARE DRUG],''))),':',				RTRIM(LTRIM(COALESCE(a.[RETRO LICS AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LICS SUBSIDY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE DRUG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE CLAIM],''))),':',				RTRIM(LTRIM(COALESCE(a.[TIER COPAY NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[OIG FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANDA FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CDH RESPONSE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CDH ESI RESPONSE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA FLAG             ],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA SIN BOOK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA REQUEST AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[DED SIN BOOK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAX OUT OF POC SIN BK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PL STOP LOSS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[TDS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE RX TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR VALUE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ACR ADMIN FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MBR ACR AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER CVG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV DED AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV ANCILLARY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COADD ON AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT RESIDENCE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NX IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR ORIG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB RECOVERY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRE COB BILLED CLAIM AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG CALC DISCOUNT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EXRSN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EL COST AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PDE DELETE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI_COMPOUND_IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI COMPOUND COV OPT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI LVL OF EFFT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI PRF SERV FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD ING CNT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD ELIG AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD INELIG AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PR COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL PLN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL COST AMT],'')))))),2)), 
				--@LOADDATE, 
				b.H_PharmacyClaim_RK , 
				a.[RECORD IND],	a.[CLAIM NO],	a.[CLAIM TYPE],	a.[RX TRAN TYPE],	a.[RX NO],	a.[REFILL NO],	a.[PROCESS DATE],	 
				a.[RETRO LICS CODE],	a.[ORIG DISP DATE],	a.[COMPOUND FLAG],	a.[EMPL GRP ID],	a.[BEN PLAN ID],	a.[CATEGORY CODE],	a.[RIDER CODE],	a.[PRIOR APP CODE],	a.[NDC NO],	 
				a.[RX FILL DATE],	a.[RX QTY],	a.[NO OF DAYS SUPPL],	a.[DRUG NAME],	a.[CLAIM AMT],	a.[REJECT CODE1],	a.[REJECT CODE2],	a.[PRC IND     ],	a.[ORIG CLAIM AMT],	a.[PRV ID],	 
				a.[PRV LOC],	a.[ING COST CLAIM AMT],	a.[ING COST PAID AMT],	a.[COPAY AMT],	a.[REGION],	a.[END OF CYCLE DATE],	a.[PRESCR DATE],	a.[REDUCED CLAIM CAP AMT],	a.[COINS CLAIM AMT], 
				a.[DAW IND],	a.[CLAIM DEDUCT AMT],	a.[CLAIM NTWK CODE],	a.[CLAIM FEE SUBMITTED AMT],	a.[CLAIM FEE APPROVED AMT],	a.[LOB],	a.[ADJUD RIDER],	a.[PLAN INDICATOR], 
				a.[CLAIM ADMIN FEE AMT],	a.[FORMULARY IND],	a.[PREV MBR ID],	a.[CLAIM SITE ID],	a.[PIN NO],	a.[AHFS CODE],	a.[GCN CODE],	a.[GPI CODE],	a.[GC3 CODE],	 
				a.[STEP THER IND],	a.[GRP DRUG NAME],	a.[GENERIC NAME],	a.[ORIGIN CODE],	a.[EXP GRP NO],	a.[GL BATCHID],	a.[WAC AMT],	a.[MAC AMT],	a.[AWP AMT],	 
				a.[REV CLAIM NO],	a.[DRUG TIER IND],	a.[NDC DRUG ID],	a.[COB FLAG],	a.[COB AMT],	a.[FULL RX NO],	a.[SALES TAX AMT],	a.[GPI IND],	a.[BILL DATE],	 
				a.[RELATIONSHIP CODE],	a.[DEPENDENT CODE],	a.[DOB DEFAULT IND],	a.[PATIENT LOC],	a.[SUBMITTED DOB],	a.[SUBMITTED GENDER],	a.[PAYEE NAME],	a.[PAYEE ADDR],	 
				a.[PAYEE CITY],	a.[PAYEE STATE],	a.[PAYEE ZIP],	a.[PAYEE ZIP EXT],	a.[PLAN TYPE],	a.[MASTER GRP NO],	a.[ESI GRP NO],	a.[GRP NAME],	a.[SUB LAST NAME],	 
				a.[SUB FIRST NAME],	a.[SUB_MIDDLE_NAME],	a.[SUB DOB],	a.[SUB ADDR],	a.[SUB CITY],	a.[SUB_STATE],	a.[SUB ZIP],	a.[SUB ZIP EXT],	a.[SUB GENDER],	 
				a.[PRESCR QUALIFIER],	a.[PHYS NAME],	a.[PRV CONTRACT],	a.[CALC COPAY AMT],	a.[ANCILLARY_AMT],	a.[OUT OF POC MAX AMT],	a.[STOP LOSS AMT],	a.[BRAND CODE],	 
				a.[CONFLICT CODE1],	a.[CONFLICT CODE2],	a.[CONFLICT_CODE3],	a.[DUR OVERFLOW],	a.[DUR INTERVENTION],	a.[DUR CUSTOMER CODE],	a.[DOSAGE CODE],	a.[DRUG STRENGTH],	 
				a.[PHARM SER TYPE],	a.[PHARM QUALIFIER],	a.[UANDC AMT],	a.[HRA APPL AMT],	a.[HRA ESI FUND IND],	a.[MAINT DRUG IND],	a.[DRUG LEGAL STATUS],	a.[PICA DRUG CODE],	 
				a.[FED DRUG CLASS CODE],	a.[PROD TYPE],	a.[FSA VENDOR CODE],	a.[OTHER COVERAGE CODE],	a.[PARTD MEDICARE DRUG],	a.[RETRO LICS AMT],	a.[LICS SUBSIDY AMT],	 
				a.[PARTB MEDICARE DRUG],	a.[PARTB MEDICARE CLAIM],	a.[TIER COPAY NO],	a.[OIG FLAG],	a.[ANDA FLAG],	a.[CDH RESPONSE ID],	a.[CDH ESI RESPONSE CODE],	 
				a.[HRA FLAG             ],	a.[HRA SIN BOOK FLAG],	a.[HRA REQUEST AMT],	a.[VENDOR ID],	a.[DED SIN BOOK FLAG],	a.[MAX OUT OF POC SIN BK FLAG],	a.[PL STOP LOSS SIN BK FLAG], 
				a.[TDS SIN BK FLAG],	a.[VACCINE RX TYPE],	a.[VACCINE ADMIN AMT],	a.[VACCINE ADMIN TYPE],	a.[VENDOR VALUE],	a.[ACR ADMIN FLAG],	a.[MBR ACR AMT],	 
				a.[SUPP PAYER PAID AMT],	a.[SUPP PAYER COPAY AMT],	a.[SUPP PAYER CVG CODE],	a.[SUPP PAYER COV DED AMT],	a.[SUPP PAYER COV COPAY AMT],	 
				a.[SUPP PAYER COV ANCILLARY AMT],	a.[SUPP PAYER COV COADD ON AMT],	a.[PATIENT RESIDENCE],	a.[NX IND],	a.[PRESCR ORIG CODE],	a.[COB RECOVERY AMT],	 
				a.[PRE COB BILLED CLAIM AMT],	a.[DRUG CALC DISCOUNT AMT],	a.[DRUG DISCOUNT EXRSN CODE],	a.[DRUG DISCOUNT APP CODE],	a.[DRUG DISCOUNT EL COST AMT],	 
				a.[PDE DELETE CODE],	a.[MI_COMPOUND_IND],	a.[MI COMPOUND COV OPT],	a.[MI LVL OF EFFT],	a.[MI PRF SERV FEE AMT],	a.[MI CMPD ING CNT],	a.[MI CMPD MEDD ELIG AMT],	 
				a.[MI CMPD MEDD INELIG AMT],	a.[MI CMPD MEDD COPAY AMT],	a.[MI CMPD MEDD PR COPAY AMT],	a.[MI CMPD MEDD PAID AMT],	a.[MI CMPD MEDD EL PLN AMT],	a 
				.[MI CMPD MEDD EL COST AMT], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[RECORD IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RX TRAN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[REFILL NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROCESS DATE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RETRO LICS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG DISP DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COMPOUND FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[EMPL GRP ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[BEN PLAN ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CATEGORY CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RIDER CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRIOR APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[NDC NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX FILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX QTY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NO OF DAYS SUPPL],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REJECT CODE1],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REJECT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRC IND     ],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRV LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[COPAY AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REGION],''))),':',				RTRIM(LTRIM(COALESCE(a.[END OF CYCLE DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[REDUCED CLAIM CAP AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[COINS CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DAW IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM DEDUCT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NTWK CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE SUBMITTED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE APPROVED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[ADJUD RIDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PLAN INDICATOR],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM ADMIN FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FORMULARY IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PREV MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM SITE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[PIN NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[AHFS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GCN CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GPI CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GC3 CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[STEP THER IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[GENERIC NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[ORIGIN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[EXP GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GL BATCHID],''))),':',				RTRIM(LTRIM(COALESCE(a.[WAC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MAC AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[AWP AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REV CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG TIER IND],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NDC DRUG ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FULL RX NO],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SALES TAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[GPI IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[BILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RELATIONSHIP CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DEPENDENT CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUBMITTED DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUBMITTED GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ADDR],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE CITY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PAYEE STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP EXT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PLAN TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MASTER GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[ESI GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP NAME],''))),':')			+ CONCAT (RTRIM(LTRIM(COALESCE(a.[SUB LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB FIRST NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_MIDDLE_NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB DOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ADDR],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB CITY],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP EXT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHYS NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV CONTRACT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CALC COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANCILLARY_AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[OUT OF POC MAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[STOP LOSS AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[BRAND CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE1],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT_CODE3],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DUR OVERFLOW],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR INTERVENTION],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR CUSTOMER CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOSAGE CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG STRENGTH],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM SER TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[UANDC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA APPL AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA ESI FUND IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAINT DRUG IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG LEGAL STATUS],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PICA DRUG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FED DRUG CLASS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROD TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FSA VENDOR CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[OTHER COVERAGE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTD MEDICARE DRUG],''))),':',				RTRIM(LTRIM(COALESCE(a.[RETRO LICS AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LICS SUBSIDY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE DRUG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE CLAIM],''))),':',				RTRIM(LTRIM(COALESCE(a.[TIER COPAY NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[OIG FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANDA FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CDH RESPONSE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CDH ESI RESPONSE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA FLAG             ],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA SIN BOOK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA REQUEST AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[DED SIN BOOK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAX OUT OF POC SIN BK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PL STOP LOSS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[TDS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE RX TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR VALUE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ACR ADMIN FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MBR ACR AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER CVG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV DED AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV ANCILLARY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COADD ON AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT RESIDENCE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NX IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR ORIG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB RECOVERY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRE COB BILLED CLAIM AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG CALC DISCOUNT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EXRSN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EL COST AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PDE DELETE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI_COMPOUND_IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI COMPOUND COV OPT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI LVL OF EFFT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI PRF SERV FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD ING CNT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD ELIG AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD INELIG AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PR COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL PLN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL COST AMT],'')))))),2)); 
 
	--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_GNClaimRptDetails 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_GNClaimRptDetails z 
                                  WHERE     z.H_PharmacyClaim_RK = a.H_PharmacyClaim_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_GNClaimRptDetails a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_GNClaimRptDetails' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_GNClaimRptDetails' , 
                      GETDATE() 
                    ); 
 
 
					/* 
                 INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        FileName 
                FROM    CHSStaging.[dbo].GuildNet_GNClaimRpt 
				*/ 
     
	 
 
--Load History Table for S_GNClaimsRptDetails 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_GNClaimRptDetails' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.centauripharmacyclaimid,''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RECORD IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RX TRAN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[REFILL NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROCESS DATE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[RETRO LICS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG DISP DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COMPOUND FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[EMPL GRP ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[BEN PLAN ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CATEGORY CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RIDER CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRIOR APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[NDC NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX FILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RX QTY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NO OF DAYS SUPPL],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REJECT CODE1],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REJECT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRC IND     ],''))),':',				RTRIM(LTRIM(COALESCE(a.[ORIG CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PRV LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ING COST PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[COPAY AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[REGION],''))),':',				RTRIM(LTRIM(COALESCE(a.[END OF CYCLE DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[REDUCED CLAIM CAP AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[COINS CLAIM AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DAW IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM DEDUCT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM NTWK CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE SUBMITTED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM FEE APPROVED AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[ADJUD RIDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PLAN INDICATOR],''))),':',				RTRIM(LTRIM(COALESCE(a.[CLAIM ADMIN FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FORMULARY IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PREV MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CLAIM SITE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[PIN NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[AHFS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GCN CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GPI CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[GC3 CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[STEP THER IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP DRUG NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[GENERIC NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[ORIGIN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[EXP GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GL BATCHID],''))),':',				RTRIM(LTRIM(COALESCE(a.[WAC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MAC AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[AWP AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[REV CLAIM NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG TIER IND],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NDC DRUG ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[FULL RX NO],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SALES TAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[GPI IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[BILL DATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[RELATIONSHIP CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DEPENDENT CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT LOC],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUBMITTED DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUBMITTED GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ADDR],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE CITY],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PAYEE STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[PAYEE ZIP EXT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PLAN TYPE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MASTER GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[ESI GRP NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[GRP NAME],''))),':')			+ CONCAT (RTRIM(LTRIM(COALESCE(a.[SUB LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB FIRST NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_MIDDLE_NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB DOB],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ADDR],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB CITY],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB_STATE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUB ZIP EXT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUB GENDER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHYS NAME],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRV CONTRACT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CALC COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANCILLARY_AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[OUT OF POC MAX AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[STOP LOSS AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[BRAND CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE1],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT CODE2],''))),':',				RTRIM(LTRIM(COALESCE(a.[CONFLICT_CODE3],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DUR OVERFLOW],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR INTERVENTION],''))),':',				RTRIM(LTRIM(COALESCE(a.[DUR CUSTOMER CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DOSAGE CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG STRENGTH],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM SER TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PHARM QUALIFIER],''))),':',				RTRIM(LTRIM(COALESCE(a.[UANDC AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA APPL AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA ESI FUND IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAINT DRUG IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG LEGAL STATUS],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PICA DRUG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FED DRUG CLASS CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PROD TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[FSA VENDOR CODE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[OTHER COVERAGE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTD MEDICARE DRUG],''))),':',				RTRIM(LTRIM(COALESCE(a.[RETRO LICS AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[LICS SUBSIDY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE DRUG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PARTB MEDICARE CLAIM],''))),':',				RTRIM(LTRIM(COALESCE(a.[TIER COPAY NO],''))),':',				RTRIM(LTRIM(COALESCE(a.[OIG FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[ANDA FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[CDH RESPONSE ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[CDH ESI RESPONSE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA FLAG             ],''))),':',				RTRIM(LTRIM(COALESCE(a.[HRA SIN BOOK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[HRA REQUEST AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR ID],''))),':',				RTRIM(LTRIM(COALESCE(a.[DED SIN BOOK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MAX OUT OF POC SIN BK FLAG],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PL STOP LOSS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[TDS SIN BK FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE RX TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[VACCINE ADMIN TYPE],''))),':',				RTRIM(LTRIM(COALESCE(a.[VENDOR VALUE],''))),':',				RTRIM(LTRIM(COALESCE(a.[ACR ADMIN FLAG],''))),':',				RTRIM(LTRIM(COALESCE(a.[MBR ACR AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER CVG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV DED AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV ANCILLARY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[SUPP PAYER COV COADD ON AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PATIENT RESIDENCE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[NX IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRESCR ORIG CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[COB RECOVERY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[PRE COB BILLED CLAIM AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DRUG CALC DISCOUNT AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EXRSN CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT APP CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[DRUG DISCOUNT EL COST AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[PDE DELETE CODE],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI_COMPOUND_IND],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI COMPOUND COV OPT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI LVL OF EFFT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI PRF SERV FEE AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD ING CNT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD ELIG AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD INELIG AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PR COPAY AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD PAID AMT],''))),':',				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL PLN AMT],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MI CMPD MEDD EL COST AMT],'')))))),2)), 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.filename COLLATE Compatibility_52_409_30003 
                        ) 
 
 FROM CHSStaging.dbo.GuildNet_GNClaimRpt a 
INNER JOIN dbo.H_PharmacyClaim b ON a.centauripharmacyclaimid = b.PharmacyClaim_BK 
 
-- Member for GNCLaimsRpt 
        --DECLARE @LoadDate DATETIME; 
        --SET @LoadDate = GETDATE(); 
 
INSERT INTO dbo.S_MemberPharmacyClaim 
        ( S_MemberPharmacyClaim_RK , 
          LoadDate , 
          H_Member_RK , 
          [CR-MEMBER-ID] , 
          [CR-MEMBER-BIRTH-DATE] , 
          [Member Last Name] , 
          [Member First Name] , 
          [Member Middle Initial] , 
          [Member Gender] , 
          Age , 
          [Member PCP Assignment] , 
          [Member Program] , 
          [DOB Default] , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
		SELECT UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID,''))),':', 
		 		RTRIM(LTRIM(COALESCE(a.[MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR FIRST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR MIDDLE NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GENDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[AGE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR PCP],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR PRGM],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],'')))))),2)), 
				@LOADDATE, 
				b.H_Member_RK, 
				a.[MBR ID], 
				a.[MBR DOB], 
				a.[MBR LAST NAME], 
				a.[MBR FIRST NAME], 
				a.[MBR MIDDLE NAME], 
				a.[GENDER], 
				a.[AGE], 
				a.[MBR PCP], 
				a.[MBR PRGM], 
				a.[DOB DEFAULT IND], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
						 UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[MBR ID],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[MBR DOB],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[MBR LAST NAME],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[MBR FIRST NAME],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[MBR MIDDLE NAME],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[GENDER],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[AGE],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[MBR PCP],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[MBR PRGM],''))),':', 
								RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],'')))))),2)), 
				'GuildNet_GNClaimRpt', NULL 
			FROM CHSStaging.dbo.GuildNet_GNClaimRpt a 
			INNER JOIN dbo.H_Member b ON a.CentauriMemberID = b.Member_BK 
			WHERE UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
					 UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[MBR ID],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR DOB],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR LAST NAME],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR FIRST NAME],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR MIDDLE NAME],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[GENDER],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[AGE],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR PCP],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR PRGM],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],'')))))),2)) NOT IN (SELECT HashDiff FROM dbo.S_MemberPharmacyClaim WHERE H_Member_RK=b.H_Member_RK AND RecordEndDate IS NULL) 
			GROUP BY UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
					 UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID,''))),':', 
		 					RTRIM(LTRIM(COALESCE(a.[MBR ID],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR DOB],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR LAST NAME],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR FIRST NAME],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR MIDDLE NAME],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[GENDER],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[AGE],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR PCP],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[MBR PRGM],''))),':', 
							RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],'')))))),2)), 
							b.H_Member_RK, 
							a.[MBR ID], 
							a.[MBR DOB], 
							a.[MBR LAST NAME], 
							a.[MBR FIRST NAME], 
							a.[MBR MIDDLE NAME], 
							a.[GENDER], 
							a.[AGE], 
							a.[MBR PCP], 
							a.[MBR PRGM], 
							a.[DOB DEFAULT IND], 
							UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
							 UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.[MBR ID],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[MBR DOB],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[MBR LAST NAME],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[MBR FIRST NAME],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[MBR MIDDLE NAME],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[GENDER],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[AGE],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[MBR PCP],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[MBR PRGM],''))),':', 
									RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],'')))))),2)); 
 
 
--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_MemberPharmacyClaim 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_MemberPharmacyClaim z 
                                  WHERE     z.H_Member_RK = a.H_Member_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_MemberPharmacyClaim a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_MemberPharmacyClaim' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_MemberPharmacyClaim' , 
                      GETDATE() 
                    ); 
 
 
					/* 
                 INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        FileName 
                FROM    CHSStaging.[dbo].GuildNet_GNClaimRpt 
				*/ 
     
	 
 
--Load History Table for S_GNClaimsRptDetails 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_MemberPharmacyClaim' 
                        ) , 
                       UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
         UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriMemberID,''))),':', 
		 		RTRIM(LTRIM(COALESCE(a.[MBR ID],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR DOB],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR LAST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR FIRST NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR MIDDLE NAME],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[GENDER],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[AGE],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR PCP],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[MBR PRGM],''))),':', 
				RTRIM(LTRIM(COALESCE(a.[DOB DEFAULT IND],'')))))),2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.filename COLLATE Compatibility_52_409_30003 
                        ) 
             			FROM CHSStaging.dbo.GuildNet_GNClaimRpt a 
			INNER JOIN dbo.H_Member b ON a.CentauriMemberID = b.Member_BK 
 
--Pharmacy Header for GNClaimsRPT 
 --DECLARE @LoadDate DATETIME; 
 --SET @LoadDate = GETDATE(); 
  
INSERT INTO dbo.S_PharmacyHeader 
        ( S_PharmacyHeader_RK , 
          LoadDate , 
          H_Pharmacy_RK , 
          [PHR-PHARMACY-NABP-NO] , 
          [PHR-NPI-ID] , 
          HashDiff , 
          RecordSource , 
          RecordEndDate 
        ) 
		SELECT UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
				     UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID,''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NPI ID],''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NABP],'')))))),2)), 
				@LoadDate, 
				b.H_Pharmacy_RK, 
				a.[PHARM NABP], 
				a.[PHARM NPI ID], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
				     UPPER(CONCAT( 
						RTRIM(LTRIM(COALESCE(a.[PHARM NPI ID],''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NABP],'')))))),2)), 
						'GuildNet_GNClaimRpt', NULL 
		 FROM CHSStaging.dbo.GuildNet_GNClaimRpt a 
		 INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK 
		 WHERE UPPER(CONVERT(CHAR(32), HASHBYTES('MD5',UPPER(CONCAT( 
						RTRIM(LTRIM(COALESCE(a.[PHARM NPI ID],''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NABP],'')))))),2)) NOT IN (SELECT HashDiff FROM dbo.S_PharmacyHeader WHERE b.H_Pharmacy_RK=H_Pharmacy_RK AND RecordEndDate IS NULL) 
		GROUP BY   UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
				     UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID,''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NPI ID],''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NABP],'')))))),2)), 
				b.H_Pharmacy_RK, 
				a.[PHARM NABP], 
				a.[PHARM NPI ID], 
				UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
				     UPPER(CONCAT( 
						RTRIM(LTRIM(COALESCE(a.[PHARM NPI ID],''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NABP],'')))))),2)) 
 
 
--RECORD END DATE CLEANUP 
        UPDATE  dbo.S_PharmacyHeader 
        SET     RecordEndDate = ( SELECT    DATEADD(ss, -1, MIN(z.LoadDate)) 
                                  FROM      dbo.S_PharmacyHeader z 
                                  WHERE     z.H_Pharmacy_RK = a.H_Pharmacy_RK 
                                            AND z.LoadDate > a.LoadDate 
                                ) 
        FROM    dbo.S_PharmacyHeader a 
        WHERE   a.RecordEndDate IS NULL;  
 
			--History Table 
        IF ( SELECT COUNT(*) 
             FROM   dbo.TableNames 
             WHERE  TableName = 'S_PharmacyHeader' 
           ) = 0 
            INSERT  INTO dbo.TableNames 
                    ( TableName , 
                      CreateDate 
                    ) 
            VALUES  ( 'S_PharmacyHeader' , 
                      GETDATE() 
                    ); 
 
 
					/* 
                 INSERT  INTO RecordSources 
                ( RecordSource 
                ) 
                SELECT DISTINCT 
                        FileName 
                FROM    CHSStaging.[dbo].GuildNet_GNClaimRpt 
				*/ 
     
	 
 
--Load History Table for S_GNClaimsRptDetails 
        INSERT  INTO LoadHistory2 
                ( TableName_PK , 
                  HashKey , 
                  RecordSource_PK 
                ) 
                SELECT	DISTINCT 
                        ( SELECT    TableName_PK 
                          FROM      TableNames 
                          WHERE     TableName = 'S_PharmacyHeader' 
                        ) , 
                        UPPER(CONVERT(CHAR(32), HASHBYTES('MD5', 
				     UPPER(CONCAT(RTRIM(LTRIM(COALESCE(a.CentauriPharmacyID,''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NPI ID],''))),':', 
						RTRIM(LTRIM(COALESCE(a.[PHARM NABP],'')))))),2)) , 
                        ( SELECT    RecordSource_PK 
                          FROM      RecordSources 
                          WHERE     RecordSource = a.filename COLLATE Compatibility_52_409_30003 
                        ) 
		 FROM CHSStaging.dbo.GuildNet_GNClaimRpt a 
		 INNER JOIN dbo.H_Pharmacy b ON a.CentauriPharmacyID = b.Pharmacy_BK ; 
 
    END; 
 
 
 
 
 
 
GO
