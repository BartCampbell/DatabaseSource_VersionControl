SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
-- =============================================
-- Author:	    Jason Franks
-- Create date: 2/23/2016
-- Description:	Load MOR detail data to the DV from Staging 
-- =============================================
CREATE PROCEDURE [dbo].[prDV_MOR_LoadSats]
	-- Add the parameters for the stored procedure here
	
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- LOAD MOR A RECORDS
	INSERT INTO S_MOR_ARecord
	SELECT 
	[MOR_ARecord_RK],
	LoadDate ,
    MOR_Header_RK ,
    MOR_Trailer_RK ,
	RecordTypeCode ,
    HICN ,
    LastName ,
    FirstName ,
    MI ,
    DOB ,
    Gender ,
    SSN ,
    F034 ,
    F3544 ,
    F4554 ,
    F5559 ,
    F6064 ,
    F6569 ,
    F7074 ,
    F7579 ,
    F8084 ,
    F8589 ,
    F9094 ,
    F95GT ,
    M034 ,
    M3544 ,
    M4554 ,
    M5559 ,
    M6064 ,
    M6569 ,
    M7074 ,
    M7579 ,
    M8084 ,
    M8589 ,
    M9094 ,
    M95GT ,
    MedicaidFemaleDisabled ,
    MedicaidFemaleAged ,
    MedicaidMaleDisabled ,
    MedicaidMaleAged ,
    OriginallyDisabledFemale ,
    OriginallyDisabledMale ,
    HCC1 ,
    HCC2 ,
    HCC5 ,
    HCC7 ,
    HCC8 ,
    HCC9 ,
    HCC10 ,
    HCC15 ,
    HCC16 ,
    HCC17 ,
    HCC18 ,
    HCC19 ,
    HCC21 ,
    HCC25 ,
    HCC26 ,
    HCC27 ,
    HCC31 ,
    HCC32 ,
    HCC33 ,
    HCC37 ,
    HCC38 ,
    HCC44 ,
    HCC45 ,
    HCC51 ,
    HCC52 ,
    HCC54 ,
    HCC55 ,
    HCC67 ,
    HCC68 ,
    HCC69 ,
    HCC70 ,
    HCC71 ,
    HCC72 ,
    HCC73 ,
    HCC74 ,
    HCC75 ,
    HCC77 ,
    HCC78 ,
    HCC79 ,
    HCC80 ,
    HCC81 ,
    HCC82 ,
    HCC83 ,
    HCC92 ,
    HCC95 ,
    HCC96 ,
    HCC100 ,
    HCC101 ,
    HCC104 ,
    HCC105 ,
    HCC107 ,
    HCC108 ,
    HCC111 ,
    HCC112 ,
    HCC119 ,
    HCC130 ,
    HCC131 ,
    HCC132 ,
    HCC148 ,
    HCC149 ,
    HCC150 ,
    HCC154 ,
    HCC155 ,
    HCC157 ,
    HCC158 ,
    HCC161 ,
    HCC164 ,
    HCC174 ,
    HCC176 ,
    HCC177 ,
    DD_HCC5 ,
    DD_HCC44 ,
    DD_HCC51 ,
    DD_HCC52 ,
    DD_HCC107 ,
    INT1 ,
    INT2 ,
    INT3 ,
    INT4 ,
    INT5 ,
    INT6 ,
    RecordSource
	FROM CHSStaging.dbo.MOR_ARecord_Stage WITH(NOLOCK)
	WHERE [MOR_ARecord_RK] NOT IN (SELECT S_MOR_ARECORD_RK FROM S_MOR_ARecord WITH(NOLOCK))

	-- LOAD MOR B RECORDS
	INSERT INTO dbo.S_MOR_BRecord
	        SELECT 
					MOR_BRecord_RK,
					LoadDate ,
					 MOR_Header_RK ,
                   MOR_Trailer_RK ,                  
					RecordTypeCode ,
                   HICN ,
                   LastName ,
                   FirstName ,
                   MI ,
                   DOB ,
                   Gender ,
                   SSN ,
                   ESRD ,
                   F034 ,
                   F3544 ,
                   F4554 ,
                   F5559 ,
                   F6064 ,
                   F6569 ,
                   F7074 ,
                   F7579 ,
                   F8084 ,
                   F8589 ,
                   F9094 ,
                   F95GT ,
                   M034 ,
                   M3544 ,
                   M4554 ,
                   M5559 ,
                   M6064 ,
                   M6569 ,
                   M7074 ,
                   M7579 ,
                   M8084 ,
                   M8589 ,
                   M9094 ,
                   M95GT ,
                   MedicaidFemaleDisabled ,
                   MedicaidFemaleAged ,
                   MedicaidMaleDisabled ,
                   MedicaidMaleAged ,
                   OriginallyDisabledFemale ,
                   OriginallyDisabledMale ,
                   HCC001 ,
                   HCC002 ,
                   HCC006 ,
                   HCC008 ,
                   HCC009 ,
                   HCC010 ,
                   HCC011 ,
                   HCC012 ,
                   HCC017 ,
                   HCC018 ,
                   HCC019 ,
                   HCC021 ,
                   HCC022 ,
                   HCC023 ,
                   HCC027 ,
                   HCC028 ,
                   HCC029 ,
                   HCC033 ,
                   HCC034 ,
                   HCC035 ,
                   HCC039 ,
                   HCC040 ,
                   HCC046 ,
                   HCC047 ,
                   HCC048 ,
                   HCC051 ,
                   HCC052 ,
                   HCC054 ,
                   HCC055 ,
                   HCC057 ,
                   HCC058 ,
                   HCC070 ,
                   HCC071 ,
                   HCC072 ,
                   HCC073 ,
                   HCC074 ,
                   HCC075 ,
                   HCC076 ,
                   HCC077 ,
                   HCC078 ,
                   HCC079 ,
                   HCC080 ,
                   HCC082 ,
                   HCC083 ,
                   HCC084 ,
                   HCC085 ,
                   HCC086 ,
                   HCC087 ,
                   HCC088 ,
                   HCC096 ,
                   HCC099 ,
                   HCC100 ,
                   HCC103 ,
                   HCC104 ,
                   HCC106 ,
                   HCC107 ,
                   HCC108 ,
                   HCC110 ,
                   HCC111 ,
                   HCC112 ,
                   HCC114 ,
                   HCC115 ,
                   HCC122 ,
                   HCC124 ,
                   HCC134 ,
                   HCC135 ,
                   HCC136 ,
                   HCC137 ,
                   HCC138 ,
                   HCC139 ,
                   HCC140 ,
                   HCC141 ,
                   HCC157 ,
                   HCC158 ,
                   HCC159 ,
                   HCC160 ,
                   HCC161 ,
                   HCC162 ,
                   HCC166 ,
                   HCC167 ,
                   HCC169 ,
                   HCC170 ,
                   HCC173 ,
                   HCC176 ,
                   HCC186 ,
                   HCC188 ,
                   HCC189 ,
                   DD_HCC006 ,
                   DD_HCC034 ,
                   DD_HCC046 ,
                   DD_HCC054 ,
                   DD_HCC055 ,
                   DD_HCC110 ,
                   DD_HCC176 ,
                   CANCER_IMMUNE ,
                   CHF_COPD ,
                   CHF_RENAL ,
                   COPD_CARD_RESP_FAIL ,
                   DIABETES_CHF ,
                   SEPSIS_CARD_RESP_FAIL ,
                   MEDICAID ,
                   Orginaly_Disabled ,
                   DD_HCC039 ,
                   DD_HCC077 ,
                   DD_HCC085 ,
                   DD_HCC161 ,
                   ART_OPENINGS_PRESSURE_ULCER ,
                   ASP_SPEC_BACT_PNEUM_PRES_ULC ,
                   COPD_ASP_SPEC_BACT_PNEUM ,
                   DISABLED_PRESSURE_ULCER ,
                   SCHIZOPHRENIA_CHF ,
                   SCHIZOPHRENIA_COPD ,
                   SCHIZOPHRENIA_SEIZURES ,
                   SEPSIS_ARTIF_OPENINGS ,
                   SEPSIS_ASP_SPEC_BACT_PNEUM ,
                   SEPSIS_PRESSURE_ULCER ,
                   Filler ,
                   RecordSource                   
				   FROM CHSStaging.dbo.MOR_BRecord_Stage WITH(NOLOCK)
				   WHERE MOR_BRecord_RK NOT IN (SELECT S_MOR_BRecord_RK FROM dbo.S_MOR_BRecord WITH(NOLOCK))

	-- LOAD MOR C RECORDS
		INSERT INTO dbo.S_MOR_CRecord
		       SELECT 
					 MOR_CRecord_RK,
					 LoadDate ,
					   MOR_Header_RK ,
                      MOR_Trailer_RK ,
                      RecordTypeCode ,
                      HICN ,
                      LastName ,
                      FirstName ,
                      MI ,
                      DOB ,
                      Gender ,
                      SSN ,
                      F034 ,
                      F3544 ,
                      F4554 ,
                      F5559 ,
                      F6064 ,
                      F6569 ,
                      F7074 ,
                      F7579 ,
                      F8084 ,
                      F8589 ,
                      F9094 ,
                      F95GT ,
                      M034 ,
                      M3544 ,
                      M4554 ,
                      M5559 ,
                      M6064 ,
                      M6569 ,
                      M7074 ,
                      M7579 ,
                      M8084 ,
                      M8589 ,
                      M9094 ,
                      M95GT ,
                      MedicaidFemaleDisabled ,
                      MedicaidFemaleAged ,
                      MedicaidMaleDisabled ,
                      MedicaidMaleAged ,
                      OriginallyDisabledFemale ,
                      OriginallyDisabledMale ,
                      HCC001 ,
                      HCC002 ,
                      HCC006 ,
                      HCC008 ,
                      HCC009 ,
                      HCC010 ,
                      HCC011 ,
                      HCC012 ,
                      HCC017 ,
                      HCC018 ,
                      HCC019 ,
                      HCC021 ,
                      HCC022 ,
                      HCC023 ,
                      HCC027 ,
                      HCC028 ,
                      HCC029 ,
                      HCC033 ,
                      HCC034 ,
                      HCC035 ,
                      HCC039 ,
                      HCC040 ,
                      HCC046 ,
                      HCC047 ,
                      HCC048 ,
                      HCC054 ,
                      HCC055 ,
                      HCC057 ,
                      HCC058 ,
                      HCC070 ,
                      HCC071 ,
                      HCC072 ,
                      HCC073 ,
                      HCC074 ,
                      HCC075 ,
                      HCC076 ,
                      HCC077 ,
                      HCC078 ,
                      HCC079 ,
                      HCC080 ,
                      HCC082 ,
                      HCC083 ,
                      HCC084 ,
                      HCC085 ,
                      HCC086 ,
                      HCC087 ,
                      HCC088 ,
                      HCC096 ,
                      HCC099 ,
                      HCC100 ,
                      HCC103 ,
                      HCC104 ,
                      HCC106 ,
                      HCC107 ,
                      HCC108 ,
                      HCC110 ,
                      HCC111 ,
                      HCC112 ,
                      HCC114 ,
                      HCC115 ,
                      HCC122 ,
                      HCC124 ,
                      HCC134 ,
                      HCC135 ,
                      HCC136 ,
                      HCC137 ,
                      HCC157 ,
                      HCC158 ,
                      HCC161 ,
                      HCC162 ,
                      HCC166 ,
                      HCC167 ,
                      HCC169 ,
                      HCC170 ,
                      HCC173 ,
                      HCC176 ,
                      HCC186 ,
                      HCC188 ,
                      HCC189 ,
                      DD_HCC006 ,
                      DD_HCC034 ,
                      DD_HCC046 ,
                      DD_HCC054 ,
                      DD_HCC055 ,
                      DD_HCC110 ,
                      DD_HCC176 ,
                      CANCER_IMMUNE ,
                      CHF_COPD ,
                      CHF_RENAL ,
                      COPD_CARD_RESP_FAIL ,
                      DIABETES_CHF ,
                      SEPSIS_CARD_RESP_FAIL ,
                      MEDICAID ,
                      Orginaly_Disabled ,
                      DD_HCC039 ,
                      DD_HCC077 ,
                      DD_HCC085 ,
                      DD_HCC161 ,
                      DISABLED_PRESSURE_ULCER ,
                      ART_OPENINGS_PRESSURE_ULCER ,
                      ASP_SPEC_BACT_PNEUM_PRES_ULC ,
                      COPD_ASP_SPEC_BACT_PNEUM ,
                      SCHIZOPHRENIA_CHF ,
                      SCHIZOPHRENIA_COPD ,
                      SCHIZOPHRENIA_SEIZURES ,
                      SEPSIS_ARTIF_OPENINGS ,
                      SEPSIS_ASP_SPEC_BACT_PNEUM ,
                      SEPSIS_PRESSURE_ULCER ,
                      Filler ,                    
                      RecordSource                     
					   FROM CHSStaging.dbo.MOR_CRecord_Stage WITH(NOLOCK)
					   WHERE MOR_CRecord_RK NOT IN (SELECT S_MOR_CRecord_RK FROM dbo.S_MOR_CRecord WITH(NOLOCK))
	

	
END
GO
